function scaleToWindow(a,h){var f=window.innerWidth/a.offsetWidth,g=window.innerHeight/a.offsetHeight,b=Math.min(f,g),c,d,e;return a.style.transformOrigin="0 0",a.style.transform="scale("+b+")",a.offsetWidth>a.offsetHeight?a.offsetWidth*b<window.innerWidth?c="horizontally":c="vertically":a.offsetHeight*b<window.innerHeight?c="vertically":c="horizontally",c==="horizontally"&&(d=(window.innerWidth-a.offsetWidth*b)/2,a.style.marginTop=0+"px",a.style.marginBottom=0+"px",a.style.marginLeft=d+"px",a.style.marginRight=d+"px"),c==="vertically"&&(d=(window.innerHeight-a.offsetHeight*b)/2,a.style.marginTop=d+"px",a.style.marginBottom=d+"px",a.style.marginLeft=0+"px",a.style.marginRight=0+"px"),a.style.paddingLeft=0+"px",a.style.paddingRight=0+"px",a.style.paddingTop=0+"px",a.style.paddingBottom=0+"px",a.style.display="block",document.body.style.backgroundColor=h,e=navigator.userAgent.toLowerCase(),e.indexOf("safari")!=-1&&e.indexOf("chrome")>-1,b}var PIXI=function(a){"use strict";var ie=setTimeout,ep,hM,hK,ha,hy,dj,eH,da,c_,eK,cY,eL,eR,ff,cT,fg,ag,ba,B,fi,fj,fm,ft,fA,fD,fL,s,b,cK,af,aT,hb,gt,cj,gm,bz,gp,gs,az,gv,ce,gy,gD,gL,gT,gU,gX,gZ,cb,fZ,fY,fW,g_,g$,bW,ad,L,fH,bR,bQ,hh,bN,hi,hj,fs,bG,q,r,bF,by,fp,hm,aA,fh,fe,g,bn,d,fd,fa,aG,e_,P,m,M,N,W,R,bT,eZ,aV,i,bX,aO,bZ,k,ca,u,aD,eT,A,p,ch,o,eQ,aq,cm,co,Z,S,hs,e,bm,cu,z,cw,cx,bc,cz,cA,cB,eN,hw,a_,cF,cG,eF,c,G,eB,cM,hz,n,hA,ew,hD,hE,an,en,cV,hO,J,ek,bi,dD,c$,aF,db,ej,dd,ei,ih,dg,dh,di,eg,br,dV,aC,hX,bv,dL,at,Y,hZ,h_,h$,ib,bl,al,D,K,C,dM,bu,dO,du,dQ,dR,dS,dt,ds,dq,$,aE,dk,hU,d$,ed,hS,bp,df,de,dc,be,cW,em,cU,eo,hN,hH,cS,et,cR,hB,bb,aY,aW,ez,eA,cL,eC,eD,eE,cH,eG,hx,cD,eJ,hu,eh,eM,cC,cr,eP,bA,hr,eS,bw,eU,eV,eW,aX,bU,E,bh,ho,bE,hn,aJ,fk,fl,f,hk,av,bD,bs,y,fu,bk,fw,w,bL,U,H,aZ,hg,hf,fG,bS,fI,fJ,fM,fN,bV,hd,fR,fS,ac,dE,bY,b$,aL,f_,gb,aj,cd,gh,gi,gj,bt,cf,ay,cg,am,dF,gn,gr,ci,ar,gu,cn,aw,gx,ai,cp,cq,gB,X,bf,x,gI,cy,cE,gf,ge,ga,gY,f$,fV,cI,aN,hc,fQ,aU,fE,cN,fv,cP,fo,ah,ao,aI,cQ,aH,eX,bd,eO,cX,F,ey,ex,ev,hC,eu,dl,hF,dn,hI,hJ,dp,hL,dr,dv,dw,hP,dx,hR,dA,hT,d_,hV,dZ,dP,dB,dI,dH,ia,dG,ic,id,dC,ig,gw;function dJ(a){return Boolean(a&&void 0!==a.length)}function hY(){}function l(a){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],el(a,this)}function ef(a,b){for(;3===a._state;)a=a._value;0!==a._state?(a._handled=!0,l._immediateFn(function(){var c=1===a._state?b.onFulfilled:b.onRejected,d;if(null!==c){try{d=c(a._value)}catch(a){return void aB(b.promise,a)}dz(b.promise,d)}else(1===a._state?dz:aB)(b.promise,a._value)})):a._deferreds.push(b)}function dz(a,b){var c,d,e;try{if(b===a)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){if(c=b.then,b instanceof l)return a._state=3,a._value=b,void dy(a);if("function"==typeof c)return void el((d=c,e=b,function(){d.apply(e,arguments)}),a)}a._state=1,a._value=b,dy(a)}catch(b){aB(a,b)}}function aB(a,b){a._state=2,a._value=b,dy(a)}function dy(a){2===a._state&&0===a._deferreds.length&&l._immediateFn(function(){a._handled||l._unhandledRejectionFn(a._value)});for(var b=0,c=a._deferreds.length;b<c;b++)ef(a,a._deferreds[b]);a._deferreds=null}function hQ(a,b,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.promise=c}function el(c,b){var a=!1;try{c(function(c){a||(a=!0,dz(b,c))},function(c){a||(a=!0,aB(b,c))})}catch(c){if(a)return;a=!0,aB(b,c)}}l.prototype.catch=function(a){return this.then(null,a)},l.prototype.then=function(b,c){var a=new this.constructor(hY);return ef(this,new hQ(b,c,a)),a},l.prototype.finally=function(b){var a=this.constructor;return this.then(function(c){return a.resolve(b()).then(function(){return c})},function(c){return a.resolve(b()).then(function(){return a.reject(c)})})},l.all=function(a){return new l(function(e,d){var b,f,c;if(!dJ(a))return d(new TypeError("Promise.all accepts an array"));if(b=Array.prototype.slice.call(a),0===b.length)return e([]);f=b.length;function g(c,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var h=a.then;if("function"==typeof h)return void h.call(a,function(a){g(c,a)},d)}b[c]=a,0==--f&&e(b)}catch(a){d(a)}}for(c=0;c<b.length;c++)g(c,b[c])})},l.allSettled=function(a){return new this(function(d,g){var b,e,c;if(!a||void 0===a.length)return g(new TypeError(typeof a+" "+a+" is not iterable(cannot read property Symbol(Symbol.iterator))"));if(b=Array.prototype.slice.call(a),0===b.length)return d([]);e=b.length;function f(c,a){if(a&&("object"==typeof a||"function"==typeof a)){var g=a.then;if("function"==typeof g)return void g.call(a,function(a){f(c,a)},function(a){b[c]={status:"rejected",reason:a},0==--e&&d(b)})}b[c]={status:"fulfilled",value:a},0==--e&&d(b)}for(c=0;c<b.length;c++)f(c,b[c])})},l.resolve=function(a){return a&&"object"==typeof a&&a.constructor===l?a:new l(function(b){b(a)})},l.reject=function(a){return new l(function(c,b){b(a)})},l.race=function(a){return new l(function(d,c){if(!dJ(a))return c(new TypeError("Promise.race accepts an array"));for(var b=0,e=a.length;b<e;b++)l.resolve(a[b]).then(d,c)})},l._immediateFn="function"==typeof setImmediate&&function(a){setImmediate(a)}||function(a){ie(a,0)},l._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)},ep=Object.getOwnPropertySymbols,hM=Object.prototype.hasOwnProperty,hK=Object.prototype.propertyIsEnumerable;function hG(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}ha=function(){var c,b,a,e,d;try{if(!Object.assign)return!1;if(c=new String("abc"),c[5]="de","5"===Object.getOwnPropertyNames(c)[0])return!1;for(b={},a=0;a<10;a++)b["_"+String.fromCharCode(a)]=a;return!(e=Object.getOwnPropertyNames(b).map(function(a){return b[a]}),"0123456789"!==e.join(""))&&(d={},"abcdefghijklmnopqrst".split("").forEach(function(a){d[a]=a}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},d)).join(""))}catch(a){return!1}}()?Object.assign:function(h,i){for(var a,b,g=arguments,f=hG(h),d=1,e,c;d<arguments.length;d++){for(e in a=Object(g[d]))hM.call(a,e)&&(f[e]=a[e]);if(ep){b=ep(a);for(c=0;c<b.length;c++)hK.call(a,b[c])&&(f[b[c]]=a[b[c]])}}return f},("undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:"undefined"!=typeof global&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=l),Object.assign||(Object.assign=ha),Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now)&&(hy=Date.now(),globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-hy});for(dj=Date.now(),eH=["ms","moz","webkit","o"],da=0;da<eH.length&&!globalThis.requestAnimationFrame;++da)c_=eH[da],globalThis.requestAnimationFrame=globalThis[c_+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[c_+"CancelAnimationFrame"]||globalThis[c_+"CancelRequestAnimationFrame"];globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(a){if("function"!=typeof a)throw new TypeError(a+"is not a function");var c=Date.now(),b=16+dj-c;return b<0&&(b=0),dj=c,globalThis.self.setTimeout(function(){dj=Date.now(),a(performance.now())},b)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(a){return clearTimeout(a)}),Math.sign||(Math.sign=function(a){return 0===(a=Number(a))||isNaN(a)?a:a>0?1:-1}),Number.isInteger||(Number.isInteger=function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array),a.ENV=void 0,a.RENDERER_TYPE=void 0,a.BUFFER_BITS=void 0,a.BLEND_MODES=void 0,a.DRAW_MODES=void 0,a.FORMATS=void 0,a.TARGETS=void 0,a.TYPES=void 0,a.SAMPLER_TYPES=void 0,a.SCALE_MODES=void 0,a.WRAP_MODES=void 0,a.MIPMAP_MODES=void 0,a.ALPHA_MODES=void 0,a.CLEAR_MODES=void 0,a.GC_MODES=void 0,a.PRECISION=void 0,a.MASK_TYPES=void 0,a.COLOR_MASK_BITS=void 0,a.MSAA_QUALITY=void 0,a.BUFFER_TYPE=void 0,function(a){a[a.WEBGL_LEGACY=0]="WEBGL_LEGACY",a[a.WEBGL=1]="WEBGL",a[a.WEBGL2=2]="WEBGL2"}(a.ENV||(a.ENV={})),function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.WEBGL=1]="WEBGL",a[a.CANVAS=2]="CANVAS"}(a.RENDERER_TYPE||(a.RENDERER_TYPE={})),function(a){a[a.COLOR=16384]="COLOR",a[a.DEPTH=256]="DEPTH",a[a.STENCIL=1024]="STENCIL"}(a.BUFFER_BITS||(a.BUFFER_BITS={})),function(a){a[a.NORMAL=0]="NORMAL",a[a.ADD=1]="ADD",a[a.MULTIPLY=2]="MULTIPLY",a[a.SCREEN=3]="SCREEN",a[a.OVERLAY=4]="OVERLAY",a[a.DARKEN=5]="DARKEN",a[a.LIGHTEN=6]="LIGHTEN",a[a.COLOR_DODGE=7]="COLOR_DODGE",a[a.COLOR_BURN=8]="COLOR_BURN",a[a.HARD_LIGHT=9]="HARD_LIGHT",a[a.SOFT_LIGHT=10]="SOFT_LIGHT",a[a.DIFFERENCE=11]="DIFFERENCE",a[a.EXCLUSION=12]="EXCLUSION",a[a.HUE=13]="HUE",a[a.SATURATION=14]="SATURATION",a[a.COLOR=15]="COLOR",a[a.LUMINOSITY=16]="LUMINOSITY",a[a.NORMAL_NPM=17]="NORMAL_NPM",a[a.ADD_NPM=18]="ADD_NPM",a[a.SCREEN_NPM=19]="SCREEN_NPM",a[a.NONE=20]="NONE",a[a.SRC_OVER=0]="SRC_OVER",a[a.SRC_IN=21]="SRC_IN",a[a.SRC_OUT=22]="SRC_OUT",a[a.SRC_ATOP=23]="SRC_ATOP",a[a.DST_OVER=24]="DST_OVER",a[a.DST_IN=25]="DST_IN",a[a.DST_OUT=26]="DST_OUT",a[a.DST_ATOP=27]="DST_ATOP",a[a.ERASE=26]="ERASE",a[a.SUBTRACT=28]="SUBTRACT",a[a.XOR=29]="XOR"}(a.BLEND_MODES||(a.BLEND_MODES={})),function(a){a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(a.DRAW_MODES||(a.DRAW_MODES={})),function(a){a[a.RGBA=6408]="RGBA",a[a.RGB=6407]="RGB",a[a.RG=33319]="RG",a[a.RED=6403]="RED",a[a.RGBA_INTEGER=36249]="RGBA_INTEGER",a[a.RGB_INTEGER=36248]="RGB_INTEGER",a[a.RG_INTEGER=33320]="RG_INTEGER",a[a.RED_INTEGER=36244]="RED_INTEGER",a[a.ALPHA=6406]="ALPHA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(a.FORMATS||(a.FORMATS={})),function(a){a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(a.TARGETS||(a.TARGETS={})),function(a){a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",a[a.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",a[a.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",a[a.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",a[a.BYTE=5120]="BYTE",a[a.SHORT=5122]="SHORT",a[a.INT=5124]="INT",a[a.FLOAT=5126]="FLOAT",a[a.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",a[a.HALF_FLOAT=36193]="HALF_FLOAT"}(a.TYPES||(a.TYPES={})),function(a){a[a.FLOAT=0]="FLOAT",a[a.INT=1]="INT",a[a.UINT=2]="UINT"}(a.SAMPLER_TYPES||(a.SAMPLER_TYPES={})),function(a){a[a.NEAREST=0]="NEAREST",a[a.LINEAR=1]="LINEAR"}(a.SCALE_MODES||(a.SCALE_MODES={})),function(a){a[a.CLAMP=33071]="CLAMP",a[a.REPEAT=10497]="REPEAT",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(a.WRAP_MODES||(a.WRAP_MODES={})),function(a){a[a.OFF=0]="OFF",a[a.POW2=1]="POW2",a[a.ON=2]="ON",a[a.ON_MANUAL=3]="ON_MANUAL"}(a.MIPMAP_MODES||(a.MIPMAP_MODES={})),function(a){a[a.NPM=0]="NPM",a[a.UNPACK=1]="UNPACK",a[a.PMA=2]="PMA",a[a.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",a[a.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",a[a.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",a[a.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(a.ALPHA_MODES||(a.ALPHA_MODES={})),function(a){a[a.NO=0]="NO",a[a.YES=1]="YES",a[a.AUTO=2]="AUTO",a[a.BLEND=0]="BLEND",a[a.CLEAR=1]="CLEAR",a[a.BLIT=2]="BLIT"}(a.CLEAR_MODES||(a.CLEAR_MODES={})),function(a){a[a.AUTO=0]="AUTO",a[a.MANUAL=1]="MANUAL"}(a.GC_MODES||(a.GC_MODES={})),function(a){a.LOW="lowp",a.MEDIUM="mediump",a.HIGH="highp"}(a.PRECISION||(a.PRECISION={})),function(a){a[a.NONE=0]="NONE",a[a.SCISSOR=1]="SCISSOR",a[a.STENCIL=2]="STENCIL",a[a.SPRITE=3]="SPRITE",a[a.COLOR=4]="COLOR"}(a.MASK_TYPES||(a.MASK_TYPES={})),function(a){a[a.RED=1]="RED",a[a.GREEN=2]="GREEN",a[a.BLUE=4]="BLUE",a[a.ALPHA=8]="ALPHA"}(a.COLOR_MASK_BITS||(a.COLOR_MASK_BITS={})),function(a){a[a.NONE=0]="NONE",a[a.LOW=2]="LOW",a[a.MEDIUM=4]="MEDIUM",a[a.HIGH=8]="HIGH"}(a.MSAA_QUALITY||(a.MSAA_QUALITY={})),function(a){a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(a.BUFFER_TYPE||(a.BUFFER_TYPE={})),eK={createCanvas:function(b,c){var a=document.createElement("canvas");return a.width=b,a.height=c,a},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var a;return null!==(a=document.baseURI)&&void 0!==a?a:window.location.href},fetch:function(a,b){return fetch(a,b)}},cY=/iPhone/i,eL=/iPod/i,eR=/iPad/i,ff=/\biOS-universal(?:.+)Mac\b/i,cT=/\bAndroid(?:.+)Mobile\b/i,fg=/Android/i,ag=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ba=/Silk/i,B=/Windows Phone/i,fi=/\bWindows(?:.+)ARM\b/i,fj=/BlackBerry/i,fm=/BB10/i,ft=/Opera Mini/i,fA=/\b(CriOS|Chrome)(?:.+)Mobile/i,fD=/Mobile(?:.+)Firefox\b/i,fL=function(a){return void 0!==a&&"MacIntel"===a.platform&&"number"==typeof a.maxTouchPoints&&a.maxTouchPoints>1&&"undefined"==typeof MSStream},s=function(c){var d={userAgent:"",platform:"",maxTouchPoints:0},e,f,a,b;return c||"undefined"==typeof navigator?"string"==typeof c?d.userAgent=c:c&&c.userAgent&&(d={userAgent:c.userAgent,platform:c.platform,maxTouchPoints:c.maxTouchPoints||0}):d={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0},e=d.userAgent,f=e.split("[FBAN"),void 0!==f[1]&&(e=f[0]),void 0!==(f=e.split("Twitter"))[1]&&(e=f[0]),a=function(a){return function(b){return b.test(a)}}(e),b={apple:{phone:a(cY)&&!a(B),ipod:a(eL),tablet:!a(cY)&&(a(eR)||fL(d))&&!a(B),universal:a(ff),device:(a(cY)||a(eL)||a(eR)||a(ff)||fL(d))&&!a(B)},amazon:{phone:a(ag),tablet:!a(ag)&&a(ba),device:a(ag)||a(ba)},android:{phone:!a(B)&&a(ag)||!a(B)&&a(cT),tablet:!a(B)&&!a(ag)&&!a(cT)&&(a(ba)||a(fg)),device:!a(B)&&(a(ag)||a(ba)||a(cT)||a(fg))||a(/\bokhttp\b/i)},windows:{phone:a(B),tablet:a(fi),device:a(B)||a(fi)},other:{blackberry:a(fj),blackberry10:a(fm),opera:a(ft),firefox:a(fD),chrome:a(fA),device:a(fj)||a(fm)||a(ft)||a(fD)||a(fA)},any:!1,phone:!1,tablet:!1},b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}(globalThis.navigator),b={ADAPTER:eK,MIPMAP_TEXTURES:a.MIPMAP_MODES.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:a.MSAA_QUALITY.NONE,SPRITE_MAX_TEXTURES:function(c){var a,b=!0;return(s.tablet||s.phone)&&(s.apple.device&&(a=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(a[1],10)<11&&(b=!1),s.android.device&&(a=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(a[1],10)<7&&(b=!1)),b?32:4}(),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:a.GC_MODES.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:a.WRAP_MODES.CLAMP,SCALE_MODE:a.SCALE_MODES.LINEAR,PRECISION_VERTEX:a.PRECISION.HIGH,PRECISION_FRAGMENT:s.apple.device?a.PRECISION.HIGH:a.PRECISION.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!s.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},cK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function cJ(b,c,a){return b(a={path:c,exports:{},require:function(c,b){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==b&&a.path)}},a.exports),a.exports}af=cJ(function(g){var h=Object.prototype.hasOwnProperty,b="~";function c(){}function f(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function e(a,e,g,h,i){if("function"!=typeof g)throw new TypeError("The listener must be a function");var d=new f(g,h||a,i),c=b?b+e:e;return a._events[c]?a._events[c].fn?a._events[c]=[a._events[c],d]:a._events[c].push(d):(a._events[c]=d,a._eventsCount++),a}function d(a,b){0==--a._eventsCount?a._events=new c:delete a._events[b]}function a(){this._events=new c,this._eventsCount=0}Object.create&&(c.prototype=Object.create(null),(new c).__proto__||(b=!1)),a.prototype.eventNames=function(){var d,a,c=[];if(0===this._eventsCount)return c;for(a in d=this._events)h.call(d,a)&&c.push(b?a.slice(1):a);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},a.prototype.listeners=function(d){var g=b?b+d:d,a=this._events[g],c,e,f;if(!a)return[];if(a.fn)return[a.fn];for(c=0,e=a.length,f=new Array(e);c<e;c++)f[c]=a[c].fn;return f},a.prototype.listenerCount=function(c){var d=b?b+c:c,a=this._events[d];return a?a.fn?1:a.length:0},a.prototype.emit=function(j,d,g,i,m,n){var l=arguments,k=b?b+j:j,e,c,a,f,h,o;if(!this._events[k])return!1;if(a=this._events[k],f=arguments.length,a.fn){switch(a.once&&this.removeListener(j,a.fn,void 0,!0),f){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,d),!0;case 3:return a.fn.call(a.context,d,g),!0;case 4:return a.fn.call(a.context,d,g,i),!0;case 5:return a.fn.call(a.context,d,g,i,m),!0;case 6:return a.fn.call(a.context,d,g,i,m,n),!0}for(c=1,e=new Array(f-1);c<f;c++)e[c-1]=l[c];a.fn.apply(a.context,e)}else{o=a.length;for(c=0;c<o;c++)switch(a[c].once&&this.removeListener(j,a[c].fn,void 0,!0),f){case 1:a[c].fn.call(a[c].context);break;case 2:a[c].fn.call(a[c].context,d);break;case 3:a[c].fn.call(a[c].context,d,g);break;case 4:a[c].fn.call(a[c].context,d,g,i);break;default:if(!e)for(h=1,e=new Array(f-1);h<f;h++)e[h-1]=l[h];a[c].fn.apply(a[c].context,e)}}return!0},a.prototype.on=function(a,b,c){return e(this,a,b,c,!1)},a.prototype.once=function(a,b,c){return e(this,a,b,c,!0)},a.prototype.removeListener=function(j,h,g,i){var e=b?b+j:j,a,c,f,k;if(!this._events[e])return this;if(!h)return d(this,e),this;if(a=this._events[e],a.fn)a.fn!==h||i&&!a.once||g&&a.context!==g||d(this,e);else{for(c=0,f=[],k=a.length;c<k;c++)(a[c].fn!==h||i&&!a[c].once||g&&a[c].context!==g)&&f.push(a[c]);f.length?this._events[e]=1===f.length?f[0]:f:d(this,e)}return this},a.prototype.removeAllListeners=function(a){var e;return a?(e=b?b+a:a,this._events[e]&&d(this,e)):(this._events=new c,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=b,a.EventEmitter=a,g.exports=a}),aT=aQ,hb=aQ;function aQ(b,l,a){var d,e,g,h,j,i,f,n,o,c,m,k;if(a=a||2,n=l&&l.length,o=n?l[0]*a:b.length,c=fT(b,0,o,a,!0),m=[],!c||c.next===c.prev)return m;if(n&&(c=function(h,g,d,e){var a,f,b,c=[];for(a=0,f=g.length;a<f;a++)(b=fT(h,g[a]*e,a<f-1?g[a+1]*e:h.length,e,!1))===b.next&&(b.steiner=!0),c.push(gA(b));for(c.sort(gF),a=0;a<c.length;a++)d=gE(c[a],d);return d}(b,l,c,a)),b.length>80*a){d=g=b[0],e=h=b[1];for(k=a;k<o;k+=a)(j=b[k])<d&&(d=j),(i=b[k+1])<e&&(e=i),j>g&&(g=j),i>h&&(h=i);f=0!==(f=Math.max(g-d,h-e))?32767/f:0}return aM(c,m,a,d,e,f,0),m}function fT(c,e,f,d,g){var a,b;if(g===ck(c,e,f,d)>0)for(a=e;a<f;a+=d)b=gl(a,c[a],c[a+1],b);else for(a=f-d;a>=e;a-=d)b=gl(a,c[a],c[a+1],b);return b&&aR(b,b.next)&&(au(b),b=b.next),b}function V(c,b){if(!c)return c;b||(b=c);var d,a=c;do if(d=!1,a.steiner||!aR(a,a.next)&&0!==j(a.prev,a,a.next))a=a.next;else{if(au(a),(a=b=a.prev)===a.next)break;d=!0}while(d||a!==b)return b}function aM(a,b,c,e,f,d,h){if(a){!h&&d&&function(b,c,d,e){var a=b;do 0===a.z&&(a.z=cs(a.x,a.y,c,d,e)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==b)a.prevZ.nextZ=null,a.prevZ=null,function(g){var i,b,a,c,d,h,e,f,j=1;do{for(b=g,g=null,d=null,h=0;b;){for(h++,a=b,e=0,i=0;i<j&&(e++,a=a.nextZ);i++);for(f=j;e>0||f>0&&a;)0!==e&&(0===f||!a||b.z<=a.z)?(c=b,b=b.nextZ,e--):(c=a,a=a.nextZ,f--),d?d.nextZ=c:g=c,c.prevZ=d,d=c;b=a}d.nextZ=null,j*=2}while(h>1)}(a)}(a,e,f,d);for(var i,g,j=a;a.prev!==a.next;)if(i=a.prev,g=a.next,d?gJ(a,e,f,d):gK(a))b.push(i.i/c|0),b.push(a.i/c|0),b.push(g.i/c|0),au(a),a=g.next,j=g.next;else if((a=g)===j){h?1===h?aM(a=gH(V(a),b,c),b,c,e,f,d,2):2===h&&gG(a,b,c,e,f,d):aM(V(a),b,c,e,f,d,1);break}}}function gK(l){var i=l.prev,k=l,h=l.next,e,f,b,g,d,c,m,n,o,p,a;if(j(i,k,h)>=0)return!1;for(e=i.x,f=k.x,b=h.x,g=i.y,d=k.y,c=h.y,m=e<f?e<b?e:b:f<b?f:b,n=g<d?g<c?g:c:d<c?d:c,o=e>f?e>b?e:b:f>b?f:b,p=g>d?g>c?g:c:d>c?d:c,a=h.next;a!==i;){if(a.x>=m&&a.x<=o&&a.y>=n&&a.y<=p&&ae(e,g,f,d,b,c,a.x,a.y)&&j(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function gJ(p,u,v,r){var i=p.prev,q=p,k=p.next,e,g,d,h,f,c,l,o,n,m,s,t,a,b;if(j(i,q,k)>=0)return!1;for(e=i.x,g=q.x,d=k.x,h=i.y,f=q.y,c=k.y,l=e<g?e<d?e:d:g<d?g:d,o=h<f?h<c?h:c:f<c?f:c,n=e>g?e>d?e:d:g>d?g:d,m=h>f?h>c?h:c:f>c?f:c,s=cs(l,o,u,v,r),t=cs(n,m,u,v,r),a=p.prevZ,b=p.nextZ;a&&a.z>=s&&b&&b.z<=t;){if(a.x>=l&&a.x<=n&&a.y>=o&&a.y<=m&&a!==i&&a!==k&&ae(e,h,g,f,d,c,a.x,a.y)&&j(a.prev,a,a.next)>=0)return!1;if(a=a.prevZ,b.x>=l&&b.x<=n&&b.y>=o&&b.y<=m&&b!==i&&b!==k&&ae(e,h,g,f,d,c,b.x,b.y)&&j(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;a&&a.z>=s;){if(a.x>=l&&a.x<=n&&a.y>=o&&a.y<=m&&a!==i&&a!==k&&ae(e,h,g,f,d,c,a.x,a.y)&&j(a.prev,a,a.next)>=0)return!1;a=a.prevZ}for(;b&&b.z<=t;){if(b.x>=l&&b.x<=n&&b.y>=o&&b.y<=m&&b!==i&&b!==k&&ae(e,h,g,f,d,c,b.x,b.y)&&j(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function gH(d,e,f){var a=d,c,b;do c=a.prev,b=a.next.next,!aR(c,b)&&gk(c,a,a.next,b)&&ax(c,b)&&ax(b,c)&&(e.push(c.i/f|0),e.push(a.i/f|0),e.push(b.i/f|0),au(a),au(a.next),a=d=b),a=a.next;while(a!==d)return V(a)}function gG(g,h,i,d,e,f){var a=g,b,c;do{for(b=a.next.next;b!==a.prev;){if(a.i!==b.i&&gz(a,b))return c=fU(a,b),a=V(a,a.next),c=V(c,c.next),aM(a,h,i,d,e,f,0),void aM(c,h,i,d,e,f,0);b=b.next}a=a.next}while(a!==g)}function gF(a,b){return a.x-b.x}function gE(b,c){var a=function(h,l){var b,a=l,d=h.x,c=h.y,g=-1/0,e,f,m,k,i,j;do{if(c<=a.y&&c>=a.next.y&&a.next.y!==a.y)if(e=a.x+(c-a.y)*(a.next.x-a.x)/(a.next.y-a.y),e<=d&&e>g&&(g=e,b=a.x<a.next.x?a:a.next,e===d))return b;a=a.next}while(a!==l)if(!b)return null;m=b,k=b.x,i=b.y,j=1/0,a=b;do d>=a.x&&a.x>=k&&d!==a.x&&ae(c<i?d:g,c,k,i,c<i?g:d,c,a.x,a.y)&&(f=Math.abs(c-a.y)/(d-a.x),ax(a,h)&&(f<j||f===j&&(a.x>b.x||a.x===b.x&&gC(b,a)))&&(b=a,j=f)),a=a.next;while(a!==m)return b}(b,c),d;return a?(d=fU(a,b),V(d,d.next),V(a,a.next)):c}function gC(a,b){return j(a.prev,a,b.prev)<0&&j(b.next,a,a.next)<0}function cs(a,b,d,e,c){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-d)*c|0)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=(b-e)*c|0)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function gA(c){var a=c,b=c;do(a.x<b.x||a.x===b.x&&a.y<b.y)&&(b=a),a=a.next;while(a!==c)return b}function ae(g,h,c,d,e,f,a,b){return(e-a)*(h-b)>=(g-a)*(f-b)&&(g-a)*(d-b)>=(c-a)*(h-b)&&(c-a)*(f-b)>=(e-a)*(d-b)}function gz(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(b,c){var a=b;do{if(a.i!==b.i&&a.next.i!==b.i&&a.i!==c.i&&a.next.i!==c.i&&gk(a,a.next,b,c))return!0;a=a.next}while(a!==b)return!1}(a,b)&&(ax(a,b)&&ax(b,a)&&function(b,e){var a=b,c=!1,f=(b.x+e.x)/2,d=(b.y+e.y)/2;do a.y>d!=a.next.y>d&&a.next.y!==a.y&&f<(a.next.x-a.x)*(d-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==b)return c}(a,b)&&(j(a.prev,a,b.prev)||j(a,b.prev,b))||aR(a,b)&&j(a.prev,a,a.next)>0&&j(b.prev,b,b.next)>0)}function j(b,a,c){return(a.y-b.y)*(c.x-a.x)-(a.x-b.x)*(c.y-a.y)}function aR(a,b){return a.x===b.x&&a.y===b.y}function gk(a,b,c,d){var e=bx(j(a,b,c)),f=bx(j(a,b,d)),g=bx(j(c,d,a)),h=bx(j(c,d,b));return e!==f&&g!==h||!(0!==e||!bq(a,c,b))||!(0!==f||!bq(a,d,b))||!(0!==g||!bq(c,a,d))||!(0!==h||!bq(c,b,d))}function bq(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function bx(a){return a>0?1:a<0?-1:0}function ax(a,b){return j(a.prev,a,a.next)<0?j(a,b,a.next)>=0&&j(a,a.prev,b)>=0:j(a,b,a.prev)<0||j(a,a.next,b)<0}function fU(a,b){var d=new cl(a.i,a.x,a.y),c=new cl(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,d.next=e,e.prev=d,c.next=d,d.prev=c,f.next=c,c.prev=f,c}function gl(c,d,e,b){var a=new cl(c,d,e);return b?(a.next=b.next,a.prev=b,b.next.prev=a,b.next=a):(a.prev=a,a.next=a),a}function au(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function cl(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ck(b,g,d,e){for(var f=0,a=g,c=d-e;a<d;a+=e)f+=(b[c]-b[a])*(b[a+1]+b[c+1]),c=a;return f}aQ.deviation=function(a,d,c,e){var k=d&&d.length,o=k?d[0]*c:a.length,g=Math.abs(ck(a,0,o,c)),b,i,n,m,h,f,j,l;if(k)for(b=0,i=d.length;b<i;b++)n=d[b]*c,m=b<i-1?d[b+1]*c:a.length,g-=Math.abs(ck(a,n,m,c));h=0;for(b=0;b<e.length;b+=3)f=e[b]*c,j=e[b+1]*c,l=e[b+2]*c,h+=Math.abs((a[f]-a[l])*(a[j+1]-a[f+1])-(a[f]-a[j])*(a[l+1]-a[f+1]));return 0===g&&0===h?0:Math.abs((h-g)/g)},aQ.flatten=function(b){for(var f=b[0][0].length,c={vertices:[],holes:[],dimensions:f},g=0,a=0,d,e;a<b.length;a++){for(d=0;d<b[a].length;d++)for(e=0;e<f;e++)c.vertices.push(b[a][d][e]);a>0&&(g+=b[a-1].length,c.holes.push(g))}return c},aT.default=hb,gt=cJ(function(a,b){!function(n){var k=b&&!b.nodeType&&b,q=a&&!a.nodeType&&a,f="object"==typeof cK&&cK,g,j,h,d,x,w,v,y,c,i;f.global!==f&&f.window!==f&&f.self!==f||(n=f),h=2147483647,d=36,x=/^xn--/,w=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=Math.floor,i=String.fromCharCode;function e(a){throw RangeError(y[a])}function r(b,d){for(var a=b.length,c=[];a--;)c[a]=d(b[a]);return c}function s(a,d){var b=a.split("@"),c="";return b.length>1&&(c=b[0]+"@",a=b[1]),c+r((a=a.replace(v,".")).split("."),d).join(".")}function t(d){for(var a,e,c=[],b=0,f=d.length;b<f;)(a=d.charCodeAt(b++))>=55296&&a<=56319&&b<f?56320==(64512&(e=d.charCodeAt(b++)))?c.push(((1023&a)<<10)+(1023&e)+65536):(c.push(a),b--):c.push(a);return c}function u(a){return r(a,function(a){var b="";return a>65535&&(b+=i((a-=65536)>>>10&1023|55296),a=56320|1023&a),b+=i(a)}).join("")}function m(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function o(a,e,f){var b=0;for(a=f?c(a/700):a>>1,a+=c(a/e);a>455;b+=d)a=c(a/35);return c(b+36*a/(a+38))}function p(k){var m,g,i,l,r,j,f,p,v,t,b,n=[],w=k.length,a=0,s=128,q=72;for((g=k.lastIndexOf("-"))<0&&(g=0),i=0;i<g;++i)k.charCodeAt(i)>=128&&e("not-basic"),n.push(k.charCodeAt(i));for(l=g>0?g+1:0;l<w;){for(r=a,j=1,f=d;l>=w&&e("invalid-input"),((p=(b=k.charCodeAt(l++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:d)>=d||p>c((h-a)/j))&&e("overflow"),a+=p*j,!(p<(v=f<=q?1:f>=q+26?26:f-q));f+=d)j>c(h/(t=d-v))&&e("overflow"),j*=t;q=o(a-r,m=n.length+1,0==r),c(a/m)>h-s&&e("overflow"),s+=c(a/m),a%=m,n.splice(a++,0,s)}return u(n)}function l(s){var b,f,l,v,p,a,j,r,q,u,g,n,w,x,y,k=[];for(n=(s=t(s)).length,b=128,f=0,p=72,a=0;a<n;++a)(g=s[a])<128&&k.push(i(g));for(l=v=k.length,v&&k.push("-");l<n;){for(j=h,a=0;a<n;++a)(g=s[a])>=b&&g<j&&(j=g);for(j-b>c((h-f)/(w=l+1))&&e("overflow"),f+=(j-b)*w,b=j,a=0;a<n;++a)if((g=s[a])<b&&++f>h&&e("overflow"),g==b){for(r=f,q=d;!(r<(u=q<=p?1:q>=p+26?26:q-p));q+=d)y=r-u,x=d-u,k.push(i(m(u+y%x,0))),r=c(y/x);k.push(i(m(r,0))),p=o(f,w,l==v),f=0,++l}++f,++b}return k.join("")}if(g={version:"1.3.2",ucs2:{decode:t,encode:u},decode:p,encode:l,toASCII:function(a){return s(a,function(a){return w.test(a)?"xn--"+l(a):a})},toUnicode:function(a){return s(a,function(a){return x.test(a)?p(a.slice(4).toLowerCase()):a})}},k&&q)if(a.exports==k)q.exports=g;else for(j in g)g.hasOwnProperty(j)&&(k[j]=g[j]);else n.punycode=g}(cK)}),cj=function(a){return"string"==typeof a},gm=function(a){return"object"==typeof a&&null!==a},bz=function(a){return null===a},gp=function(a){return null==a};function gq(a,b){return Object.prototype.hasOwnProperty.call(a,b)}gs=function(c,n,m,l){var a,o,d,j,i,h,g,b,e,f,k;if(n=n||"&",m=m||"=",a={},"string"!=typeof c||0===c.length)return a;o=/\+/g,c=c.split(n),d=1e3,l&&"number"==typeof l.maxKeys&&(d=l.maxKeys),j=c.length,d>0&&j>d&&(j=d);for(i=0;i<j;++i)f=c[i].replace(o,"%20"),k=f.indexOf(m),k>=0?(h=f.substr(0,k),g=f.substr(k+1)):(h=f,g=""),b=decodeURIComponent(h),e=decodeURIComponent(g),gq(a,b)?Array.isArray(a[b])?a[b].push(e):a[b]=[a[b],e]:a[b]=e;return a},az=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}},gv=function(a,b,c,d){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?Object.keys(a).map(function(d){var e=encodeURIComponent(az(d))+c;return Array.isArray(a[d])?a[d].map(function(a){return e+encodeURIComponent(az(a))}).join(b):e+encodeURIComponent(az(a[d]))}).join(b):d?encodeURIComponent(az(d))+c+encodeURIComponent(az(a)):""},ce=cJ(function(b,a){a.decode=a.parse=gs,a.encode=a.stringify=gv}),gy=aS,gD=function(a,b){return aS(a,!1,!0).resolve(b)},gL=function(a){return cj(a)&&(a=aS(a)),!(a instanceof t)?t.prototype.format.call(a):a.format()};function t(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}gT=/^([a-z0-9.+-]+:)/i,gU=/:[0-9]*$/,gX=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,gZ=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","	"]),cb=["'"].concat(gZ),fZ=["%","/","?",";","#"].concat(cb),fY=["/","?","#"],fW=/^[+a-z0-9A-Z_-]{0,63}$/,g_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g$={javascript:!0,"javascript:":!0},bW={javascript:!0,"javascript:":!0},ad={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function aS(a,c,d){if(a&&gm(a)&&a instanceof t)return a;var b=new t;return b.parse(a,c,d),b}t.prototype.parse=function(g,v,F){var C,B,q,a,j,d,p,A,z,n,c,b,f,x,l,s,e,u,i,D,y,m,w,o,E,h,r,t,k,G;if(!cj(g))throw new TypeError("Parameter 'url' must be a string, not "+typeof g);if(C=g.indexOf("?"),B=-1!==C&&C<g.indexOf("#")?"?":"#",q=g.split(B),q[0]=q[0].replace(/\\/g,"/"),a=g=q.join(B),a=a.trim(),!F&&1===g.split("#").length)if(j=gX.exec(a),j)return this.path=a,this.href=a,this.pathname=j[1],j[2]?(this.search=j[2],this.query=v?ce.parse(this.search.substr(1)):this.search.substr(1)):v&&(this.search="",this.query={}),this;if(d=gT.exec(a),d&&(p=(d=d[0]).toLowerCase(),this.protocol=p,a=a.substr(d.length)),(F||d||a.match(/^\/\/[^@\/]+@[^@\/]+/))&&(A="//"===a.substr(0,2),!A||d&&bW[d]||(a=a.substr(2),this.slashes=!0)),!bW[d]&&(A||d&&!ad[d])){for(z,n,c=-1,b=0;b<fY.length;b++)-1!==(f=a.indexOf(fY[b]))&&(-1===c||f<c)&&(c=f);-1!==(n=-1===c?a.lastIndexOf("@"):a.lastIndexOf("@",c))&&(z=a.slice(0,n),a=a.slice(n+1),this.auth=decodeURIComponent(z)),c=-1;for(b=0;b<fZ.length;b++)-1!==(f=a.indexOf(fZ[b]))&&(-1===c||f<c)&&(c=f);if(-1===c&&(c=a.length),this.host=a.slice(0,c),a=a.slice(c),this.parseHost(),this.hostname=this.hostname||"",x="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1],!x)for(l=this.hostname.split(/\./),s=(b=0,l.length);b<s;b++)if(e=l[b],e&&!e.match(fW)){for(u="",i=0,D=e.length;i<D;i++)e.charCodeAt(i)>127?u+="x":u+=e[i];if(!u.match(fW)){y=l.slice(0,b),m=l.slice(b+1),w=e.match(g_),w&&(y.push(w[1]),m.unshift(w[2])),m.length&&(a="/"+m.join(".")+a),this.hostname=y.join(".");break}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=gt.toASCII(this.hostname)),o=this.port?":"+this.port:"",E=this.hostname||"",this.host=E+o,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!g$[p])for(b=0,s=cb.length;b<s;b++)h=cb[b],-1!==a.indexOf(h)&&(r=encodeURIComponent(h),r===h&&(r=escape(h)),a=a.split(h).join(r));return t=a.indexOf("#"),-1!==t&&(this.hash=a.substr(t),a=a.slice(0,t)),k=a.indexOf("?"),(-1!==k?(this.search=a.substr(k),this.query=a.substr(k+1),v&&(this.query=ce.parse(this.query)),a=a.slice(0,k)):v&&(this.search="",this.query={}),a&&(this.pathname=a),ad[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search)&&(o=this.pathname||"",G=this.search||"",this.path=o+G),this.href=this.format(),this},t.prototype.format=function(){var b=this.auth||"",c,d,f,a,g,e;return b&&(b=(b=encodeURIComponent(b)).replace(/%3A/i,":"),b+="@"),c=this.protocol||"",d=this.pathname||"",f=this.hash||"",a=!1,g="",this.host?a=b+this.host:this.hostname&&(a=b+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&gm(this.query)&&Object.keys(this.query).length&&(g=ce.stringify(this.query)),e=this.search||g&&"?"+g||"",c&&":"!==c.substr(-1)&&(c+=":"),this.slashes||(!c||ad[c])&&!1!==a?(a="//"+(a||""),d&&"/"!==d.charAt(0)&&(d="/"+d)):a||(a=""),f&&"#"!==f.charAt(0)&&(f="#"+f),e&&"?"!==e.charAt(0)&&(e="?"+e),c+a+(d=d.replace(/[?#]/g,function(a){return encodeURIComponent(a)}))+(e=e.replace("#","%23"))+f},t.prototype.resolve=function(a){return this.resolveObject(aS(a,!1,!0)).format()},t.prototype.resolveObject=function(b){var u,a,s,l,r,p,j,k,v,m,o,d,B,A,z,q,e,y,c,n,h,x,i,g,f,w;cj(b)&&(u=new t,u.parse(b,!1,!0),b=u);for(a=new t,s=Object.keys(this),l=0;l<s.length;l++)r=s[l],a[r]=this[r];if(a.hash=b.hash,""===b.href)return a.href=a.format(),a;if(b.slashes&&!b.protocol){for(p=Object.keys(b),j=0;j<p.length;j++)k=p[j],"protocol"!==k&&(a[k]=b[k]);return ad[a.protocol]&&a.hostname&&!a.pathname&&(a.path=a.pathname="/"),a.href=a.format(),a}if(b.protocol&&b.protocol!==a.protocol){if(!ad[b.protocol]){for(v=Object.keys(b),m=0;m<v.length;m++)o=v[m],a[o]=b[o];return a.href=a.format(),a}if(a.protocol=b.protocol,b.host||bW[b.protocol])a.pathname=b.pathname;else{for(d=(b.pathname||"").split("/");d.length&&!(b.host=d.shift()););b.host||(b.host=""),b.hostname||(b.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),a.pathname=d.join("/")}return(a.search=b.search,a.query=b.query,a.host=b.host||"",a.auth=b.auth,a.hostname=b.hostname||b.host,a.port=b.port,a.pathname||a.search)&&(B=a.pathname||"",A=a.search||"",a.path=B+A),a.slashes=a.slashes||b.slashes,a.href=a.format(),a}if(z=a.pathname&&"/"===a.pathname.charAt(0),q=b.host||b.pathname&&"/"===b.pathname.charAt(0),e=q||z||a.host&&b.pathname,y=e,c=a.pathname&&a.pathname.split("/")||[],n=(d=b.pathname&&b.pathname.split("/")||[],a.protocol&&!ad[a.protocol]),n&&(a.hostname="",a.port=null,a.host&&(""===c[0]?c[0]=a.host:c.unshift(a.host)),a.host="",b.protocol&&(b.hostname=null,b.port=null,b.host&&(""===d[0]?d[0]=b.host:d.unshift(b.host)),b.host=null),e=e&&(""===d[0]||""===c[0])),q)a.host=b.host||""===b.host?b.host:a.host,a.hostname=b.hostname||""===b.hostname?b.hostname:a.hostname,a.search=b.search,a.query=b.query,c=d;else if(d.length)c||(c=[]),c.pop(),c=c.concat(d),a.search=b.search,a.query=b.query;else if(!gp(b.search))return n&&(a.hostname=a.host=c.shift(),(f=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=f.shift(),a.host=a.hostname=f.shift())),a.search=b.search,a.query=b.query,bz(a.pathname)&&bz(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a;if(!c.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(h=c.slice(-1)[0],x=(a.host||b.host||c.length>1)&&("."===h||".."===h)||""===h,i=0,g=c.length;g>=0;g--)"."===(h=c[g])?c.splice(g,1):".."===h?(c.splice(g,1),i++):i&&(c.splice(g,1),i--);if(!e&&!y)for(;i--;i)c.unshift("..");return!e||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),x&&"/"!==c.join("/").substr(-1)&&c.push(""),w=""===c[0]||c[0]&&"/"===c[0].charAt(0),n&&(a.hostname=a.host=w?"":c.length?c.shift():"",(f=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=f.shift(),a.host=a.hostname=f.shift())),(e=e||a.host&&c.length)&&!w&&c.unshift(""),c.length?a.pathname=c.join("/"):(a.pathname=null,a.path=null),bz(a.pathname)&&bz(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=b.auth||a.auth,a.slashes=a.slashes||b.slashes,a.href=a.format(),a},t.prototype.parseHost=function(){var a=this.host,b=gU.exec(a);b&&(":"!==(b=b[0])&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)},L={parse:gy,format:gL,resolve:gD};function v(a){if("string"!=typeof a)throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function fO(a){return a.split("?")[0].split("#")[0]}fH={toPosix:function(a){return"\\","/",a.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl:function(a){return/^https?:/.test(this.toPosix(a))},isDataUrl:function(a){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(a)},hasProtocol:function(a){return/^[^/:]+:\//.test(this.toPosix(a))},getProtocol:function(a){var e,b,c,d,f;return v(a),a=this.toPosix(a),e="",b=/^file:\/\/\//.exec(a),c=/^[^/:]+:\/\//.exec(a),d=/^[^/:]+:\//.exec(a),(b||c||d)&&(f=(null==b?void 0:b[0])||(null==c?void 0:c[0])||(null==d?void 0:d[0]),e=f,a=a.slice(f.length)),e},toAbsolute:function(a,c,d){if(this.isDataUrl(a))return a;var e=fO(this.toPosix(null!=c?c:b.ADAPTER.getBaseUrl())),f=fO(this.toPosix(null!=d?d:this.rootname(e)));return v(a),(a=this.toPosix(a)).startsWith("/")?fH.join(f,a.slice(1)):this.isAbsolute(a)?a:this.join(e,a)},normalize:function(a){var b,c,d;return v(a=this.toPosix(a)),0===a.length?".":(b="",c=a.startsWith("/"),this.hasProtocol(a)&&(b=this.rootname(a),a=a.slice(b.length)),d=a.endsWith("/"),(a=function(g,i){for(var e,a="",f=0,d=-1,c=0,b=0,h;b<=g.length;++b){if(b<g.length)e=g.charCodeAt(b);else{if(47===e)break;e=47}if(47===e){if(d===b-1||1===c);else if(d!==b-1&&2===c){if(a.length<2||2!==f||46!==a.charCodeAt(a.length-1)||46!==a.charCodeAt(a.length-2))if(a.length>2){if(h=a.lastIndexOf("/"),h!==a.length-1){-1===h?(a="",f=0):f=(a=a.slice(0,h)).length-1-a.lastIndexOf("/"),d=b,c=0;continue}}else if(2===a.length||1===a.length){a="",f=0,d=b,c=0;continue}}else a.length>0?a+="/"+g.slice(d+1,b):a=g.slice(d+1,b),f=b-d-1;d=b,c=0}else 46===e&&-1!==c?++c:c=-1}return a}(a)).length>0&&d&&(a+="/"),c?"/"+a:b+a)},isAbsolute:function(a){return v(a),a=this.toPosix(a),!!this.hasProtocol(a)||a.startsWith("/")},join:function(){for(var f,a,g=arguments,c=[],d=0,e,b,h;d<arguments.length;d++)c[d]=g[d];if(0===c.length)return".";for(e=0;e<c.length;++e)b=c[e],(v(b),b.length>0)&&(void 0===a?a=b:(h=null!==(f=c[e-1])&&void 0!==f?f:"",this.extname(h)?a+="/../"+b:a+="/"+b));return void 0===a?".":this.normalize(a)},dirname:function(a){if(v(a),0===a.length)return".";for(var g=(a=this.toPosix(a)).charCodeAt(0),e=47===g,c=-1,f=!0,d=this.getProtocol(a),h=a,b=(a=a.slice(d.length)).length-1;b>=1;--b)if(47===(g=a.charCodeAt(b))){if(!f){c=b;break}}else f=!1;return-1===c?e?"/":this.isUrl(h)?d+a:d:e&&1===c?"//":d+a.slice(0,c)},rootname:function(a){var b,c;return v(a),b="",(b=(a=this.toPosix(a)).startsWith("/")?"/":this.getProtocol(a),this.isUrl(a))&&(c=a.indexOf("/",b.length),(b=-1!==c?a.slice(0,c):a).endsWith("/")||(b+="/")),b},basename:function(b,d){var a,e,c,f,g,h,i;if(v(b),d&&v(d),b=this.toPosix(b),e=0,c=-1,f=!0,void 0!==d&&d.length>0&&d.length<=b.length){if(d.length===b.length&&d===b)return"";g=d.length-1,h=-1;for(a=b.length-1;a>=0;--a)if(i=b.charCodeAt(a),47===i){if(!f){e=a+1;break}}else-1===h&&(f=!1,h=a+1),g>=0&&(i===d.charCodeAt(g)?-1==--g&&(c=a):(g=-1,c=h));return e===c?c=h:-1===c&&(c=b.length),b.slice(e,c)}for(a=b.length-1;a>=0;--a)if(47===b.charCodeAt(a)){if(!f){e=a+1;break}}else-1===c&&(f=!1,c=a+1);return-1===c?"":b.slice(e,c)},extname:function(e){var a,f,c,g,d,b,h;v(e);for(a=-1,f=0,c=-1,g=!0,d=0,b=(e=this.toPosix(e)).length-1;b>=0;--b)if(h=e.charCodeAt(b),47!==h)-1===c&&(g=!1,c=b+1),46===h?-1===a?a=b:1!==d&&(d=1):-1!==a&&(d=-1);else if(!g){f=b+1;break}return-1===a||-1===c||0===d||1===d&&a===c-1&&a===f+1?"":e.slice(a,c)},parse:function(a){var b,i,k,h,d,e,c,j,f,g;if(v(a),b={root:"",dir:"",base:"",ext:"",name:""},0===a.length)return b;k=(a=this.toPosix(a)).charCodeAt(0),h=this.isAbsolute(a),b.root=this.rootname(a),i=h||this.hasProtocol(a)?1:0;for(d=-1,e=0,c=-1,j=!0,f=a.length-1,g=0;f>=i;--f)if(47!==(k=a.charCodeAt(f)))-1===c&&(j=!1,c=f+1),46===k?-1===d?d=f:1!==g&&(g=1):-1!==d&&(g=-1);else if(!j){e=f+1;break}return-1===d||-1===c||0===g||1===g&&d===c-1&&d===e+1?-1!==c&&(b.base=b.name=0===e&&h?a.slice(1,c):a.slice(e,c)):(0===e&&h?(b.name=a.slice(1,d),b.base=a.slice(1,c)):(b.name=a.slice(e,d),b.base=a.slice(e,c)),b.ext=a.slice(d,c)),b.dir=this.dirname(a),b},sep:"/",delimiter:":"},b.RETINA_PREFIX=/@([0-9\.]+)x/,b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,bQ=!1;function fC(a){var c,d;bQ||(b.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1?(d=["\n %c %c %c PixiJS 6.5.8 - ✰ "+a+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"],(c=globalThis.console).log.apply(c,d)):globalThis.console&&globalThis.console.log("PixiJS 6.5.8 - "+a+" - http://www.pixijs.com/"),bQ=!0)}function fB(){return void 0===bR&&(bR=function(){var c={stencil:!0,failIfMajorPerformanceCaveat:b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT},d,a,f,e;try{return!!b.ADAPTER.getWebGLRenderingContext()&&(d=b.ADAPTER.createCanvas(),a=d.getContext("webgl",c)||d.getContext("experimental-webgl",c),f=!(!a||!a.getContextAttributes().stencil),a&&(e=a.getExtension("WEBGL_lose_context"),e&&e.loseContext()),a=null,f)}catch(a){return!1}}()),bR}hh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function T(b,a){return void 0===a&&(a=[]),a[0]=(b>>16&255)/255,a[1]=(b>>8&255)/255,a[2]=(255&b)/255,a}function bP(b){var a=b.toString(16);return"#"+("000000".substring(0,6-a.length)+a)}function bO(a){return"string"==typeof a&&"#"===(a=hh[a.toLowerCase()]||a)[0]&&(a=a.slice(1)),parseInt(a,16)}bN=function(){for(var c=[],d=[],b=0,e;b<32;b++)c[b]=b,d[b]=b;return c[a.BLEND_MODES.NORMAL_NPM]=a.BLEND_MODES.NORMAL,c[a.BLEND_MODES.ADD_NPM]=a.BLEND_MODES.ADD,c[a.BLEND_MODES.SCREEN_NPM]=a.BLEND_MODES.SCREEN,d[a.BLEND_MODES.NORMAL]=a.BLEND_MODES.NORMAL_NPM,d[a.BLEND_MODES.ADD]=a.BLEND_MODES.ADD_NPM,d[a.BLEND_MODES.SCREEN]=a.BLEND_MODES.SCREEN_NPM,e=[],e.push(d),e.push(c),e}();function bM(a,b){return bN[b?1:0][a]}function fz(b,c,a,d){return a=a||new Float32Array(4),d||void 0===d?(a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c):(a[0]=b[0],a[1]=b[1],a[2]=b[2]),a[3]=c,a}function bg(b,a){if(1===a)return(255*a<<24)+b;if(0===a)return 0;var c=b>>16&255,d=b>>8&255,e=255&b;return(255*a<<24)+((c=c*a+.5|0)<<16)+((d=d*a+.5|0)<<8)+(e*a+.5|0)}function bK(c,b,a,d){return(a=a||new Float32Array(4))[0]=(c>>16&255)/255,a[1]=(c>>8&255)/255,a[2]=(255&c)/255,(d||void 0===d)&&(a[0]*=b,a[1]*=b,a[2]*=b),a[3]=b,a}function fy(e,a){var d,b,c;if(void 0===a&&(a=null),d=6*e,(a=a||new Uint16Array(d)).length!==d)throw new Error("Out buffer length is incorrect, got "+a.length+" and expected "+d);for(b=0,c=0;b<d;b+=6,c+=4)a[b+0]=c+0,a[b+1]=c+1,a[b+2]=c+2,a[b+3]=c+0,a[b+4]=c+2,a[b+5]=c+3;return a}function bj(a){if(4===a.BYTES_PER_ELEMENT)return a instanceof Float32Array?"Float32Array":a instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===a.BYTES_PER_ELEMENT){if(a instanceof Uint16Array)return"Uint16Array"}else if(1===a.BYTES_PER_ELEMENT&&a instanceof Uint8Array)return"Uint8Array";return null}hi={Float32Array,Uint32Array,Int32Array,Uint8Array};function aK(a){return a+=0===a?1:0,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,1+(a|=a>>>16)}function bI(a){return!(a&a-1||!a)}function bH(b){var c=(b>65535?1:0)<<4,a=((b>>>=c)>255?1:0)<<3;return c|=a,c|=a=((b>>>=a)>15?1:0)<<2,(c|=a=((b>>>=a)>3?1:0)<<1)|(b>>>=a)>>1}function _(c,d,a){var b,e=c.length,f;if(!(d>=e||0===a)){f=e-(a=d+a>e?e-d:a);for(b=d;b<f;++b)c[b]=c[b+a];c.length=f}}function O(a){return 0===a?0:a<0?-1:1}hj=0;function I(){return++hj}fs={},bG={},q=Object.create(null),r=Object.create(null),bF=function(){function a(a,c,d){this.canvas=b.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=d||b.RESOLUTION,this.resize(a,c)}return a.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},a.prototype.resize=function(a,b){this.canvas.width=Math.round(a*this.resolution),this.canvas.height=Math.round(b*this.resolution)},a.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(a.prototype,"width",{get:function(){return this.canvas.width},set:function(a){this.canvas.width=Math.round(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.canvas.height},set:function(a){this.canvas.height=Math.round(a)},enumerable:!1,configurable:!0}),a}();function fq(g){var b,d,f,c=g.width,e=g.height,h=g.getContext("2d",{willReadFrequently:!0}),i=h.getImageData(0,0,c,e).data,k=i.length,a={top:null,left:null,right:null,bottom:null},j=null;for(b=0;b<k;b+=4)0!==i[b+3]&&(d=b/4%c,f=~~(b/4/c),null===a.top&&(a.top=f),(null===a.left||d<a.left)&&(a.left=d),(null===a.right||a.right<d)&&(a.right=d+1),(null===a.bottom||a.bottom<f)&&(a.bottom=f));return null!==a.top&&(c=a.right-a.left,e=a.bottom-a.top+1,j=h.getImageData(a.left,a.top,c,e)),{height:e,width:c,data:j}}fp=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function fn(c,a){if(void 0===a&&(a=globalThis.location),0===c.indexOf("data:"))return"";a=a||globalThis.location,by||(by=document.createElement("a")),by.href=c;var b=L.parse(by.href),d=!b.port&&""===a.port||b.port===a.port;return b.hostname===a.hostname&&d&&b.protocol===a.protocol?"":"anonymous"}function ap(d,a){var c=b.RETINA_PREFIX.exec(d);return c?parseFloat(c[1]):void 0!==a?a:1}hm={__proto__:null,BaseTextureCache:r,CanvasRenderTarget:bF,DATA_URI:fp,ProgramCache:bG,TextureCache:q,clearTextureCache:function(){var a;for(a in q)delete q[a];for(a in r)delete r[a]},correctBlendMode:bM,createIndicesForQuads:fy,decomposeDataUri:function(b){var a=fp.exec(b);if(a)return{mediaType:a[1]?a[1].toLowerCase():void 0,subType:a[2]?a[2].toLowerCase():void 0,charset:a[3]?a[3].toLowerCase():void 0,encoding:a[4]?a[4].toLowerCase():void 0,data:a[5]}},deprecation:function(c,a,d){if(void 0===d&&(d=3),!fs[a]){var b=(new Error).stack;void 0===b?console.warn("PixiJS Deprecation Warning: ",a+"\nDeprecated since v"+c):(b=b.split("\n").splice(d).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",a+"\nDeprecated since v"+c),console.warn(b),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",a+"\nDeprecated since v"+c),console.warn(b))),fs[a]=!0}},destroyTextureCache:function(){var a;for(a in q)q[a].destroy();for(a in r)r[a].destroy()},determineCrossOrigin:fn,getBufferType:bj,getResolutionOfUrl:ap,hex2rgb:T,hex2string:bP,interleaveTypedArrays:function(d,l){for(var i=0,h=0,e={},a=0,m,j,k,f,g,c,b;a<d.length;a++)h+=l[a],i+=d[a].length;m=new ArrayBuffer(4*i),j=null,k=0;for(a=0;a<d.length;a++){f=l[a],g=d[a],c=bj(g),e[c]||(e[c]=new hi[c](m)),j=e[c];for(b=0;b<g.length;b++)j[(b/f|0)*h+k+b%f]=g[b];k+=f}return new Float32Array(m)},isPow2:bI,isWebGLSupported:fB,log2:bH,nextPow2:aK,path:fH,premultiplyBlendMode:bN,premultiplyRgba:fz,premultiplyTint:bg,premultiplyTintToRgba:bK,removeItems:_,rgb2hex:function(a){return(255*a[0]<<16)+(255*a[1]<<8)+(255*a[2]|0)},sayHello:fC,sign:O,skipHello:function(){bQ=!0},string2hex:bO,trimCanvas:fq,uid:I,url:L,isMobile:s,EventEmitter:af,earcut:aT},a.SHAPES=void 0,aA=2*Math.PI,fh=180/Math.PI,fe=Math.PI/180,!function(a){a[a.POLY=0]="POLY",a[a.RECT=1]="RECT",a[a.CIRC=2]="CIRC",a[a.ELIP=3]="ELIP",a[a.RREC=4]="RREC"}(a.SHAPES||(a.SHAPES={})),g=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.x=0,this.y=0,this.x=a,this.y=b}return a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.copyFrom=function(a){return this.set(a.x,a.y),this},a.prototype.copyTo=function(a){return a.set(this.x,this.y),a},a.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},a.prototype.set=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=a),this.x=a,this.y=b,this},a}(),bn=[new g,new g,new g,new g],d=function(){function b(b,c,d,e){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),this.x=Number(b),this.y=Number(c),this.width=Number(d),this.height=Number(e),this.type=a.SHAPES.RECT}return Object.defineProperty(b.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(b,"EMPTY",{get:function(){return new b(0,0,0,0)},enumerable:!1,configurable:!0}),b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)},b.prototype.copyFrom=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},b.prototype.copyTo=function(a){return a.x=this.x,a.y=this.y,a.width=this.width,a.height=this.height,a},b.prototype.contains=function(a,b){return!(this.width<=0||this.height<=0)&&a>=this.x&&a<this.x+this.width&&b>=this.y&&b<this.y+this.height},b.prototype.intersects=function(b,f){var y,x,k,j,i,h,a,e,d,c,o,n,g,p,q,r,s,l,m,t,u,v,w;return f?!(k=this.left,j=this.right,i=this.top,h=this.bottom,j<=k||h<=i)&&(!(a=bn[0].set(b.left,b.top),e=bn[1].set(b.left,b.bottom),d=bn[2].set(b.right,b.top),c=bn[3].set(b.right,b.bottom),d.x<=a.x||e.y<=a.y)&&(!(o=Math.sign(f.a*f.d-f.b*f.c),0===o)&&(!(f.apply(a,a),f.apply(e,e),f.apply(d,d),f.apply(c,c),Math.max(a.x,e.x,d.x,c.x)<=k||Math.min(a.x,e.x,d.x,c.x)>=j||Math.max(a.y,e.y,d.y,c.y)<=i||Math.min(a.y,e.y,d.y,c.y)>=h)&&(!(n=o*(e.y-a.y),g=o*(a.x-e.x),p=n*k+g*i,q=n*j+g*i,r=n*k+g*h,s=n*j+g*h,Math.max(p,q,r,s)<=n*a.x+g*a.y||Math.min(p,q,r,s)>=n*c.x+g*c.y)&&(l=o*(a.y-d.y),m=o*(d.x-a.x),t=l*k+m*i,u=l*j+m*i,v=l*k+m*h,w=l*j+m*h,!(Math.max(t,u,v,w)<=l*a.x+m*a.y||Math.min(t,u,v,w)>=l*c.x+m*c.y)))))):!(y=this.x<b.x?b.x:this.x,(this.right>b.right?b.right:this.right)<=y)&&(x=this.y<b.y?b.y:this.y,(this.bottom>b.bottom?b.bottom:this.bottom)>x)},b.prototype.pad=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=a),this.x-=a,this.y-=b,this.width+=2*a,this.height+=2*b,this},b.prototype.fit=function(a){var b=Math.max(this.x,a.x),d=Math.min(this.x+this.width,a.x+a.width),c=Math.max(this.y,a.y),e=Math.min(this.y+this.height,a.y+a.height);return this.x=b,this.width=Math.max(d-b,0),this.y=c,this.height=Math.max(e-c,0),this},b.prototype.ceil=function(a,b){void 0===a&&(a=1),void 0===b&&(b=.001);var c=Math.ceil((this.x+this.width-b)*a)/a,d=Math.ceil((this.y+this.height-b)*a)/a;return this.x=Math.floor((this.x+b)*a)/a,this.y=Math.floor((this.y+b)*a)/a,this.width=c-this.x,this.height=d-this.y,this},b.prototype.enlarge=function(a){var b=Math.min(this.x,a.x),d=Math.max(this.x+this.width,a.x+a.width),c=Math.min(this.y,a.y),e=Math.max(this.y+this.height,a.y+a.height);return this.x=b,this.width=d-b,this.y=c,this.height=e-c,this},b}(),fd=function(){function b(b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=b,this.y=c,this.radius=d,this.type=a.SHAPES.CIRC}return b.prototype.clone=function(){return new b(this.x,this.y,this.radius)},b.prototype.contains=function(c,d){if(this.radius<=0)return!1;var e=this.radius*this.radius,a=this.x-c,b=this.y-d;return(a*=a)+(b*=b)<=e},b.prototype.getBounds=function(){return new d(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},b}(),fa=function(){function b(b,c,d,e){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),this.x=b,this.y=c,this.width=d,this.height=e,this.type=a.SHAPES.ELIP}return b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)},b.prototype.contains=function(c,d){if(this.width<=0||this.height<=0)return!1;var a=(c-this.x)/this.width,b=(d-this.y)/this.height;return(a*=a)+(b*=b)<=1},b.prototype.getBounds=function(){return new d(this.x-this.width,this.y-this.height,this.width,this.height)},b}(),aG=function(){function b(){for(var g=arguments,c=[],d=0,b,f,e,h;d<arguments.length;d++)c[d]=g[d];if(b=Array.isArray(c[0])?c[0]:c,"number"!=typeof b[0]){for(f=[],e=0,h=b.length;e<h;e++)f.push(b[e].x,b[e].y);b=f}this.points=b,this.type=a.SHAPES.POLY,this.closeStroke=!0}return b.prototype.clone=function(){var a=new b(this.points.slice());return a.closeStroke=this.closeStroke,a},b.prototype.contains=function(i,b){for(var c=!1,g=this.points.length/2,a=0,d=g-1,f,e,j,h;a<g;d=a++)f=this.points[2*a],e=this.points[2*a+1],j=this.points[2*d],h=this.points[2*d+1],e>b!=h>b&&i<(b-e)/(h-e)*(j-f)+f&&(c=!c);return c},b}(),e_=function(){function b(b,c,d,e,f){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=20),this.x=b,this.y=c,this.width=d,this.height=e,this.radius=f,this.type=a.SHAPES.RREC}return b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height,this.radius)},b.prototype.contains=function(d,e){var a,b,c,f;if(this.width<=0||this.height<=0)return!1;if(d>=this.x&&d<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(a=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2)),e>=this.y+a&&e<=this.y+this.height-a||d>=this.x+a&&d<=this.x+this.width-a)return!0;if(b=d-(this.x+a),c=e-(this.y+a),f=a*a,b*b+c*c<=f)return!0;if((b=d-(this.x+this.width-a))*b+c*c<=f)return!0;if(b*b+(c=e-(this.y+this.height-a))*c<=f)return!0;if((b=d-(this.x+a))*b+c*c<=f)return!0}return!1},b}(),P=function(){function a(c,d,a,b){void 0===a&&(a=0),void 0===b&&(b=0),this._x=a,this._y=b,this.cb=c,this.scope=d}return a.prototype.clone=function(b,c){return void 0===b&&(b=this.cb),void 0===c&&(c=this.scope),new a(b,c,this._x,this._y)},a.prototype.set=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=a),this._x===a&&this._y===b||(this._x=a,this._y=b,this.cb.call(this.scope)),this},a.prototype.copyFrom=function(a){return this._x===a.x&&this._y===a.y||(this._x=a.x,this._y=a.y,this.cb.call(this.scope)),this},a.prototype.copyTo=function(a){return a.set(this._x,this._y),a},a.prototype.equals=function(a){return a.x===this._x&&a.y===this._y},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x!==a&&(this._x=a,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y!==a&&(this._y=a,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),a}(),m=function(){function a(a,b,c,d,e,f){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),void 0===e&&(e=0),void 0===f&&(f=0),this.array=null,this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f}return a.prototype.fromArray=function(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]},a.prototype.set=function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this},a.prototype.toArray=function(b,c){this.array||(this.array=new Float32Array(9));var a=c||this.array;return b?(a[0]=this.a,a[1]=this.b,a[2]=0,a[3]=this.c,a[4]=this.d,a[5]=0,a[6]=this.tx,a[7]=this.ty,a[8]=1):(a[0]=this.a,a[1]=this.c,a[2]=this.tx,a[3]=this.b,a[4]=this.d,a[5]=this.ty,a[6]=0,a[7]=0,a[8]=1),a},a.prototype.apply=function(b,a){a=a||new g;var c=b.x,d=b.y;return a.x=this.a*c+this.c*d+this.tx,a.y=this.b*c+this.d*d+this.ty,a},a.prototype.applyInverse=function(c,b){b=b||new g;var a=1/(this.a*this.d+this.c*-this.b),d=c.x,e=c.y;return b.x=this.d*a*d+-this.c*a*e+(this.ty*this.c-this.tx*this.d)*a,b.y=this.a*a*e+-this.b*a*d+(-this.ty*this.a+this.tx*this.b)*a,b},a.prototype.translate=function(a,b){return this.tx+=a,this.ty+=b,this},a.prototype.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},a.prototype.rotate=function(c){var a=Math.cos(c),b=Math.sin(c),d=this.a,e=this.c,f=this.tx;return this.a=d*a-this.b*b,this.b=d*b+this.b*a,this.c=e*a-this.d*b,this.d=e*b+this.d*a,this.tx=f*a-this.ty*b,this.ty=f*b+this.ty*a,this},a.prototype.append=function(a){var b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this},a.prototype.setTransform=function(h,i,c,d,e,f,a,b,g){return this.a=Math.cos(a+g)*e,this.b=Math.sin(a+g)*e,this.c=-Math.sin(a-b)*f,this.d=Math.cos(a-b)*f,this.tx=h-(c*this.a+d*this.c),this.ty=i-(c*this.b+d*this.d),this},a.prototype.prepend=function(a){var b=this.tx,c,d;return(1!==a.a||0!==a.b||0!==a.c||1!==a.d)&&(c=this.a,d=this.c,this.a=c*a.a+this.b*a.c,this.b=c*a.b+this.b*a.d,this.c=d*a.a+this.d*a.c,this.d=d*a.b+this.d*a.d),this.tx=b*a.a+this.ty*a.c+a.tx,this.ty=b*a.b+this.ty*a.d+a.ty,this},a.prototype.decompose=function(a){var b=this.a,c=this.b,d=this.c,e=this.d,f=a.pivot,h=-Math.atan2(-d,e),g=Math.atan2(c,b),i=Math.abs(h+g);return i<1e-5||Math.abs(aA-i)<1e-5?(a.rotation=g,a.skew.x=a.skew.y=0):(a.rotation=0,a.skew.x=h,a.skew.y=g),a.scale.x=Math.sqrt(b*b+c*c),a.scale.y=Math.sqrt(d*d+e*e),a.position.x=this.tx+(f.x*b+f.y*d),a.position.y=this.ty+(f.x*c+f.y*e),a},a.prototype.invert=function(){var b=this.a,c=this.b,d=this.c,e=this.d,f=this.tx,a=b*e-c*d;return this.a=e/a,this.b=-c/a,this.c=-d/a,this.d=b/a,this.tx=(d*this.ty-e*f)/a,this.ty=-(b*this.ty-c*f)/a,this},a.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},a.prototype.clone=function(){var b=new a;return b.a=this.a,b.b=this.b,b.c=this.c,b.d=this.d,b.tx=this.tx,b.ty=this.ty,b},a.prototype.copyTo=function(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},a.prototype.copyFrom=function(a){return this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.tx=a.tx,this.ty=a.ty,this},Object.defineProperty(a,"IDENTITY",{get:function(){return new a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"TEMP_MATRIX",{get:function(){return new a},enumerable:!1,configurable:!0}),a}(),M=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],N=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],W=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],R=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],bT=[],eZ=[],aV=Math.sign,!function(){for(var a=0,d,b,f,g,h,i,c,e;a<16;a++){d=[],bT.push(d);for(b=0;b<16;b++)for(f=aV(M[a]*M[b]+W[a]*N[b]),g=aV(N[a]*M[b]+R[a]*N[b]),h=aV(M[a]*W[b]+W[a]*R[b]),i=aV(N[a]*W[b]+R[a]*R[b]),c=0;c<16;c++)if(M[c]===f&&N[c]===g&&W[c]===h&&R[c]===i){d.push(c);break}}for(a=0;a<16;a++)e=new m,e.set(M[a],N[a],W[a],R[a],0,0),eZ.push(e)}(),i={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(a){return M[a]},uY:function(a){return N[a]},vX:function(a){return W[a]},vY:function(a){return R[a]},inv:function(a){return 8&a?15&a:7&-a},add:function(a,b){return bT[a][b]},sub:function(a,b){return bT[a][i.inv(b)]},rotate180:function(a){return 4^a},isVertical:function(a){return 2==(3&a)},byDirection:function(a,b){return 2*Math.abs(a)<=Math.abs(b)?b>=0?i.S:i.N:2*Math.abs(b)<=Math.abs(a)?a>0?i.E:i.W:b>0?a>0?i.SE:i.SW:a>0?i.NE:i.NW},matrixAppendRotationInv:function(d,e,a,b){void 0===a&&(a=0),void 0===b&&(b=0);var c=eZ[i.inv(e)];c.tx=a,c.ty=b,d.append(c)}},bX=function(){function a(){this.worldTransform=new m,this.localTransform=new m,this.position=new P(this.onChange,this,0,0),this.scale=new P(this.onChange,this,1,1),this.pivot=new P(this.onChange,this,0,0),this.skew=new P(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return a.prototype.onChange=function(){this._localID++},a.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},a.prototype.updateLocalTransform=function(){var a=this.localTransform;this._localID!==this._currentLocalID&&(a.a=this._cx*this.scale.x,a.b=this._sx*this.scale.x,a.c=this._cy*this.scale.y,a.d=this._sy*this.scale.y,a.tx=this.position.x-(this.pivot.x*a.a+this.pivot.y*a.c),a.ty=this.position.y-(this.pivot.x*a.b+this.pivot.y*a.d),this._currentLocalID=this._localID,this._parentID=-1)},a.prototype.updateTransform=function(d){var a=this.localTransform,b,c;this._localID!==this._currentLocalID&&(a.a=this._cx*this.scale.x,a.b=this._sx*this.scale.x,a.c=this._cy*this.scale.y,a.d=this._sy*this.scale.y,a.tx=this.position.x-(this.pivot.x*a.a+this.pivot.y*a.c),a.ty=this.position.y-(this.pivot.x*a.b+this.pivot.y*a.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==d._worldID&&(b=d.worldTransform,c=this.worldTransform,c.a=a.a*b.a+a.b*b.c,c.b=a.a*b.b+a.b*b.d,c.c=a.c*b.a+a.d*b.c,c.d=a.c*b.b+a.d*b.d,c.tx=a.tx*b.a+a.ty*b.c+b.tx,c.ty=a.tx*b.b+a.ty*b.d+b.ty,this._parentID=d._worldID,this._worldID++)},a.prototype.setFromMatrix=function(a){a.decompose(this),this._localID++},Object.defineProperty(a.prototype,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation!==a&&(this._rotation=a,this.updateSkew())},enumerable:!1,configurable:!0}),a.IDENTITY=new a,a}(),b.SORTABLE_CHILDREN=!1,aO=function(){function a(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return a.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},a.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},a.prototype.getRectangle=function(a){return this.minX>this.maxX||this.minY>this.maxY?d.EMPTY:((a=a||new d(0,0,1,1)).x=this.minX,a.y=this.minY,a.width=this.maxX-this.minX,a.height=this.maxY-this.minY,a)},a.prototype.addPoint=function(a){this.minX=Math.min(this.minX,a.x),this.maxX=Math.max(this.maxX,a.x),this.minY=Math.min(this.minY,a.y),this.maxY=Math.max(this.maxY,a.y)},a.prototype.addPointMatrix=function(a,b){var i=a.a,j=a.b,e=a.c,f=a.d,g=a.tx,h=a.ty,c=i*b.x+e*b.y+g,d=j*b.x+f*b.y+h;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)},a.prototype.addQuad=function(g){var c=this.minX,d=this.minY,e=this.maxX,f=this.maxY,b=g[0],a=g[1];c=b<c?b:c,d=a<d?a:d,e=b>e?b:e,f=a>f?a:f,c=(b=g[2])<c?b:c,d=(a=g[3])<d?a:d,e=b>e?b:e,f=a>f?a:f,c=(b=g[4])<c?b:c,d=(a=g[5])<d?a:d,e=b>e?b:e,f=a>f?a:f,c=(b=g[6])<c?b:c,d=(a=g[7])<d?a:d,e=b>e?b:e,f=a>f?a:f,this.minX=c,this.minY=d,this.maxX=e,this.maxY=f},a.prototype.addFrame=function(a,b,c,d,e){this.addFrameMatrix(a.worldTransform,b,c,d,e)},a.prototype.addFrameMatrix=function(g,p,o,n,m){var l=g.a,i=g.b,h=g.c,q=g.d,j=g.tx,k=g.ty,f=this.minX,e=this.minY,d=this.maxX,c=this.maxY,b=l*p+h*o+j,a=i*p+q*o+k;f=b<f?b:f,e=a<e?a:e,d=b>d?b:d,c=a>c?a:c,f=(b=l*n+h*o+j)<f?b:f,e=(a=i*n+q*o+k)<e?a:e,d=b>d?b:d,c=a>c?a:c,f=(b=l*p+h*m+j)<f?b:f,e=(a=i*p+q*m+k)<e?a:e,d=b>d?b:d,c=a>c?a:c,f=(b=l*n+h*m+j)<f?b:f,e=(a=i*n+q*m+k)<e?a:e,d=b>d?b:d,c=a>c?a:c,this.minX=f,this.minY=e,this.maxX=d,this.maxY=c},a.prototype.addVertexData=function(h,i,j){for(var d=this.minX,e=this.minY,f=this.maxX,a=this.maxY,b=i,c,g;b<j;b+=2)c=h[b],g=h[b+1],d=c<d?c:d,e=g<e?g:e,f=c>f?c:f,a=g>a?g:a;this.minX=d,this.minY=e,this.maxX=f,this.maxY=a},a.prototype.addVertices=function(a,b,c,d){this.addVerticesMatrix(a.worldTransform,b,c,d)},a.prototype.addVerticesMatrix=function(a,r,u,t,c,g){var q,p,o,n,s,m,h,f,e,d,b,k,j,i,l;void 0===c&&(c=0),void 0===g&&(g=c);for(q=a.a,p=a.b,o=a.c,n=a.d,s=a.tx,m=a.ty,h=this.minX,f=this.minY,e=this.maxX,d=this.maxY,b=u;b<t;b+=2)k=r[b],j=r[b+1],i=q*k+o*j+s,l=n*j+p*k+m,h=Math.min(h,i-c),e=Math.max(e,i+c),f=Math.min(f,l-g),d=Math.max(d,l+g);this.minX=h,this.minY=f,this.maxX=e,this.maxY=d},a.prototype.addBounds=function(a){var b=this.minX,c=this.minY,d=this.maxX,e=this.maxY;this.minX=a.minX<b?a.minX:b,this.minY=a.minY<c?a.minY:c,this.maxX=a.maxX>d?a.maxX:d,this.maxY=a.maxY>e?a.maxY:e},a.prototype.addBoundsMask=function(a,b){var c=a.minX>b.minX?a.minX:b.minX,d=a.minY>b.minY?a.minY:b.minY,e=a.maxX<b.maxX?a.maxX:b.maxX,f=a.maxY<b.maxY?a.maxY:b.maxY,g,h,i,j;c<=e&&d<=f&&(g=this.minX,h=this.minY,i=this.maxX,j=this.maxY,this.minX=c<g?c:g,this.minY=d<h?d:h,this.maxX=e>i?e:i,this.maxY=f>j?f:j)},a.prototype.addBoundsMatrix=function(a,b){this.addFrameMatrix(b,a.minX,a.minY,a.maxX,a.maxY)},a.prototype.addBoundsArea=function(b,a){var c=b.minX>a.x?b.minX:a.x,d=b.minY>a.y?b.minY:a.y,e=b.maxX<a.x+a.width?b.maxX:a.x+a.width,f=b.maxY<a.y+a.height?b.maxY:a.y+a.height,g,h,i,j;c<=e&&d<=f&&(g=this.minX,h=this.minY,i=this.maxX,j=this.maxY,this.minX=c<g?c:g,this.minY=d<h?d:h,this.maxX=e>i?e:i,this.maxY=f>j?f:j)},a.prototype.pad=function(a,b){void 0===a&&(a=0),void 0===b&&(b=a),this.isEmpty()||(this.minX-=a,this.maxX+=a,this.minY-=b,this.maxY+=b)},a.prototype.addFramePad=function(a,b,c,d,e,f){a-=e,b-=f,c+=e,d+=f,this.minX=this.minX<a?this.minX:a,this.maxX=this.maxX>c?this.maxX:c,this.minY=this.minY<b?this.minY:b,this.maxY=this.maxY>d?this.maxY:d},a}(),bZ=function(a,b){return bZ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])},bZ(a,b)};function b_(b,a){function c(){this.constructor=b}bZ(b,a),b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}k=function(b){function a(){var a=b.call(this)||this;return a.tempDisplayObjectParent=null,a.transform=new bX,a.alpha=1,a.visible=!0,a.renderable=!0,a.cullable=!1,a.cullArea=null,a.parent=null,a.worldAlpha=1,a._lastSortedIndex=0,a._zIndex=0,a.filterArea=null,a.filters=null,a._enabledFilters=null,a._bounds=new aO,a._localBounds=null,a._boundsID=0,a._boundsRect=null,a._localBoundsRect=null,a._mask=null,a._maskRefCount=0,a._destroyed=!1,a.isSprite=!1,a.isMask=!1,a}return b_(a,b),a.mixin=function(c){for(var d=Object.keys(c),b=0,e;b<d.length;++b)e=d[b],Object.defineProperty(a.prototype,e,Object.getOwnPropertyDescriptor(c,e))},Object.defineProperty(a.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),a.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},a.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},a.prototype.getBounds=function(b,a){return b||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),a||(this._boundsRect||(this._boundsRect=new d),a=this._boundsRect),this._bounds.getRectangle(a)},a.prototype.getLocalBounds=function(a){var b,c,e,f,g;return a||(this._localBoundsRect||(this._localBoundsRect=new d),a=this._localBoundsRect),this._localBounds||(this._localBounds=new aO),b=this.transform,c=this.parent,this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e=this._bounds,f=this._boundsID,this._bounds=this._localBounds,g=this.getBounds(!1,a),this.parent=c,this.transform=b,this._bounds=e,this._bounds.updateID+=this._boundsID-f,g},a.prototype.toGlobal=function(b,c,a){return void 0===a&&(a=!1),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(b,c)},a.prototype.toLocal=function(a,b,c,d){return b&&(a=b.toGlobal(a,c,d)),d||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(a,c)},a.prototype.setParent=function(a){if(!a||!a.addChild)throw new Error("setParent: Argument must be a Container");return a.addChild(this),a},a.prototype.setTransform=function(a,b,c,d,e,f,g,h,i){return void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=1),void 0===d&&(d=1),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0),void 0===h&&(h=0),void 0===i&&(i=0),this.position.x=a,this.position.y=b,this.scale.x=c||1,this.scale.y=d||1,this.rotation=e,this.skew.x=f,this.skew.y=g,this.pivot.x=h,this.pivot.y=i,this},a.prototype.destroy=function(a){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(a.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new ca),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),a.prototype.enableTempParent=function(){var a=this.parent;return this.parent=this._tempDisplayObjectParent,a},a.prototype.disableTempParent=function(a){this.parent=a},Object.defineProperty(a.prototype,"x",{get:function(){return this.position.x},set:function(a){this.transform.position.x=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.position.y},set:function(a){this.transform.position.y=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){return this.transform.position},set:function(a){this.transform.position.copyFrom(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scale",{get:function(){return this.transform.scale},set:function(a){this.transform.scale.copyFrom(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(a){this.transform.pivot.copyFrom(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"skew",{get:function(){return this.transform.skew},set:function(a){this.transform.skew.copyFrom(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(a){this.transform.rotation=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"angle",{get:function(){return this.transform.rotation*fh},set:function(a){this.transform.rotation=a*fe},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"zIndex",{get:function(){return this._zIndex},set:function(a){this._zIndex=a,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"worldVisible",{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a)return!0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"mask",{get:function(){return this._mask},set:function(b){var a;this._mask!==b&&(this._mask&&(a=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(a._maskRefCount--,0===a._maskRefCount&&(a.renderable=!0,a.isMask=!1)),this._mask=b,this._mask&&(a=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(0===a._maskRefCount&&(a.renderable=!1,a.isMask=!0),a._maskRefCount++))},enumerable:!1,configurable:!0}),a}(af),ca=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.sortDirty=null,b}return b_(b,a),b}(k);function hq(a,b){return a.zIndex===b.zIndex?a._lastSortedIndex-b._lastSortedIndex:a.zIndex-b.zIndex}k.prototype.displayObjectUpdateTransform=k.prototype.updateTransform,u=function(d){function c(){var a=d.call(this)||this;return a.children=[],a.sortableChildren=b.SORTABLE_CHILDREN,a.sortDirty=!1,a}return b_(c,d),c.prototype.onChildrenChange=function(a){},c.prototype.addChild=function(){for(var e=arguments,b=[],c=0,d,a;c<arguments.length;c++)b[c]=e[c];if(b.length>1)for(d=0;d<b.length;d++)this.addChild(b[d]);else a=b[0],a.parent&&a.parent.removeChild(a),a.parent=this,this.sortDirty=!0,a.transform._parentID=-1,this.children.push(a),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",a,this,this.children.length-1),a.emit("added",this);return b[0]},c.prototype.addChildAt=function(a,b){if(b<0||b>this.children.length)throw new Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length);return a.parent&&a.parent.removeChild(a),a.parent=this,this.sortDirty=!0,a.transform._parentID=-1,this.children.splice(b,0,a),this._boundsID++,this.onChildrenChange(b),a.emit("added",this),this.emit("childAdded",a,this,b),a},c.prototype.swapChildren=function(a,b){if(a!==b){var c=this.getChildIndex(a),d=this.getChildIndex(b);this.children[c]=b,this.children[d]=a,this.onChildrenChange(c<d?c:d)}},c.prototype.getChildIndex=function(b){var a=this.children.indexOf(b);if(-1===a)throw new Error("The supplied DisplayObject must be a child of the caller");return a},c.prototype.setChildIndex=function(b,a){if(a<0||a>=this.children.length)throw new Error("The index "+a+" supplied is out of bounds "+this.children.length);var c=this.getChildIndex(b);_(this.children,c,1),this.children.splice(a,0,b),this.onChildrenChange(a)},c.prototype.getChildAt=function(a){if(a<0||a>=this.children.length)throw new Error("getChildAt: Index ("+a+") does not exist.");return this.children[a]},c.prototype.removeChild=function(){for(var f=arguments,a=[],c=0,e,b,d;c<arguments.length;c++)a[c]=f[c];if(a.length>1)for(e=0;e<a.length;e++)this.removeChild(a[e]);else{if(b=a[0],d=this.children.indexOf(b),-1===d)return null;b.parent=null,b.transform._parentID=-1,_(this.children,d,1),this._boundsID++,this.onChildrenChange(d),b.emit("removed",this),this.emit("childRemoved",b,this,d)}return a[0]},c.prototype.removeChildAt=function(b){var a=this.getChildAt(b);return a.parent=null,a.transform._parentID=-1,_(this.children,b,1),this._boundsID++,this.onChildrenChange(b),a.emit("removed",this),this.emit("childRemoved",a,this,b),a},c.prototype.removeChildren=function(d,e){var b,f,c,a;if(void 0===d&&(d=0),void 0===e&&(e=this.children.length),f=d,c=e-f,c>0&&c<=e){b=this.children.splice(f,c);for(a=0;a<b.length;++a)b[a].parent=null,b[a].transform&&(b[a].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(d),a=0;a<b.length;++a)b[a].emit("removed",this),this.emit("childRemoved",b[a],this,a);return b}if(0===c&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},c.prototype.sortChildren=function(){for(var b=!1,a=0,d=this.children.length,c;a<d;++a)c=this.children[a],c._lastSortedIndex=a,b||0===c.zIndex||(b=!0);b&&this.children.length>1&&this.children.sort(hq),this.sortDirty=!1},c.prototype.updateTransform=function(){var a,c,b;this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(a=0,c=this.children.length;a<c;++a)b=this.children[a],b.visible&&b.updateTransform()},c.prototype.calculateBounds=function(){var b,a,c;this._bounds.clear(),this._calculateBounds();for(b=0;b<this.children.length;b++)a=this.children[b],a.visible&&a.renderable&&(a.calculateBounds(),a._mask?(c=a._mask.isMaskData?a._mask.maskObject:a._mask,c?(c.calculateBounds(),this._bounds.addBoundsMask(a._bounds,c._bounds)):this._bounds.addBounds(a._bounds)):a.filterArea?this._bounds.addBoundsArea(a._bounds,a.filterArea):this._bounds.addBounds(a._bounds));this._bounds.updateID=this._boundsID},c.prototype.getLocalBounds=function(g,b){var e,a,f,c;if(void 0===b&&(b=!1),e=d.prototype.getLocalBounds.call(this,g),!b)for(a=0,f=this.children.length;a<f;++a)c=this.children[a],c.visible&&c.updateTransform();return e},c.prototype._calculateBounds=function(){},c.prototype._renderWithCulling=function(f){var d=f.renderTexture.sourceFrame,b,g,e,i,a,h;if(d.width>0&&d.height>0){if(this.cullArea?(b=this.cullArea,g=this.worldTransform):this._render!==c.prototype._render&&(b=this.getBounds(!0)),b&&d.intersects(b,g))this._render(f);else if(this.cullArea)return;for(e=0,i=this.children.length;e<i;++e)a=this.children[e],h=a.cullable,a.cullable=h||!this.cullArea,a.render(f),a.cullable=h}},c.prototype.render=function(a){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(a);else if(this.cullable)this._renderWithCulling(a);else{this._render(a);for(var b=0,c=this.children.length;b<c;++b)this.children[b].render(a)}},c.prototype.renderAdvanced=function(b){var d=this.filters,e=this._mask,c,f,g;if(d){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(c=0;c<d.length;c++)d[c].enabled&&this._enabledFilters.push(d[c])}if(f=d&&this._enabledFilters&&this._enabledFilters.length||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==a.MASK_TYPES.NONE)),f&&b.batch.flush(),d&&this._enabledFilters&&this._enabledFilters.length&&b.filter.push(this,this._enabledFilters),e&&b.mask.push(this,this._mask),this.cullable)this._renderWithCulling(b);else{this._render(b),c=0;for(g=this.children.length;c<g;++c)this.children[c].render(b)}f&&b.batch.flush(),e&&b.mask.pop(this),d&&this._enabledFilters&&this._enabledFilters.length&&b.filter.pop()},c.prototype._render=function(a){},c.prototype.destroy=function(a){var e,c,b;if(d.prototype.destroy.call(this),this.sortDirty=!1,e="boolean"==typeof a?a:a&&a.children,c=this.removeChildren(0,this.children.length),e)for(b=0;b<c.length;++b)c[b].destroy(a)},Object.defineProperty(c.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1,this._width=a},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1,this._height=a},enumerable:!1,configurable:!0}),c}(k),u.prototype.containerUpdateTransform=u.prototype.updateTransform,a.ExtensionType=void 0,aD=function(){return aD=Object.assign||function(d){for(var a,e=arguments,b=1,f=arguments.length,c;b<f;b++)for(c in a=e[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d},aD.apply(this,arguments)},!function(a){a.Application="application",a.RendererPlugin="renderer-webgl-plugin",a.CanvasRendererPlugin="renderer-canvas-plugin",a.Loader="loader",a.LoadParser="load-parser",a.ResolveParser="resolve-parser",a.CacheParser="cache-parser",a.DetectionParser="detection-parser"}(a.ExtensionType||(a.ExtensionType={})),eT=function(a){if("function"==typeof a||"object"==typeof a&&a.extension){var b="object"!=typeof a.extension?{type:a.extension}:a.extension;a=aD(aD({},b),{ref:a})}if("object"!=typeof a)throw new Error("Invalid extension type");return"string"==typeof(a=aD({},a)).type&&(a.type=[a.type]),a},A={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var c=arguments,d=this,b=[],a=0;a<arguments.length;a++)b[a]=c[a];return b.map(eT).forEach(function(a){a.type.forEach(function(e){var c,b;return null===(b=(c=d._removeHandlers)[e])||void 0===b?void 0:b.call(c,a)})}),this},add:function(){for(var d=arguments,b=this,c=[],a=0;a<arguments.length;a++)c[a]=d[a];return c.map(eT).forEach(function(a){a.type.forEach(function(c){var e=b._addHandlers,d=b._queue;e[c]?e[c](a):(d[c]=d[c]||[],d[c].push(a))})}),this},handle:function(a,c,d){var e=this._addHandlers=this._addHandlers||{},f=this._removeHandlers=this._removeHandlers||{},b;return e[a]=c,f[a]=d,b=this._queue,b[a]&&(b[a].forEach(function(a){return c(a)}),delete b[a]),this},handleByMap:function(b,a){return this.handle(b,function(b){a[b.name]=b.ref},function(b){delete a[b.name]})},handleByList:function(c,b){return this.handle(c,function(e){var f,d;b.push(e.ref),c===a.ExtensionType.Loader&&(null===(d=(f=e.ref).add)||void 0===d||d.call(f))},function(c){var a=b.indexOf(c.ref);-1!==a&&b.splice(a,1)})}},p=function(){function a(a){this.items=[],this._name=a,this._aliasCount=0}return a.prototype.emit=function(m,l,k,j,i,g,f,h){var c,e,b,a,d;if(arguments.length>8)throw new Error("max arguments reached");c=this,e=c.name,b=c.items,this._aliasCount++;for(a=0,d=b.length;a<d;a++)b[a][e](m,l,k,j,i,g,f,h);return b===this.items&&this._aliasCount--,this},a.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},a.prototype.add=function(a){return a[this._name]&&(this.ensureNonAliasedItems(),this.remove(a),this.items.push(a)),this},a.prototype.remove=function(b){var a=this.items.indexOf(b);return-1!==a&&(this.ensureNonAliasedItems(),this.items.splice(a,1)),this},a.prototype.contains=function(a){return-1!==this.items.indexOf(a)},a.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},a.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(a.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),a}(),Object.defineProperties(p.prototype,{dispatch:{value:p.prototype.emit},run:{value:p.prototype.emit}}),a.UPDATE_PRIORITY=void 0,b.TARGET_FPMS=.06,function(a){a[a.INTERACTION=50]="INTERACTION",a[a.HIGH=25]="HIGH",a[a.NORMAL=0]="NORMAL",a[a.LOW=-25]="LOW",a[a.UTILITY=-50]="UTILITY"}(a.UPDATE_PRIORITY||(a.UPDATE_PRIORITY={})),ch=function(){function a(d,a,b,c){void 0===a&&(a=null),void 0===b&&(b=0),void 0===c&&(c=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=d,this.context=a,this.priority=b,this.once=c}return a.prototype.match=function(b,a){return void 0===a&&(a=null),this.fn===b&&this.context===a},a.prototype.emit=function(a){this.fn&&(this.context?this.fn.call(this.context,a):this.fn(a));var b=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),b},a.prototype.connect=function(a){this.previous=a,a.next&&(a.next.previous=this),this.next=a.next,a.next=this},a.prototype.destroy=function(a){void 0===a&&(a=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var b=this.next;return this.next=a?null:b,this.previous=null,b},a}(),o=function(){function c(){var a=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ch(null,null,1/0),this.deltaMS=1/b.TARGET_FPMS,this.elapsedMS=1/b.TARGET_FPMS,this._tick=function(b){a._requestId=null,a.started&&(a.update(b),a.started&&null===a._requestId&&a._head.next&&(a._requestId=requestAnimationFrame(a._tick)))}}return c.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},c.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},c.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},c.prototype.add=function(c,d,b){return void 0===b&&(b=a.UPDATE_PRIORITY.NORMAL),this._addListener(new ch(c,d,b))},c.prototype.addOnce=function(c,d,b){return void 0===b&&(b=a.UPDATE_PRIORITY.NORMAL),this._addListener(new ch(c,d,b,!0))},c.prototype._addListener=function(b){var a=this._head.next,c=this._head;if(a){for(;a;){if(b.priority>a.priority){b.connect(c);break}c=a,a=a.next}b.previous||b.connect(c)}else b.connect(c);return this._startIfPossible(),this},c.prototype.remove=function(b,c){for(var a=this._head.next;a;)a=a.match(b,c)?a.destroy():a.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(c.prototype,"count",{get:function(){if(!this._head)return 0;for(var a=0,b=this._head;b=b.next;)a++;return a},enumerable:!1,configurable:!0}),c.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},c.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},c.prototype.destroy=function(){if(!this._protected){this.stop();for(var a=this._head.next;a;)a=a.destroy(!0);this._head.destroy(),this._head=null}},c.prototype.update=function(a){var c,e,f,d;if(void 0===a&&(a=performance.now()),a>this.lastTime){if((c=this.elapsedMS=a-this.lastTime)>this._maxElapsedMS&&(c=this._maxElapsedMS),c*=this.speed,this._minElapsedMS){if(e=a-this._lastFrame|0,e<this._minElapsedMS)return;this._lastFrame=a-e%this._minElapsedMS}this.deltaMS=c,this.deltaTime=this.deltaMS*b.TARGET_FPMS;for(f=this._head,d=f.next;d;)d=d.emit(this.deltaTime);f.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=a},Object.defineProperty(c.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(a){var c=Math.min(this.maxFPS,a),d=Math.min(Math.max(0,c)/1e3,b.TARGET_FPMS);this._maxElapsedMS=1/d},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(a){if(0===a)this._minElapsedMS=0;else{var b=Math.max(this.minFPS,a);this._minElapsedMS=1/(b/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(c,"shared",{get:function(){if(!c._shared){var a=c._shared=new c;a.autoStart=!0,a._protected=!0}return c._shared},enumerable:!1,configurable:!0}),Object.defineProperty(c,"system",{get:function(){if(!c._system){var a=c._system=new c;a.autoStart=!0,a._protected=!0}return c._system},enumerable:!1,configurable:!0}),c}(),eQ=function(){function b(){}return b.init=function(b){var c=this;b=Object.assign({autoStart:!0,sharedTicker:!1},b),Object.defineProperty(this,"ticker",{set:function(b){this._ticker&&this._ticker.remove(this.render,this),this._ticker=b,b&&b.add(this.render,this,a.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){c._ticker.stop()},this.start=function(){c._ticker.start()},this._ticker=null,this.ticker=b.sharedTicker?o.shared:new o,b.autoStart&&this.start()},b.destroy=function(){if(this._ticker){var a=this._ticker;this.ticker=null,a.destroy()}},b.extension=a.ExtensionType.Application,b}(),b.PREFER_ENV=s.any?a.ENV.WEBGL:a.ENV.WEBGL2,b.STRICT_TEXTURE_CACHE=!1,aq=[];function bB(a,f){var d,e,b,c;if(!a)return null;d="","string"==typeof a&&(e=/\.(\w{3,4})(?:$|\?|#)/i.exec(a),e&&(d=e[1].toLowerCase()));for(b=aq.length-1;b>=0;--b)if(c=aq[b],c.test&&c.test(a,d))return new c(a,f);throw new Error("Unrecognized source type to auto-detect Resource")}cm=function(a,b){return cm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])},cm(a,b)};function h(b,a){function c(){this.constructor=b}cm(b,a),b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}co=function(){return co=Object.assign||function(d){for(var a,e=arguments,b=1,f=arguments.length,c;b<f;b++)for(c in a=e[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d},co.apply(this,arguments)},Z=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this._width=a,this._height=b,this.destroyed=!1,this.internal=!1,this.onResize=new p("setRealSize"),this.onUpdate=new p("update"),this.onError=new p("onError")}return a.prototype.bind=function(a){this.onResize.add(a),this.onUpdate.add(a),this.onError.add(a),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},a.prototype.unbind=function(a){this.onResize.remove(a),this.onUpdate.remove(a),this.onError.remove(a)},a.prototype.resize=function(a,b){a===this._width&&b===this._height||(this._width=a,this._height=b,this.onResize.emit(a,b))},Object.defineProperty(a.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),a.prototype.update=function(){this.destroyed||this.onUpdate.emit()},a.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),a.prototype.style=function(a,b,c){return!1},a.prototype.dispose=function(){},a.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},a.test=function(a,b){return!1},a}(),S=function(c){function b(f,g){var a=this,b=g||{},d=b.width,e=b.height;if(!d||!e)throw new Error("BufferResource width or height invalid");return(a=c.call(this,d,e)||this).data=f,a}return h(b,c),b.prototype.upload=function(g,b,c){var d=g.gl,e,f;return d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===a.ALPHA_MODES.UNPACK),e=b.realWidth,f=b.realHeight,c.width===e&&c.height===f?d.texSubImage2D(b.target,0,0,0,e,f,b.format,c.type,this.data):(c.width=e,c.height=f,d.texImage2D(b.target,0,c.internalFormat,e,f,0,b.format,c.type,this.data)),!0},b.prototype.dispose=function(){this.data=null},b.test=function(a){return a instanceof Float32Array||a instanceof Uint8Array||a instanceof Uint32Array},b}(Z),hs={scaleMode:a.SCALE_MODES.NEAREST,format:a.FORMATS.RGBA,alphaMode:a.ALPHA_MODES.NPM},e=function(d){function c(f,e){void 0===f&&(f=null),void 0===e&&(e=null);var c=d.call(this)||this,h=(e=e||{}).alphaMode,i=e.mipmap,j=e.anisotropicLevel,k=e.scaleMode,l=e.width,g=e.height,m=e.wrapMode,n=e.format,o=e.type,p=e.target,q=e.resolution,r=e.resourceOptions;return!f||f instanceof Z||((f=bB(f,r)).internal=!0),c.resolution=q||b.RESOLUTION,c.width=Math.round((l||0)*c.resolution)/c.resolution,c.height=Math.round((g||0)*c.resolution)/c.resolution,c._mipmap=void 0!==i?i:b.MIPMAP_TEXTURES,c.anisotropicLevel=void 0!==j?j:b.ANISOTROPIC_LEVEL,c._wrapMode=m||b.WRAP_MODE,c._scaleMode=void 0!==k?k:b.SCALE_MODE,c.format=n||a.FORMATS.RGBA,c.type=o||a.TYPES.UNSIGNED_BYTE,c.target=p||a.TARGETS.TEXTURE_2D,c.alphaMode=void 0!==h?h:a.ALPHA_MODES.UNPACK,c.uid=I(),c.touched=0,c.isPowerOfTwo=!1,c._refreshPOT(),c._glTextures={},c.dirtyId=0,c.dirtyStyleId=0,c.cacheId=null,c.valid=l>0&&g>0,c.textureCacheIds=[],c.destroyed=!1,c.resource=null,c._batchEnabled=0,c._batchLocation=0,c.parentTextureArray=null,c.setResource(f),c}return h(c,d),Object.defineProperty(c.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"mipmap",{get:function(){return this._mipmap},set:function(a){this._mipmap!==a&&(this._mipmap=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){this._scaleMode!==a&&(this._scaleMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(a){this._wrapMode!==a&&(this._wrapMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),c.prototype.setStyle=function(a,b){var c;return void 0!==a&&a!==this.scaleMode&&(this.scaleMode=a,c=!0),void 0!==b&&b!==this.mipmap&&(this.mipmap=b,c=!0),c&&this.dirtyStyleId++,this},c.prototype.setSize=function(b,c,a){return a=a||this.resolution,this.setRealSize(b*a,c*a,a)},c.prototype.setRealSize=function(a,b,c){return this.resolution=c||this.resolution,this.width=Math.round(a)/this.resolution,this.height=Math.round(b)/this.resolution,this._refreshPOT(),this.update(),this},c.prototype._refreshPOT=function(){this.isPowerOfTwo=bI(this.realWidth)&&bI(this.realHeight)},c.prototype.setResolution=function(a){var b=this.resolution;return b===a||(this.resolution=a,this.valid&&(this.width=Math.round(this.width*b)/a,this.height=Math.round(this.height*b)/a,this.emit("update",this)),this._refreshPOT()),this},c.prototype.setResource=function(a){if(this.resource===a)return this;if(this.resource)throw new Error("Resource can be set only once");return a.bind(this),this.resource=a,this},c.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},c.prototype.onError=function(a){this.emit("error",this,a)},c.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete r[this.cacheId],delete q[this.cacheId],this.cacheId=null),this.dispose(),c.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},c.prototype.dispose=function(){this.emit("dispose",this)},c.prototype.castToBaseTexture=function(){return this},c.from=function(d,f,g){var h,a,i,e;if(void 0===g&&(g=b.STRICT_TEXTURE_CACHE),h="string"==typeof d,a=null,h?a=d:(d._pixiId||(i=f&&f.pixiIdPrefix||"pixiid",d._pixiId=i+"_"+I()),a=d._pixiId),e=r[a],h&&g&&!e)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return e||((e=new c(d,f)).cacheId=a,c.addToCache(e,a)),e},c.fromBuffer=function(b,d,e,f){b=b||new Float32Array(d*e*4);var g=new S(b,{width:d,height:e}),h=b instanceof Float32Array?a.TYPES.FLOAT:a.TYPES.UNSIGNED_BYTE;return new c(g,Object.assign({},hs,f||{width:d,height:e,type:h}))},c.addToCache=function(b,a){a&&(-1===b.textureCacheIds.indexOf(a)&&b.textureCacheIds.push(a),r[a]&&console.warn("BaseTexture added to the cache with an id ["+a+"] that already had an entry"),r[a]=b)},c.removeFromCache=function(a){var b,d,c;if("string"==typeof a){if(b=r[a],b)return d=b.textureCacheIds.indexOf(a),d>-1&&b.textureCacheIds.splice(d,1),delete r[a],b}else if(a&&a.textureCacheIds){for(c=0;c<a.textureCacheIds.length;++c)delete r[a.textureCacheIds[c]];return a.textureCacheIds.length=0,a}return null},c._globalBatch=0,c}(af),bm=function(b){function a(c,g){var a=this,d=g||{},h=d.width,i=d.height,f,j;(a=b.call(this,h,i)||this).items=[],a.itemDirtyIds=[];for(f=0;f<c;f++)j=new e,a.items.push(j),a.itemDirtyIds.push(-2);return a.length=c,a._load=null,a.baseTexture=null,a}return h(a,b),a.prototype.initFromArray=function(b,c){for(var a=0;a<this.length;a++)b[a]&&(b[a].castToBaseTexture?this.addBaseTextureAt(b[a].castToBaseTexture(),a):b[a]instanceof Z?this.addResourceAt(b[a],a):this.addResourceAt(bB(b[a],c),a))},a.prototype.dispose=function(){for(var a=0,b=this.length;a<b;a++)this.items[a].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},a.prototype.addResourceAt=function(a,b){if(!this.items[b])throw new Error("Index "+b+" is out of bounds");return a.valid&&!this.valid&&this.resize(a.width,a.height),this.items[b].setResource(a),this},a.prototype.bind=function(a){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");b.prototype.bind.call(this,a);for(var c=0;c<this.length;c++)this.items[c].parentTextureArray=a,this.items[c].on("update",a.update,a)},a.prototype.unbind=function(c){b.prototype.unbind.call(this,c);for(var a=0;a<this.length;a++)this.items[a].parentTextureArray=null,this.items[a].off("update",c.update,c)},a.prototype.load=function(){var a=this,b;return this._load?this._load:(b=this.items.map(function(a){return a.resource}).filter(function(a){return a}).map(function(a){return a.load()}),this._load=Promise.all(b).then(function(){var b=a.items[0],c=b.realWidth,d=b.realHeight;return a.resize(c,d),Promise.resolve(a)}),this._load)},a}(Z),cu=function(c){function b(a,f){var b,d,e=this,g=f||{},h=g.width,i=g.height;return Array.isArray(a)?(b=a,d=a.length):d=a,e=c.call(this,d,{width:h,height:i})||this,b&&e.initFromArray(b,f),e}return h(b,c),b.prototype.addBaseTextureAt=function(a,b){if(!a.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(a.resource,b),this},b.prototype.bind=function(b){c.prototype.bind.call(this,b),b.target=a.TARGETS.TEXTURE_2D_ARRAY},b.prototype.upload=function(i,h,d){var e=this,f=e.length,g=e.itemDirtyIds,j=e.items,c=i.gl,a,b;d.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,d.internalFormat,this._width,this._height,f,0,h.format,d.type,null);for(a=0;a<f;a++)b=j[a],g[a]<b.dirtyId&&(g[a]=b.dirtyId,b.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,a,b.resource.width,b.resource.height,1,h.format,d.type,b.resource.source));return!0},b}(bm),z=function(c){function b(d){var b=this,a=d,e=a.naturalWidth||a.videoWidth||a.width,f=a.naturalHeight||a.videoHeight||a.height;return(b=c.call(this,e,f)||this).source=d,b.noSubImage=!1,b}return h(b,c),b.crossOrigin=function(b,c,a){void 0===a&&0!==c.indexOf("data:")?b.crossOrigin=fn(c):!1!==a&&(b.crossOrigin="string"==typeof a?a:"anonymous")},b.prototype.upload=function(h,c,d,b){var e=h.gl,g=c.realWidth,f=c.realHeight;if((b=b||this.source)instanceof HTMLImageElement){if(!b.complete||0===b.naturalWidth)return!1}else if(b instanceof HTMLVideoElement&&b.readyState<=1)return!1;return e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.alphaMode===a.ALPHA_MODES.UNPACK),this.noSubImage||c.target!==e.TEXTURE_2D||d.width!==g||d.height!==f?(d.width=g,d.height=f,e.texImage2D(c.target,0,d.internalFormat,c.format,d.type,b)):e.texSubImage2D(e.TEXTURE_2D,0,0,0,c.format,d.type,b),!0},b.prototype.update=function(){if(!this.destroyed){var a=this.source,b=a.naturalWidth||a.videoWidth||a.width,d=a.naturalHeight||a.videoHeight||a.height;this.resize(b,d),c.prototype.update.call(this)}},b.prototype.dispose=function(){this.source=null},b}(Z),cw=function(b){function a(a){return b.call(this,a)||this}return h(a,b),a.test=function(a){var b=globalThis.OffscreenCanvas;return!!(b&&a instanceof b)||globalThis.HTMLCanvasElement&&a instanceof HTMLCanvasElement},a}(z),cx=function(c){function b(e,h){var d=this,f=h||{},i=f.width,j=f.height,k=f.autoLoad,l=f.linkBaseTexture,g;if(e&&e.length!==b.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");d=c.call(this,6,{width:i,height:j})||this;for(g=0;g<b.SIDES;g++)d.items[g].target=a.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+g;return d.linkBaseTexture=!1!==l,e&&d.initFromArray(e,h),!1!==k&&d.load(),d}return h(b,c),b.prototype.bind=function(b){c.prototype.bind.call(this,b),b.target=a.TARGETS.TEXTURE_CUBE_MAP},b.prototype.addBaseTextureAt=function(b,c,d){if(!this.items[c])throw new Error("Index "+c+" is out of bounds");if(!this.linkBaseTexture||b.parentTextureArray||Object.keys(b._glTextures).length>0){if(!b.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(b.resource,c)}else b.target=a.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+c,b.parentTextureArray=this.baseTexture,this.items[c]=b;return b.valid&&!this.valid&&this.resize(b.realWidth,b.realHeight),this.items[c]=b,this},b.prototype.upload=function(g,d,e){for(var f=this.itemDirtyIds,a=0,c;a<b.SIDES;a++)c=this.items[a],(f[a]<c.dirtyId||e.dirtyId<d.dirtyId)&&(c.valid&&c.resource?(c.resource.upload(g,c,e),f[a]=c.dirtyId):f[a]<-1&&(g.gl.texImage2D(c.target,0,e.internalFormat,d.realWidth,d.realHeight,0,d.format,e.type,null),f[a]=-1));return!0},b.test=function(a){return Array.isArray(a)&&a.length===b.SIDES},b.SIDES=6,b}(bm),bc=function(d){function c(e,c){var a=this,f;return c=c||{},!(e instanceof HTMLImageElement)&&(f=new Image,z.crossOrigin(f,e,c.crossorigin),f.src=e,e=f),a=d.call(this,e)||this,!e.complete&&a._width&&a._height&&(a._width=0,a._height=0),a.url=e.src,a._process=null,a.preserveBitmap=!1,a.createBitmap=(void 0!==c.createBitmap?c.createBitmap:b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,a.alphaMode="number"==typeof c.alphaMode?c.alphaMode:null,a.bitmap=null,a._load=null,!1!==c.autoLoad&&a.load(),a}return h(c,d),c.prototype.load=function(b){var a=this;return this._load||(void 0!==b&&(this.createBitmap=b),this._load=new Promise(function(c,e){var b=a.source,d;a.url=b.src,d=function(){a.destroyed||(b.onload=null,b.onerror=null,a.resize(b.width,b.height),a._load=null,a.createBitmap?c(a.process()):c(a))},b.complete&&b.src?d():(b.onload=d,b.onerror=function(b){e(b),a.onError.emit(b)})})),this._load},c.prototype.process=function(){var b=this,c=this.source,d,e;return null!==this._process?this._process:null!==this.bitmap||!globalThis.createImageBitmap?Promise.resolve(this):(d=globalThis.createImageBitmap,e=!c.crossOrigin||"anonymous"===c.crossOrigin,this._process=fetch(c.src,{mode:e?"cors":"no-cors"}).then(function(a){return a.blob()}).then(function(e){return d(e,0,0,c.width,c.height,{premultiplyAlpha:null===b.alphaMode||b.alphaMode===a.ALPHA_MODES.UNPACK?"premultiply":"none"})}).then(function(a){return b.destroyed?Promise.reject():(b.bitmap=a,b.update(),b._process=null,Promise.resolve(b))}),this._process)},c.prototype.upload=function(h,a,c){var e,f,g,b;if("number"==typeof this.alphaMode&&(a.alphaMode=this.alphaMode),!this.createBitmap)return d.prototype.upload.call(this,h,a,c);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(d.prototype.upload.call(this,h,a,c,this.bitmap),!this.preserveBitmap){e=!0,f=a._glTextures;for(g in f)if(b=f[g],b!==c&&b.dirtyId!==a.dirtyId){e=!1;break}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},c.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,d.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},c.test=function(a){return"string"==typeof a||a instanceof HTMLImageElement},c}(z),cz=function(c){function a(e,d){var a=this;return d=d||{},(a=c.call(this,b.ADAPTER.createCanvas())||this)._width=0,a._height=0,a.svg=e,a.scale=d.scale||1,a._overrideWidth=d.width,a._overrideHeight=d.height,a._resolve=null,a._crossorigin=d.crossorigin,a._load=null,!1!==d.autoLoad&&a.load(),a}return h(a,c),a.prototype.load=function(){var b=this;return this._load||(this._load=new Promise(function(c){if(b._resolve=function(){b.resize(b.source.width,b.source.height),c(b)},a.SVG_XML.test(b.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");b.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(b.svg)))}b._loadSvg()})),this._load},a.prototype._loadSvg=function(){var a=this,b=new Image;z.crossOrigin(b,this.svg,this._crossorigin),b.src=this.svg,b.onerror=function(c){a._resolve&&(b.onerror=null,a.onError.emit(c))},b.onload=function(){var c,d,e,f,g;if(a._resolve){if(c=b.width,d=b.height,!c||!d)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");e=c*a.scale,f=d*a.scale,(a._overrideWidth||a._overrideHeight)&&(e=a._overrideWidth||a._overrideHeight/d*c,f=a._overrideHeight||a._overrideWidth/c*d),e=Math.round(e),f=Math.round(f),g=a.source,g.width=e,g.height=f,g._pixiId="canvas_"+I(),g.getContext("2d").drawImage(b,0,0,c,d,0,0,e,f),a._resolve(),a._resolve=null}}},a.getSize=function(d){var b=a.SVG_SIZE.exec(d),c={};return b&&(c[b[1]]=Math.round(parseFloat(b[3])),c[b[5]]=Math.round(parseFloat(b[7]))),c},a.prototype.dispose=function(){c.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},a.test=function(b,c){return"svg"===c||"string"==typeof b&&b.startsWith("data:image/svg+xml")||"string"==typeof b&&a.SVG_XML.test(b)},a.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,a.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,a}(z),cA=function(b){function a(d,e){var c=this,f,n,g,h,l,i,j,k,m;if(e=e||{},!(d instanceof HTMLVideoElement)){f=document.createElement("video"),f.setAttribute("preload","auto"),f.setAttribute("webkit-playsinline",""),f.setAttribute("playsinline",""),"string"==typeof d&&(d=[d]),n=d[0].src||d[0],z.crossOrigin(f,n,e.crossorigin);for(g=0;g<d.length;++g)h=document.createElement("source"),l=d[g],i=l.src,j=l.mime,k=(i=i||d[g]).split("?").shift().toLowerCase(),m=k.slice(k.lastIndexOf(".")+1),j=j||a.MIME_TYPES[m]||"video/"+m,h.src=i,h.type=j,f.appendChild(h);d=f}return(c=b.call(this,d)||this).noSubImage=!0,c._autoUpdate=!0,c._isConnectedToTicker=!1,c._updateFPS=e.updateFPS||0,c._msToNextUpdate=0,c.autoPlay=!1!==e.autoPlay,c._load=null,c._resolve=null,c._onCanPlay=c._onCanPlay.bind(c),c._onError=c._onError.bind(c),!1!==e.autoLoad&&c.load(),c}return h(a,b),a.prototype.update=function(c){if(!this.destroyed){var a=o.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-a),(!this._updateFPS||this._msToNextUpdate<=0)&&(b.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},a.prototype.load=function(){var b=this,a;return this._load?this._load:(a=this.source,(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),a.addEventListener("play",this._onPlayStart.bind(this)),a.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlay),a.addEventListener("error",this._onError,!0)),this._load=new Promise(function(c){b.valid?c(b):(b._resolve=c,a.load())}),this._load)},a.prototype._onError=function(a){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(a)},a.prototype._isSourcePlaying=function(){var a=this.source;return!a.paused&&!a.ended&&this._isSourceReady()},a.prototype._isSourceReady=function(){return this.source.readyState>2},a.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(o.shared.add(this.update,this),this._isConnectedToTicker=!0)},a.prototype._onPlayStop=function(){this._isConnectedToTicker&&(o.shared.remove(this.update,this),this._isConnectedToTicker=!1)},a.prototype._onCanPlay=function(){var a=this.source,b;a.removeEventListener("canplay",this._onCanPlay),a.removeEventListener("canplaythrough",this._onCanPlay),b=this.valid,this.resize(a.videoWidth,a.videoHeight),!b&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&a.play()},a.prototype.dispose=function(){this._isConnectedToTicker&&(o.shared.remove(this.update,this),this._isConnectedToTicker=!1);var a=this.source;a&&(a.removeEventListener("error",this._onError,!0),a.pause(),a.src="",a.load()),b.prototype.dispose.call(this)},Object.defineProperty(a.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(a){a!==this._autoUpdate&&(this._autoUpdate=a,!this._autoUpdate&&this._isConnectedToTicker?(o.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(o.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(a){a!==this._updateFPS&&(this._updateFPS=a)},enumerable:!1,configurable:!0}),a.test=function(b,c){return globalThis.HTMLVideoElement&&b instanceof HTMLVideoElement||a.TYPES.indexOf(c)>-1},a.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],a.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},a}(z),cB=function(b){function a(a){return b.call(this,a)||this}return h(a,b),a.test=function(a){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap},a}(z),aq.push(bc,cB,cw,cA,cz,S,cx,cu),eN={__proto__:null,Resource:Z,BaseImageResource:z,INSTALLED:aq,autoDetectResource:bB,AbstractMultiResource:bm,ArrayResource:cu,BufferResource:S,CanvasResource:cw,CubeResource:cx,ImageResource:bc,SVGResource:cz,VideoResource:cA,ImageBitmapResource:cB},hw=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return h(c,b),c.prototype.upload=function(g,b,c){var d=g.gl,e,f;return d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===a.ALPHA_MODES.UNPACK),e=b.realWidth,f=b.realHeight,c.width===e&&c.height===f?d.texSubImage2D(b.target,0,0,0,e,f,b.format,c.type,this.data):(c.width=e,c.height=f,d.texImage2D(b.target,0,c.internalFormat,e,f,0,b.format,c.type,this.data)),!0},c}(S),a_=function(){function b(b,c){this.width=Math.round(b||100),this.height=Math.round(c||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new p("disposeFramebuffer"),this.multisample=a.MSAA_QUALITY.NONE}return Object.defineProperty(b.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),b.prototype.addColorTexture=function(b,c){return void 0===b&&(b=0),this.colorTextures[b]=c||new e(null,{scaleMode:a.SCALE_MODES.NEAREST,resolution:1,mipmap:a.MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},b.prototype.addDepthTexture=function(b){return this.depthTexture=b||new e(new hw(null,{width:this.width,height:this.height}),{scaleMode:a.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:a.MIPMAP_MODES.OFF,format:a.FORMATS.DEPTH_COMPONENT,type:a.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},b.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},b.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},b.prototype.resize=function(a,b){var d,e,c;if(a=Math.round(a),b=Math.round(b),a!==this.width||b!==this.height){this.width=a,this.height=b,this.dirtyId++,this.dirtySize++;for(d=0;d<this.colorTextures.length;d++)e=this.colorTextures[d],c=e.resolution,e.setSize(a/c,b/c);this.depthTexture&&(c=this.depthTexture.resolution,this.depthTexture.setSize(a/c,b/c))}},b.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},b.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},b}(),cF=function(c){function b(b){var d,e,f,g,h;return void 0===b&&(b={}),d=this,"number"==typeof b&&(e=arguments[0],f=arguments[1],g=arguments[2],h=arguments[3],b={width:e,height:f,scaleMode:g,resolution:h}),b.width=b.width||100,b.height=b.height||100,b.multisample=void 0!==b.multisample?b.multisample:a.MSAA_QUALITY.NONE,(d=c.call(this,null,b)||this).mipmap=a.MIPMAP_MODES.OFF,d.valid=!0,d.clearColor=[0,0,0,0],d.framebuffer=new a_(d.realWidth,d.realHeight).addColorTexture(0,d),d.framebuffer.multisample=b.multisample,d.maskStack=[],d.filterStack=[{}],d}return h(b,c),b.prototype.resize=function(a,b){this.framebuffer.resize(a*this.resolution,b*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},b.prototype.dispose=function(){this.framebuffer.dispose(),c.prototype.dispose.call(this)},b.prototype.destroy=function(){c.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},b}(e),cG=function(){function a(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return a.prototype.set=function(b,j,a){var c=j.width,d=j.height,e,f,g,h;a?(e=b.width/2/c,f=b.height/2/d,g=b.x/c+e,h=b.y/d+f,a=i.add(a,i.NW),this.x0=g+e*i.uX(a),this.y0=h+f*i.uY(a),a=i.add(a,2),this.x1=g+e*i.uX(a),this.y1=h+f*i.uY(a),a=i.add(a,2),this.x2=g+e*i.uX(a),this.y2=h+f*i.uY(a),a=i.add(a,2),this.x3=g+e*i.uX(a),this.y3=h+f*i.uY(a)):(this.x0=b.x/c,this.y0=b.y/d,this.x1=(b.x+b.width)/c,this.y1=b.y/d,this.x2=(b.x+b.width)/c,this.y2=(b.y+b.height)/d,this.x3=b.x/c,this.y3=(b.y+b.height)/d),this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},a}(),eF=new cG;function aP(a){a.destroy=function(){},a.on=function(){},a.once=function(){},a.emit=function(){}}c=function(c){function a(e,f,j,k,i,h){var b=c.call(this)||this;if(b.noFrame=!1,f||(b.noFrame=!0,f=new d(0,0,1,1)),e instanceof a&&(e=e.baseTexture),b.baseTexture=e,b._frame=f,b.trim=k,b.valid=!1,b._uvs=eF,b.uvMatrix=null,b.orig=j||f,b._rotate=Number(i||0),!0===i)b._rotate=2;else if(b._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return b.defaultAnchor=h?new g(h.x,h.y):new g(0,0),b._updateID=0,b.textureCacheIds=[],e.valid?b.noFrame?e.valid&&b.onBaseTextureUpdated(e):b.frame=f:e.once("loaded",b.onBaseTextureUpdated,b),b.noFrame&&e.on("update",b.onBaseTextureUpdated,b),b}return h(a,c),a.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(a){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=a.width,this._frame.height=a.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(c){if(this.baseTexture){if(c){var b=this.baseTexture.resource;b&&b.url&&q[b.url]&&a.removeFromCache(b.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){var b=this._frame.clone(),d=this._frame===this.orig?b:this.orig.clone(),c=new a(this.baseTexture,!this.noFrame&&b,d,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(c._frame=b),c},a.prototype.updateUvs=function(){this._uvs===eF&&(this._uvs=new cG),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(c,g,i){var j,d,h,f;if(void 0===g&&(g={}),void 0===i&&(i=b.STRICT_TEXTURE_CACHE),j="string"==typeof c,d=null,j?d=c:c instanceof e?(c.cacheId||(h=g&&g.pixiIdPrefix||"pixiid",c.cacheId=h+"-"+I(),e.addToCache(c,c.cacheId)),d=c.cacheId):(c._pixiId||(h=g&&g.pixiIdPrefix||"pixiid",c._pixiId=h+"_"+I()),d=c._pixiId),f=q[d],j&&i&&!f)throw new Error('The cacheId "'+d+'" does not exist in TextureCache.');return f||c instanceof e?!f&&c instanceof e&&(f=new a(c),a.addToCache(f,d)):(g.resolution||(g.resolution=ap(c)),(f=new a(new e(c,g))).baseTexture.cacheId=d,e.addToCache(f.baseTexture,d),a.addToCache(f,d)),f},a.fromURL=function(d,c){var e=Object.assign({autoLoad:!1},null==c?void 0:c.resourceOptions),b=a.from(d,Object.assign({resourceOptions:e},c),!1),f=b.baseTexture.resource;return b.baseTexture.valid?Promise.resolve(b):f.load().then(function(){return Promise.resolve(b)})},a.fromBuffer=function(b,c,d,f){return new a(e.fromBuffer(b,c,d,f))},a.fromLoader=function(j,d,f,i){var g=new e(j,Object.assign({scaleMode:b.SCALE_MODE,resolution:ap(d)},i)),h=g.resource,c;return h instanceof bc&&(h.url=d),c=new a(g),f||(f=d),e.addToCache(c.baseTexture,f),a.addToCache(c,f),f!==d&&(e.addToCache(c.baseTexture,d),a.addToCache(c,d)),c.baseTexture.valid?Promise.resolve(c):new Promise(function(a){c.baseTexture.once("loaded",function(){return a(c)})})},a.addToCache=function(b,a){a&&(-1===b.textureCacheIds.indexOf(a)&&b.textureCacheIds.push(a),q[a]&&console.warn("Texture added to the cache with an id ["+a+"] that already had an entry"),q[a]=b)},a.removeFromCache=function(a){var b,d,c;if("string"==typeof a){if(b=q[a],b)return d=b.textureCacheIds.indexOf(a),d>-1&&b.textureCacheIds.splice(d,1),delete q[a],b}else if(a&&a.textureCacheIds){for(c=0;c<a.textureCacheIds.length;++c)q[a.textureCacheIds[c]]===a&&delete q[a.textureCacheIds[c]];return a.textureCacheIds.length=0,a}return null},Object.defineProperty(a.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"frame",{get:function(){return this._frame},set:function(a){var d,e,b,c,f,g,h,i,j;if(this._frame=a,this.noFrame=!1,d=a.x,e=a.y,b=a.width,c=a.height,f=d+b>this.baseTexture.width,g=e+c>this.baseTexture.height,f||g)throw h=f&&g?"and":"or",i="X: "+d+" + "+b+" = "+(d+b)+" > "+this.baseTexture.width,j="Y: "+e+" + "+c+" = "+(e+c)+" > "+this.baseTexture.height,new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+i+" "+h+" "+j);this.valid=b&&c&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=a),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rotate",{get:function(){return this._rotate},set:function(a){this._rotate=a,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),a.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(a,"EMPTY",{get:function(){return a._EMPTY||(a._EMPTY=new a(new e),aP(a._EMPTY),aP(a._EMPTY.baseTexture)),a._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(a,"WHITE",{get:function(){if(!a._WHITE){var c=b.ADAPTER.createCanvas(16,16),d=c.getContext("2d");c.width=16,c.height=16,d.fillStyle="white",d.fillRect(0,0,16,16),a._WHITE=new a(e.from(c)),aP(a._WHITE),aP(a._WHITE.baseTexture)}return a._WHITE},enumerable:!1,configurable:!0}),a}(af),G=function(b){function a(c,d){var a=b.call(this,c,d)||this;return a.valid=!0,a.filterFrame=null,a.filterPoolKey=null,a.updateUvs(),a}return h(a,b),Object.defineProperty(a.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(a){this.framebuffer.multisample=a},enumerable:!1,configurable:!0}),a.prototype.resize=function(e,f,b){void 0===b&&(b=!0);var a=this.baseTexture.resolution,c=Math.round(e*a)/a,d=Math.round(f*a)/a;this.valid=c>0&&d>0,this._frame.width=this.orig.width=c,this._frame.height=this.orig.height=d,b&&this.baseTexture.resize(c,d),this.updateUvs()},a.prototype.setResolution=function(b){var a=this.baseTexture;a.resolution!==b&&(a.setResolution(b),this.resize(a.width,a.height,!1))},a.create=function(b){for(var e=arguments,c=[],d=1;d<arguments.length;d++)c[d-1]=e[d];return"number"==typeof b&&(b={width:b,height:c[0],scaleMode:c[1],resolution:c[2]}),new a(new cF(b))},a}(c),eB=function(){function b(a){this.texturePool={},this.textureOptions=a||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return b.prototype.createTexture=function(c,d,b){void 0===b&&(b=a.MSAA_QUALITY.NONE);var e=new cF(Object.assign({width:c,height:d,resolution:1,multisample:b},this.textureOptions));return new G(e)},b.prototype.getOptimalTexture=function(d,e,f,b){var c,g;return void 0===f&&(f=1),void 0===b&&(b=a.MSAA_QUALITY.NONE),d=Math.ceil(d*f-1e-6),e=Math.ceil(e*f-1e-6),this.enableFullScreen&&d===this._pixelsWidth&&e===this._pixelsHeight?c=b>1?-b:-1:(c=((65535&(d=aK(d)))<<16|65535&(e=aK(e)))>>>0,b>1&&(c+=4294967296*b)),this.texturePool[c]||(this.texturePool[c]=[]),g=this.texturePool[c].pop(),g||(g=this.createTexture(d,e,b)),g.filterPoolKey=c,g.setResolution(f),g},b.prototype.getFilterTexture=function(b,d,e){var c=this.getOptimalTexture(b.width,b.height,d||b.resolution,e||a.MSAA_QUALITY.NONE);return c.filterFrame=b.filterFrame,c},b.prototype.returnTexture=function(a){var b=a.filterPoolKey;a.filterFrame=null,this.texturePool[b].push(a)},b.prototype.returnFilterTexture=function(a){this.returnTexture(a)},b.prototype.clear=function(c){var d,a,b;if(c=!1!==c)for(d in this.texturePool)if(a=this.texturePool[d],a)for(b=0;b<a.length;b++)a[b].destroy(!0);this.texturePool={}},b.prototype.setScreenSize=function(a){var b,c,d;if(a.width!==this._pixelsWidth||a.height!==this._pixelsHeight){for(b in this.enableFullScreen=a.width>0&&a.height>0,this.texturePool)if(Number(b)<0){if(c=this.texturePool[b],c)for(d=0;d<c.length;d++)c[d].destroy(!0);this.texturePool[b]=[]}this._pixelsWidth=a.width,this._pixelsHeight=a.height}},b.SCREEN_KEY=-1,b}(),cM=function(){function b(e,b,c,d,f,g,h){void 0===b&&(b=0),void 0===c&&(c=!1),void 0===d&&(d=a.TYPES.FLOAT),this.buffer=e,this.size=b,this.normalized=c,this.type=d,this.stride=f,this.start=g,this.instance=h}return b.prototype.destroy=function(){this.buffer=null},b.from=function(a,c,d,e,f){return new b(a,c,d,e,f)},b}(),hz=0,n=function(){function b(c,a,b){void 0===a&&(a=!0),void 0===b&&(b=!1),this.data=c||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=b,this.static=a,this.id=hz++,this.disposeRunner=new p("disposeBuffer")}return b.prototype.update=function(a){a instanceof Array&&(a=new Float32Array(a)),this.data=a||this.data,this._updateID++},b.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},b.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(b.prototype,"index",{get:function(){return this.type===a.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER},set:function(b){this.type=b?a.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:a.BUFFER_TYPE.ARRAY_BUFFER},enumerable:!1,configurable:!0}),b.from=function(a){return a instanceof Array&&(a=new Float32Array(a)),new b(a)},b}(),hA={Float32Array,Uint32Array,Int32Array,Uint8Array},ew={5126:4,5123:2,5121:1},hD=0,hE={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},an=function(){function b(a,b){void 0===a&&(a=[]),void 0===b&&(b={}),this.buffers=a,this.indexBuffer=null,this.attributes=b,this.glVertexArrayObjects={},this.id=hD++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new p("disposeGeometry"),this.refCount=0}return b.prototype.addAttribute=function(h,a,b,c,i,j,k,e){var f,g,d;if(void 0===b&&(b=0),void 0===c&&(c=!1),void 0===e&&(e=!1),!a)throw new Error("You must pass a buffer when creating an attribute");if(a instanceof n||(a instanceof Array&&(a=new Float32Array(a)),a=new n(a)),f=h.split("|"),f.length>1){for(g=0;g<f.length;g++)this.addAttribute(f[g],a,b,c,i);return this}return d=this.buffers.indexOf(a),-1===d&&(this.buffers.push(a),d=this.buffers.length-1),this.attributes[h]=new cM(d,b,c,i,j,k,e),this.instanced=this.instanced||e,this},b.prototype.getAttribute=function(a){return this.attributes[a]},b.prototype.getBuffer=function(a){return this.buffers[this.getAttribute(a).buffer]},b.prototype.addIndex=function(b){return b instanceof n||(b instanceof Array&&(b=new Uint16Array(b)),b=new n(b)),b.type=a.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=b,-1===this.buffers.indexOf(b)&&this.buffers.push(b),this},b.prototype.getIndex=function(){return this.indexBuffer},b.prototype.interleave=function(){var a,c,d,e,b,f;if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;c=[],d=[],e=new n;for(a in this.attributes)b=this.attributes[a],f=this.buffers[b.buffer],c.push(f.data),d.push(b.size*ew[b.type]/4),b.buffer=0;for(e.data=function(d,l){for(var i=0,h=0,e={},a=0,m,j,k,f,g,c,b;a<d.length;a++)h+=l[a],i+=d[a].length;m=new ArrayBuffer(4*i),j=null,k=0;for(a=0;a<d.length;a++){f=l[a],g=d[a],c=bj(g),e[c]||(e[c]=new hA[c](m)),j=e[c];for(b=0;b<g.length;b++)j[(b/f|0)*h+k+b%f]=g[b];k+=f}return new Float32Array(m)}(c,d),a=0;a<this.buffers.length;a++)this.buffers[a]!==this.indexBuffer&&this.buffers[a].destroy();return this.buffers=[e],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},b.prototype.getSize=function(){var b,a;for(b in this.attributes)return a=this.attributes[b],this.buffers[a.buffer].data.length/(a.stride/4||a.size);return 0},b.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},b.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},b.prototype.clone=function(){for(var e=new b,c=0,d;c<this.buffers.length;c++)e.buffers[c]=new n(this.buffers[c].data.slice(0));for(c in this.attributes)d=this.attributes[c],e.attributes[c]=new cM(d.buffer,d.size,d.normalized,d.type,d.stride,d.start,d.instance);return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=a.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),e},b.merge=function(g){for(var e,f=new b,j=[],h=[],i=[],c=0,d,m,o,p,k,l,q;c<g.length;c++){e=g[c];for(d=0;d<e.buffers.length;d++)h[d]=h[d]||0,h[d]+=e.buffers[d].data.length,i[d]=0}for(c=0;c<e.buffers.length;c++)j[c]=new hE[bj(e.buffers[c].data)](h[c]),f.buffers[c]=new n(j[c]);for(c=0;c<g.length;c++)for(e=g[c],d=0;d<e.buffers.length;d++)j[d].set(e.buffers[d].data,i[d]),i[d]+=e.buffers[d].data.length;if(f.attributes=e.attributes,e.indexBuffer){f.indexBuffer=f.buffers[e.buffers.indexOf(e.indexBuffer)],f.indexBuffer.type=a.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,m=0,o=0,p=0,k=0;for(c=0;c<e.buffers.length;c++)if(e.buffers[c]!==e.indexBuffer){k=c;break}for(c in e.attributes)l=e.attributes[c],(0|l.buffer)===k&&(o+=l.size*ew[l.type]/4);for(c=0;c<g.length;c++){q=g[c].indexBuffer.data;for(d=0;d<q.length;d++)f.indexBuffer.data[d+p]+=m;m+=g[c].buffers[k].data.length/o,p+=q.length}}return f},b}(),en=function(a){function b(){var b=a.call(this)||this;return b.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),b}return h(b,a),b}(an),cV=function(b){function a(){var a=b.call(this)||this;return a.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),a.uvs=new Float32Array([0,0,1,0,1,1,0,1]),a.vertexBuffer=new n(a.vertices),a.uvBuffer=new n(a.uvs),a.addAttribute("aVertexPosition",a.vertexBuffer).addAttribute("aTextureCoord",a.uvBuffer).addIndex([0,1,2,0,2,3]),a}return h(a,b),a.prototype.map=function(d,a){var b=0,c=0;return this.uvs[0]=b,this.uvs[1]=c,this.uvs[2]=b+a.width/d.width,this.uvs[3]=c,this.uvs[4]=b+a.width/d.width,this.uvs[5]=c+a.height/d.height,this.uvs[6]=b,this.uvs[7]=c+a.height/d.height,b=a.x,c=a.y,this.vertices[0]=b,this.vertices[1]=c,this.vertices[2]=b+a.width,this.vertices[3]=c,this.vertices[4]=b+a.width,this.vertices[5]=c+a.height,this.vertices[6]=b,this.vertices[7]=c+a.height,this.invalidate(),this},a.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},a}(an),hO=0,J=function(){function b(b,c,d){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=hO++,this.static=!!c,this.ubo=!!d,b instanceof n?(this.buffer=b,this.buffer.type=a.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=b,this.ubo&&(this.buffer=new n(new Float32Array(1)),this.buffer.type=a.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}return b.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},b.prototype.add=function(a,c,d){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[a]=new b(c,d)},b.from=function(a,c,d){return new b(a,c,d)},b.uboFrom=function(c,a){return new b(c,null==a||a,!0)},b}(),ek=function(){function b(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=a.MSAA_QUALITY.NONE,this.sourceFrame=new d,this.destinationFrame=new d,this.bindingSourceFrame=new d,this.bindingDestinationFrame=new d,this.filters=[],this.transform=null}return b.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},b}(),bi=[new g,new g,new g,new g],dD=new m,c$=function(){function b(a){this.renderer=a,this.defaultFilterStack=[{}],this.texturePool=new eB,this.texturePool.setScreenSize(a.view),this.statePool=[],this.quad=new en,this.quadUv=new cV,this.tempRect=new d,this.activeState={},this.globalUniforms=new J({outputFrame:new d,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return b.prototype.push=function(p,c){for(var o,k,d=this.renderer,q=this.defaultFilterStack,a=this.statePool.pop()||new ek,b=this.renderer.renderTexture,i=c[0].resolution,h=c[0].multisample,g=c[0].padding,l=c[0].autoFit,m=null===(o=c[0].legacy)||void 0===o||o,n=1,e,j,f;n<c.length;n++)e=c[n],i=Math.min(i,e.resolution),h=Math.min(h,e.multisample),g=this.useMaxPadding?Math.max(g,e.padding):g+e.padding,l=l&&e.autoFit,m=m||null===(k=e.legacy)||void 0===k||k;1===q.length&&(this.defaultFilterStack[0].renderTexture=b.current),q.push(a),a.resolution=i,a.multisample=h,a.legacy=m,a.target=p,a.sourceFrame.copyFrom(p.filterArea||p.getBounds(!0)),a.sourceFrame.pad(g),j=this.tempRect.copyFrom(b.sourceFrame),d.projection.transform&&this.transformAABB(dD.copyFrom(d.projection.transform).invert(),j),l?(a.sourceFrame.fit(j),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(j)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,b.current?b.current.resolution:d.resolution,b.sourceFrame,b.destinationFrame,d.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,i,h),a.filters=c,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height,f=this.tempRect,f.x=0,f.y=0,f.width=a.sourceFrame.width,f.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(b.sourceFrame),a.bindingDestinationFrame.copyFrom(b.destinationFrame),a.transform=d.projection.transform,d.projection.transform=null,b.bind(a.renderTexture,a.sourceFrame,f),d.framebuffer.clear(0,0,0,0)},b.prototype.pop=function(){var l=this.defaultFilterStack,b=l.pop(),i=b.filters,f,d,e,j,k,m,c,h,g,n;if(this.activeState=b,f=this.globalUniforms.uniforms,f.outputFrame=b.sourceFrame,f.resolution=b.resolution,d=f.inputSize,e=f.inputPixel,j=f.inputClamp,(d[0]=b.destinationFrame.width,d[1]=b.destinationFrame.height,d[2]=1/d[0],d[3]=1/d[1],e[0]=Math.round(d[0]*b.resolution),e[1]=Math.round(d[1]*b.resolution),e[2]=1/e[0],e[3]=1/e[1],j[0]=.5*e[2],j[1]=.5*e[3],j[2]=b.sourceFrame.width*d[2]-.5*e[2],j[3]=b.sourceFrame.height*d[3]-.5*e[3],b.legacy)&&(k=f.filterArea,k[0]=b.destinationFrame.width,k[1]=b.destinationFrame.height,k[2]=b.sourceFrame.x,k[3]=b.sourceFrame.y,f.filterClamp=f.inputClamp),this.globalUniforms.update(),m=l[l.length-1],this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,b.renderTexture,m.renderTexture,a.CLEAR_MODES.BLEND,b),this.returnFilterTexture(b.renderTexture);else{c=b.renderTexture,h=this.getOptimalFilterTexture(c.width,c.height,b.resolution),h.filterFrame=c.filterFrame,g=0;for(g=0;g<i.length-1;++g)1===g&&b.multisample>1&&((h=this.getOptimalFilterTexture(c.width,c.height,b.resolution)).filterFrame=c.filterFrame),i[g].apply(this,c,h,a.CLEAR_MODES.CLEAR,b),n=c,c=h,h=n;i[g].apply(this,c,m.renderTexture,a.CLEAR_MODES.BLEND,b),g>1&&b.multisample>1&&this.returnFilterTexture(b.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(h)}b.clear(),this.statePool.push(b)},b.prototype.bindAndClear=function(b,d){var e,f,g,c,h;void 0===d&&(d=a.CLEAR_MODES.CLEAR),e=this.renderer,f=e.renderTexture,g=e.state,(b===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,b&&b.filterFrame)?(c=this.tempRect,c.x=0,c.y=0,c.width=b.filterFrame.width,c.height=b.filterFrame.height,f.bind(b,b.filterFrame,c)):b!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?f.bind(b):this.renderer.renderTexture.bind(b,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame),h=1&g.stateId||this.forceClear,(d===a.CLEAR_MODES.CLEAR||d===a.CLEAR_MODES.BLIT&&h)&&this.renderer.framebuffer.clear(0,0,0,0)},b.prototype.applyFilter=function(b,d,e,f){var c=this.renderer;c.state.set(b.state),this.bindAndClear(e,f),b.uniforms.uSampler=d,b.uniforms.filterGlobals=this.globalUniforms,c.shader.bind(b),b.legacy=!!b.program.attributeData.aTextureCoord,b.legacy?(this.quadUv.map(d._frame,d.filterFrame),c.geometry.bind(this.quadUv),c.geometry.draw(a.DRAW_MODES.TRIANGLES)):(c.geometry.bind(this.quad),c.geometry.draw(a.DRAW_MODES.TRIANGLE_STRIP))},b.prototype.calculateSpriteMatrix=function(h,b){var c=this.activeState,d=c.sourceFrame,e=c.destinationFrame,f=b._texture.orig,a=h.set(e.width,0,0,e.height,d.x,d.y),g=b.worldTransform.copyTo(m.TEMP_MATRIX);return g.invert(),a.prepend(g),a.scale(1/f.width,1/f.height),a.translate(b.anchor.x,b.anchor.y),a},b.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},b.prototype.getOptimalFilterTexture=function(d,e,b,c){return void 0===b&&(b=1),void 0===c&&(c=a.MSAA_QUALITY.NONE),this.texturePool.getOptimalTexture(d,e,b,c)},b.prototype.getFilterTexture=function(b,c,f){var e,d;return"number"==typeof b&&(e=b,b=c,c=e),b=b||this.activeState.renderTexture,d=this.texturePool.getOptimalTexture(b.width,b.height,c||b.resolution,f||a.MSAA_QUALITY.NONE),d.filterFrame=b.filterFrame,d},b.prototype.returnFilterTexture=function(a){this.texturePool.returnTexture(a)},b.prototype.emptyPool=function(){this.texturePool.clear(!0)},b.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},b.prototype.transformAABB=function(f,a){var b=bi[0],c=bi[1],d=bi[2],e=bi[3],g,h,i,j;b.set(a.left,a.top),c.set(a.left,a.bottom),d.set(a.right,a.top),e.set(a.right,a.bottom),f.apply(b,b),f.apply(c,c),f.apply(d,d),f.apply(e,e),g=Math.min(b.x,c.x,d.x,e.x),h=Math.min(b.y,c.y,d.y,e.y),i=Math.max(b.x,c.x,d.x,e.x),j=Math.max(b.y,c.y,d.y,e.y),a.x=g,a.y=h,a.width=i-g,a.height=j-h},b.prototype.roundFrame=function(c,e,b,d,a){if(!(c.width<=0||c.height<=0||b.width<=0||b.height<=0)){if(a){var f=a.a,g=a.b,h=a.c,i=a.d;if((Math.abs(g)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(i)>1e-4))return}(a=a?dD.copyFrom(a):dD.identity()).translate(-b.x,-b.y).scale(d.width/b.width,d.height/b.height).translate(d.x,d.y),this.transformAABB(a,c),c.ceil(e),this.transformAABB(a.invert(),c)}},b}(),aF=function(){function a(a){this.renderer=a}return a.prototype.flush=function(){},a.prototype.destroy=function(){this.renderer=null},a.prototype.start=function(){},a.prototype.stop=function(){this.flush()},a.prototype.render=function(a){},a}(),db=function(){function a(a){this.renderer=a,this.emptyRenderer=new aF(a),this.currentRenderer=this.emptyRenderer}return a.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())},a.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.copyBoundTextures=function(b,c){for(var d=this.renderer.texture.boundTextures,a=c-1;a>=0;--a)b[a]=d[a]||null,b[a]&&(b[a]._batchLocation=a)},a.prototype.boundArray=function(e,g,k,h){for(var l=e.elements,i=e.ids,j=e.count,a=0,b=0,c,d,f;b<j;b++)if(c=l[b],d=c._batchLocation,d>=0&&d<h&&g[d]===c)i[b]=d;else for(;a<h;){if(f=g[a],!f||f._batchEnabled!==k||f._batchLocation!==a){i[b]=a,c._batchLocation=a,g[a]=c;break}a++}},a.prototype.destroy=function(){this.renderer=null},a}(),ej=0,dd=function(){function c(a){this.renderer=a,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),a.view.addEventListener("webglcontextlost",this.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(c.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),c.prototype.contextChange=function(a){this.gl=a,this.renderer.gl=a,this.renderer.CONTEXT_UID=ej++,a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").restoreContext()},c.prototype.initFromContext=function(a){this.gl=a,this.validateContext(a),this.renderer.gl=a,this.renderer.CONTEXT_UID=ej++,this.renderer.runners.contextChange.emit(a)},c.prototype.initFromOptions=function(a){var b=this.createContext(this.renderer.view,a);this.initFromContext(b)},c.prototype.createContext=function(d,e){var c;if(b.PREFER_ENV>=a.ENV.WEBGL2&&(c=d.getContext("webgl2",e)),c)this.webGLVersion=2;else if(this.webGLVersion=1,!(c=d.getContext("webgl",e)||d.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=c,this.getExtensions(),this.gl},c.prototype.getExtensions=function(){var a=this.gl,b={anisotropicFiltering:a.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),s3tc:a.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:a.getExtension("WEBGL_compressed_texture_etc"),etc1:a.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:a.getExtension("WEBGL_compressed_texture_atc"),astc:a.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,b,{drawBuffers:a.getExtension("WEBGL_draw_buffers"),depthTexture:a.getExtension("WEBGL_depth_texture"),loseContext:a.getExtension("WEBGL_lose_context"),vertexArrayObject:a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:a.getExtension("OES_element_index_uint"),floatTexture:a.getExtension("OES_texture_float"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),textureHalfFloat:a.getExtension("OES_texture_half_float"),textureHalfFloatLinear:a.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,b,{colorBufferFloat:a.getExtension("EXT_color_buffer_float")})},c.prototype.handleContextLost=function(a){a.preventDefault()},c.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},c.prototype.destroy=function(){var a=this.renderer.view;this.renderer=null,a.removeEventListener("webglcontextlost",this.handleContextLost),a.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},c.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},c.prototype.validateContext=function(a){var b=a.getContextAttributes(),c="WebGL2RenderingContext"in globalThis&&a instanceof globalThis.WebGL2RenderingContext,d;c&&(this.webGLVersion=2),b&&!b.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly"),d=c||!!a.getExtension("OES_element_index_uint"),this.supports.uint32Indices=d,d||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},c}(),ei=function(b){this.framebuffer=b,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=a.MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},ih=new d,dg=function(){function c(a){this.renderer=a,this.managedFramebuffers=[],this.unknownFramebuffer=new a_(10,10),this.msaaSamples=null}return c.prototype.contextChange=function(){var c=this.gl=this.renderer.gl,e,f;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new d,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion?(e=this.renderer.context.extensions.drawBuffers,f=this.renderer.context.extensions.depthTexture,b.PREFER_ENV===a.ENV.WEBGL_LEGACY&&(e=null,f=null),e?c.drawBuffers=function(a){return e.drawBuffersWEBGL(a)}:(this.hasMRT=!1,c.drawBuffers=function(){}),f||(this.writeDepthTexture=!1)):this.msaaSamples=c.getInternalformatParameter(c.RENDERBUFFER,c.RGBA8,c.SAMPLES)},c.prototype.bind=function(a,b,d){var e,c,g,i,f,h,j;if(void 0===d&&(d=0),e=this.gl,a){c=a.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(a),this.current!==a&&(this.current=a,e.bindFramebuffer(e.FRAMEBUFFER,c.framebuffer)),c.mipLevel!==d&&(a.dirtyId++,a.dirtyFormat++,c.mipLevel=d),c.dirtyId!==a.dirtyId&&(c.dirtyId=a.dirtyId,c.dirtyFormat!==a.dirtyFormat?(c.dirtyFormat=a.dirtyFormat,c.dirtySize=a.dirtySize,this.updateFramebuffer(a,d)):c.dirtySize!==a.dirtySize&&(c.dirtySize=a.dirtySize,this.resizeFramebuffer(a)));for(g=0;g<a.colorTextures.length;g++)i=a.colorTextures[g],this.renderer.texture.unbind(i.parentTextureArray||i);a.depthTexture&&this.renderer.texture.unbind(a.depthTexture),b?(f=b.width>>d,h=b.height>>d,j=f/b.width,this.setViewport(b.x*j,b.y*j,f,h)):(f=a.width>>d,h=a.height>>d,this.setViewport(0,0,f,h))}else this.current&&(this.current=null,e.bindFramebuffer(e.FRAMEBUFFER,null)),b?this.setViewport(b.x,b.y,b.width,b.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},c.prototype.setViewport=function(b,c,d,e){var a=this.viewport;b=Math.round(b),c=Math.round(c),d=Math.round(d),e=Math.round(e),a.width===d&&a.height===e&&a.x===b&&a.y===c||(a.x=b,a.y=c,a.width=d,a.height=e,this.gl.viewport(b,c,d,e))},Object.defineProperty(c.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),c.prototype.clear=function(d,e,f,g,b){void 0===b&&(b=a.BUFFER_BITS.COLOR|a.BUFFER_BITS.DEPTH);var c=this.gl;c.clearColor(d,e,f,g),c.clear(b)},c.prototype.initFramebuffer=function(a){var c=this.gl,b=new ei(c.createFramebuffer());return b.multisample=this.detectSamples(a.multisample),a.glFramebuffers[this.CONTEXT_UID]=b,this.managedFramebuffers.push(a),a.disposeRunner.add(this),b},c.prototype.resizeFramebuffer=function(b){var a=this.gl,c=b.glFramebuffers[this.CONTEXT_UID],f,d,e,g,h;c.msaaBuffer&&(a.bindRenderbuffer(a.RENDERBUFFER,c.msaaBuffer),a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.RGBA8,b.width,b.height)),c.stencil&&(a.bindRenderbuffer(a.RENDERBUFFER,c.stencil),c.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.DEPTH24_STENCIL8,b.width,b.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,b.width,b.height)),f=b.colorTextures,d=f.length,a.drawBuffers||(d=Math.min(d,1));for(e=0;e<d;e++)g=f[e],h=g.parentTextureArray||g,this.renderer.texture.bind(h,0);b.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(b.depthTexture,0)},c.prototype.updateFramebuffer=function(c,i){var a=this.gl,b=c.glFramebuffers[this.CONTEXT_UID],h=c.colorTextures,e=h.length,f,d,g,j,k;a.drawBuffers||(e=Math.min(e,1)),b.multisample>1&&this.canMultisampleFramebuffer(c)?(b.msaaBuffer=b.msaaBuffer||a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,b.msaaBuffer),a.renderbufferStorageMultisample(a.RENDERBUFFER,b.multisample,a.RGBA8,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,b.msaaBuffer)):b.msaaBuffer&&(a.deleteRenderbuffer(b.msaaBuffer),b.msaaBuffer=null,b.blitFramebuffer&&(b.blitFramebuffer.dispose(),b.blitFramebuffer=null));for(f=[],d=0;d<e;d++)g=h[d],j=g.parentTextureArray||g,this.renderer.texture.bind(j,0),0===d&&b.msaaBuffer||(a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+d,g.target,j._glTextures[this.CONTEXT_UID].texture,i),f.push(a.COLOR_ATTACHMENT0+d));f.length>1&&a.drawBuffers(f),c.depthTexture&&this.writeDepthTexture&&(k=c.depthTexture,this.renderer.texture.bind(k,0),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,k._glTextures[this.CONTEXT_UID].texture,i)),!c.stencil&&!c.depth||c.depthTexture&&this.writeDepthTexture?b.stencil&&(a.deleteRenderbuffer(b.stencil),b.stencil=null):(b.stencil=b.stencil||a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,b.stencil),b.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,b.multisample,a.DEPTH24_STENCIL8,c.width,c.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,b.stencil))},c.prototype.canMultisampleFramebuffer=function(a){return 1!==this.renderer.context.webGLVersion&&a.colorTextures.length<=1&&!a.depthTexture},c.prototype.detectSamples=function(e){var c=this.msaaSamples,b=a.MSAA_QUALITY.NONE,d;if(e<=1||null===c)return b;for(d=0;d<c.length;d++)if(c[d]<=e){b=c[d];break}return 1===b&&(b=a.MSAA_QUALITY.NONE),b},c.prototype.blit=function(a,c,d){var g=this,b=g.current,i=g.renderer,f=g.gl,j=g.CONTEXT_UID,e,h,k;if(2===i.context.webGLVersion&&b)if(e=b.glFramebuffers[j],e){if(!a){if(!e.msaaBuffer)return;if(h=b.colorTextures[0],!h)return;e.blitFramebuffer||(e.blitFramebuffer=new a_(b.width,b.height),e.blitFramebuffer.addColorTexture(0,h)),(a=e.blitFramebuffer).colorTextures[0]!==h&&(a.colorTextures[0]=h,a.dirtyId++,a.dirtyFormat++),a.width===b.width&&a.height===b.height||(a.width=b.width,a.height=b.height,a.dirtyId++,a.dirtySize++)}c||((c=ih).width=b.width,c.height=b.height),d||(d=c),k=c.width===d.width&&c.height===d.height,this.bind(a),f.bindFramebuffer(f.READ_FRAMEBUFFER,e.framebuffer),f.blitFramebuffer(c.left,c.top,c.right,c.bottom,d.left,d.top,d.right,d.bottom,f.COLOR_BUFFER_BIT,k?f.NEAREST:f.LINEAR)}},c.prototype.disposeFramebuffer=function(b,e){var a=b.glFramebuffers[this.CONTEXT_UID],c=this.gl,d;a&&(delete b.glFramebuffers[this.CONTEXT_UID],d=this.managedFramebuffers.indexOf(b),d>=0&&this.managedFramebuffers.splice(d,1),b.disposeRunner.remove(this),e||(c.deleteFramebuffer(a.framebuffer),a.msaaBuffer&&c.deleteRenderbuffer(a.msaaBuffer),a.stencil&&c.deleteRenderbuffer(a.stencil)),a.blitFramebuffer&&a.blitFramebuffer.dispose())},c.prototype.disposeAll=function(c){var b=this.managedFramebuffers,a;this.managedFramebuffers=[];for(a=0;a<b.length;a++)this.disposeFramebuffer(b[a],c)},c.prototype.forceStencil=function(){var b=this.current,c,e,f,a,d;b&&(c=b.glFramebuffers[this.CONTEXT_UID],c&&!c.stencil&&(b.stencil=!0,e=b.width,f=b.height,a=this.gl,d=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,d),c.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.DEPTH24_STENCIL8,e,f):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,e,f),c.stencil=d,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,d)))},c.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new d},c.prototype.destroy=function(){this.renderer=null},c}(),dh={5126:4,5123:2,5121:1},di=function(){function c(a){this.renderer=a,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return c.prototype.contextChange=function(){var c,e,d,f;this.disposeAll(!0),c=this.gl=this.renderer.gl,e=this.renderer.context,(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion)&&(d=this.renderer.context.extensions.vertexArrayObject,b.PREFER_ENV===a.ENV.WEBGL_LEGACY&&(d=null),d?(c.createVertexArray=function(){return d.createVertexArrayOES()},c.bindVertexArray=function(a){return d.bindVertexArrayOES(a)},c.deleteVertexArray=function(a){return d.deleteVertexArrayOES(a)}):(this.hasVao=!1,c.createVertexArray=function(){return null},c.bindVertexArray=function(){return null},c.deleteVertexArray=function(){return null})),2!==e.webGLVersion&&(f=c.getExtension("ANGLE_instanced_arrays"),f?(c.vertexAttribDivisor=function(a,b){return f.vertexAttribDivisorANGLE(a,b)},c.drawElementsInstanced=function(a,b,c,d,e){return f.drawElementsInstancedANGLE(a,b,c,d,e)},c.drawArraysInstanced=function(a,b,c,d){return f.drawArraysInstancedANGLE(a,b,c,d)}):this.hasInstance=!1),this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},c.prototype.bind=function(a,b){var f,c,e,d;b=b||this.renderer.shader.shader,f=this.gl,c=a.glVertexArrayObjects[this.CONTEXT_UID],e=!1,c||(this.managedGeometries[a.id]=a,a.disposeRunner.add(this),a.glVertexArrayObjects[this.CONTEXT_UID]=c={},e=!0),d=c[b.program.id]||this.initGeometryVao(a,b,e),this._activeGeometry=a,this._activeVao!==d&&(this._activeVao=d,this.hasVao?f.bindVertexArray(d):this.activateVao(a,b.program)),this.updateBuffers()},c.prototype.reset=function(){this.unbind()},c.prototype.updateBuffers=function(){for(var b=this._activeGeometry,c=this.renderer.buffer,a=0,d;a<b.buffers.length;a++)d=b.buffers[a],c.update(d)},c.prototype.checkCompatibility=function(b,c){var d=b.attributes,e=c.attributeData,a;for(a in e)if(!d[a])throw new Error('shader and geometry incompatible, geometry missing the "'+a+'" attribute')},c.prototype.getSignature=function(b,e){var f=b.attributes,c=e.attributeData,d=["g",b.id],a;for(a in f)c[a]&&d.push(a,c[a].location);return d.join("-")},c.prototype.initGeometryVao=function(f,r,o){var m,n,s,e,p,h,d,k,c,g,j,a,b,q,i,l;if(void 0===o&&(o=!0),m=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,e=r.program,e.glPrograms[n]||this.renderer.shader.generateProgram(r),this.checkCompatibility(f,e),p=this.getSignature(f,e),h=f.glVertexArrayObjects[this.CONTEXT_UID],d=h[p],d)return h[e.id]=d,d;k=f.buffers,c=f.attributes,g={},j={};for(a in k)g[a]=0,j[a]=0;for(a in c)!c[a].size&&e.attributeData[a]?c[a].size=e.attributeData[a].size:c[a].size||console.warn("PIXI Geometry attribute '"+a+"' size cannot be determined (likely the bound shader does not have the attribute)"),g[c[a].buffer]+=c[a].size*dh[c[a].type];for(a in c)b=c[a],q=b.size,void 0===b.stride&&(g[b.buffer]===q*dh[b.type]?b.stride=0:b.stride=g[b.buffer]),void 0===b.start&&(b.start=j[b.buffer],j[b.buffer]+=q*dh[b.type]);d=m.createVertexArray(),m.bindVertexArray(d);for(i=0;i<k.length;i++)l=k[i],s.bind(l),o&&l._glBuffers[n].refCount++;return this.activateVao(f,e),this._activeVao=d,h[e.id]=d,h[p]=d,d},c.prototype.disposeGeometry=function(a,f){var c,d,k,e,i,b,g,j,h;if(this.managedGeometries[a.id])if(delete this.managedGeometries[a.id],d=a.glVertexArrayObjects[this.CONTEXT_UID],k=this.gl,e=a.buffers,i=null===(c=this.renderer)||void 0===c?void 0:c.buffer,a.disposeRunner.remove(this),d){if(i)for(b=0;b<e.length;b++)g=e[b]._glBuffers[this.CONTEXT_UID],g&&(g.refCount--,0!==g.refCount||f||i.dispose(e[b],f));if(!f)for(j in d)"g"===j[0]&&(h=d[j],this._activeVao===h&&this.unbind(),k.deleteVertexArray(h));delete a.glVertexArrayObjects[this.CONTEXT_UID]}},c.prototype.disposeAll=function(c){for(var b=Object.keys(this.managedGeometries),a=0;a<b.length;a++)this.disposeGeometry(this.managedGeometries[b[a]],c)},c.prototype.activateVao=function(b,i){var c=this.gl,l=this.CONTEXT_UID,g=this.renderer.buffer,m=b.buffers,k=b.attributes,h,d,a,j,f,e;b.indexBuffer&&g.bind(b.indexBuffer),h=null;for(d in k)if(a=k[d],j=m[a.buffer],f=j._glBuffers[l],i.attributeData[d])if(h!==f&&(g.bind(j),h=f),e=i.attributeData[d].location,c.enableVertexAttribArray(e),c.vertexAttribPointer(e,a.size,a.type||c.FLOAT,a.normalized,a.stride,a.start),a.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");c.vertexAttribDivisor(e,1)}},c.prototype.draw=function(f,d,e,g){var b=this.gl,a=this._activeGeometry,c,h;return a.indexBuffer?(c=a.indexBuffer.data.BYTES_PER_ELEMENT,h=2===c?b.UNSIGNED_SHORT:b.UNSIGNED_INT,2===c||4===c&&this.canUseUInt32ElementIndex?a.instanced?b.drawElementsInstanced(f,d||a.indexBuffer.data.length,h,(e||0)*c,g||1):b.drawElements(f,d||a.indexBuffer.data.length,h,(e||0)*c):console.warn("unsupported index buffer type: uint32")):a.instanced?b.drawArraysInstanced(f,e,d||a.getSize(),g||1):b.drawArrays(f,e,d||a.getSize()),this},c.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},c.prototype.destroy=function(){this.renderer=null},c}(),eg=function(){function c(c){void 0===c&&(c=null),this.type=a.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=c||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=b.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(c.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(a){a?this._filters?this._filters[0]=a:this._filters=[a]:this._filters=null},enumerable:!1,configurable:!0}),c.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=a.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},c.prototype.copyCountersOrReset=function(a){a?(this._stencilCounter=a._stencilCounter,this._scissorCounter=a._scissorCounter,this._scissorRect=a._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},c}();function dY(a,c,d){var b=a.createShader(c);return a.shaderSource(b,d),a.compileShader(b),b}function dX(c,f){var b=c.getShaderSource(f).split("\n").map(function(a,b){return b+": "+a}),d=c.getShaderInfoLog(f),g=d.split("\n"),e={},h=g.map(function(a){return parseFloat(a.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(a){return!(!a||e[a]||(e[a]=!0,0))}),a=[""],i;h.forEach(function(c){b[c-1]="%c"+b[c-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}),i=b.join("\n"),a[0]=i,console.error(d),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function dm(c){for(var a=new Array(c),b=0;b<a.length;b++)a[b]=!1;return a}function dW(b,a){switch(b){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*a);case"vec3":return new Float32Array(3*a);case"vec4":return new Float32Array(4*a);case"ivec2":return new Int32Array(2*a);case"ivec3":return new Int32Array(3*a);case"ivec4":return new Int32Array(4*a);case"uvec2":return new Uint32Array(2*a);case"uvec3":return new Uint32Array(3*a);case"uvec4":return new Uint32Array(4*a);case"bool":return!1;case"bvec2":return dm(2*a);case"bvec3":return dm(3*a);case"bvec4":return dm(4*a);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}dV={},aC=dV;function dU(){if(aC===dV||aC&&aC.isContextLost()){var d=b.ADAPTER.createCanvas(),c=void 0;b.PREFER_ENV>=a.ENV.WEBGL2&&(c=d.getContext("webgl2",{})),c||((c=d.getContext("webgl",{})||d.getContext("experimental-webgl",{}))?c.getExtension("WEBGL_draw_buffers"):c=null),aC=c}return aC}function dT(b,c,d){if("precision"!==b.substring(0,9)){var e=c;return c===a.PRECISION.HIGH&&d!==a.PRECISION.HIGH&&(e=a.PRECISION.MEDIUM),"precision "+e+" float;\n"+b}return d!==a.PRECISION.HIGH&&"precision highp"===b.substring(0,15)?b.replace("precision highp","precision mediump"):b}hX={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function dN(a){return hX[a]}bv=null,dL={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function dK(d,e){var b,a,c;if(!bv){b=Object.keys(dL),bv={};for(a=0;a<b.length;++a)c=b[a],bv[d[c]]=dL[c]}return bv[e]}Y=[{test:function(a){return"float"===a.type&&1===a.size&&!a.isArray},code:function(a){return'\n            if(uv["'+a+'"] !== ud["'+a+'"].value)\n            {\n                ud["'+a+'"].value = uv["'+a+'"]\n                gl.uniform1f(ud["'+a+'"].location, uv["'+a+'"])\n            }\n            '}},{test:function(a,b){return!("sampler2D"!==a.type&&"samplerCube"!==a.type&&"sampler2DArray"!==a.type||1!==a.size||a.isArray||null!=b&&void 0===b.castToBaseTexture)},code:function(a){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+a+'"], t);\n\n            if(ud["'+a+'"].value !== t)\n            {\n                ud["'+a+'"].value = t;\n                gl.uniform1i(ud["'+a+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(a,b){return"mat3"===a.type&&1===a.size&&!a.isArray&&void 0!==b.a},code:function(a){return'\n            gl.uniformMatrix3fv(ud["'+a+'"].location, false, uv["'+a+'"].toArray(true));\n            '},codeUbo:function(a){return"\n                var "+a+"_matrix = uv."+a+".toArray(true);\n\n                data[offset] = "+a+"_matrix[0];\n                data[offset+1] = "+a+"_matrix[1];\n                data[offset+2] = "+a+"_matrix[2];\n        \n                data[offset + 4] = "+a+"_matrix[3];\n                data[offset + 5] = "+a+"_matrix[4];\n                data[offset + 6] = "+a+"_matrix[5];\n        \n                data[offset + 8] = "+a+"_matrix[6];\n                data[offset + 9] = "+a+"_matrix[7];\n                data[offset + 10] = "+a+"_matrix[8];\n            "}},{test:function(a,b){return"vec2"===a.type&&1===a.size&&!a.isArray&&void 0!==b.x},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+a+'"].location, v.x, v.y);\n                }'},codeUbo:function(a){return"\n                v = uv."+a+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(a){return"vec2"===a.type&&1===a.size&&!a.isArray},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+a+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(a,b){return"vec4"===a.type&&1===a.size&&!a.isArray&&void 0!==b.width},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+a+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(a){return"\n                    v = uv."+a+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(a){return"vec4"===a.type&&1===a.size&&!a.isArray},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+a+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],hZ={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},h_={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},h$=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function ht(c){for(var b="",a=0;a<c;++a)a>0&&(b+="\nelse "),a<c-1&&(b+="if(test == "+a+".0){}");return b}function er(b,a){var c,d;if(0===b)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(c=a.createShader(a.FRAGMENT_SHADER);;){if(d=h$.replace(/%forloop%/gi,ht(b)),a.shaderSource(c,d),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS))break;b=b/2|0}return b}ib=0,bl={},al=function(){function c(e,f,d){void 0===d&&(d="pixi-shader"),this.id=ib++,this.vertexSrc=e||c.defaultVertexSrc,this.fragmentSrc=f||c.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(d=d.replace(/\s+/g,"-"),bl[d]?(bl[d]++,d+="-"+bl[d]):bl[d]=1,this.vertexSrc="#define SHADER_NAME "+d+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+d+"\n"+this.fragmentSrc,this.vertexSrc=dT(this.vertexSrc,b.PRECISION_VERTEX,a.PRECISION.HIGH),this.fragmentSrc=dT(this.fragmentSrc,b.PRECISION_FRAGMENT,function(){var b,c;return br||(br=a.PRECISION.MEDIUM,b=dU(),b&&b.getShaderPrecisionFormat&&(c=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT),br=c.precision?a.PRECISION.HIGH:a.PRECISION.MEDIUM)),br}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(c,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(c,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),c.from=function(b,d,f){var e=b+d,a=bG[e];return a||(bG[e]=a=new c(b,d,f)),a},c}(),D=function(){function a(b,a){this.uniformBindCount=0,this.program=b,this.uniformGroup=a?a instanceof J?a:new J(a):new J({}),this.disposeRunner=new p("disposeShader")}return a.prototype.checkUniformExists=function(c,a){var d,b;if(a.uniforms[c])return!0;for(d in a.uniforms)if(b=a.uniforms[d],b.group&&this.checkUniformExists(c,b))return!0;return!1},a.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(a.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),a.from=function(b,c,d){return new a(al.from(b,c),d)},a}(),K=function(){function b(){this.data=0,this.blendMode=a.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(b.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(a){!!(1&this.data)!==a&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(a){!!(2&this.data)!==a&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(a){!!(4&this.data)!==a&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(a){!!(8&this.data)!==a&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(a){!!(32&this.data)!==a&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(a){!!(16&this.data)!==a&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"blendMode",{get:function(){return this._blendMode},set:function(b){this.blend=b!==a.BLEND_MODES.NONE,this._blendMode=b},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(a){this.offsets=!!a,this._polygonOffset=a},enumerable:!1,configurable:!0}),b.for2d=function(){var a=new b;return a.depthTest=!1,a.blend=!0,a},b}(),C=function(c){function a(e,f,g){var d=this,h=al.from(e||a.defaultVertexSrc,f||a.defaultFragmentSrc);return(d=c.call(this,h,g)||this).padding=0,d.resolution=b.FILTER_RESOLUTION,d.multisample=b.FILTER_MULTISAMPLE,d.enabled=!0,d.autoFit=!0,d.state=new K,d}return h(a,c),a.prototype.apply=function(a,b,c,d,e){a.applyFilter(this,b,c,d)},Object.defineProperty(a.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(a){this.state.blendMode=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"resolution",{get:function(){return this._resolution},set:function(a){this._resolution=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),a}(D),dM=new m,bu=function(){function a(b,a){this._texture=b,this.mapCoord=new m,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===a?.5:a,this.isSimple=!1}return Object.defineProperty(a.prototype,"texture",{get:function(){return this._texture},set:function(a){this._texture=a,this._textureID=-1},enumerable:!1,configurable:!0}),a.prototype.multiplyUvs=function(d,c){var a,b,e,f;void 0===c&&(c=d);for(a=this.mapCoord,b=0;b<d.length;b+=2)e=d[b],f=d[b+1],c[b]=e*a.a+f*a.c+a.tx,c[b+1]=e*a.b+f*a.d+a.ty;return c},a.prototype.update=function(i){var a=this._texture,b,h,d,c,f,g,e;return!(!a||!a.valid)&&(!(!i&&this._textureID===a._updateID)&&(this._textureID=a._updateID,this._updateID++,b=a._uvs,this.mapCoord.set(b.x1-b.x0,b.y1-b.y0,b.x3-b.x0,b.y3-b.y0,b.x0,b.y0),h=a.orig,d=a.trim,d&&(dM.set(h.width/d.width,0,0,h.height/d.height,-d.x/d.width,-d.y/d.height),this.mapCoord.append(dM)),c=a.baseTexture,f=this.uClampFrame,g=this.clampMargin/c.resolution,e=this.clampOffset,f[0]=(a._frame.x+g+e)/c.width,f[1]=(a._frame.y+g+e)/c.height,f[2]=(a._frame.x+a._frame.width-g+e)/c.width,f[3]=(a._frame.y+a._frame.height-g+e)/c.height,this.uClampOffset[0]=e/c.realWidth,this.uClampOffset[1]=e/c.realHeight,this.isSimple=a._frame.width===c.width&&a._frame.height===c.height&&0===a.rotate,!0))},a}(),dO=function(b){function a(a,c,d){var e=this,f=null;return"string"!=typeof a&&void 0===c&&void 0===d&&(f=a,a=void 0,c=void 0,d=void 0),(e=b.call(this,a||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",c||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",d)||this).maskSprite=f,e.maskMatrix=new m,e}return h(a,b),Object.defineProperty(a.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(a){this._maskSprite=a,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),a.prototype.apply=function(c,d,e,f){var b=this._maskSprite,a=b._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new bu(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,b).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=b.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,c.applyFilter(this,d,e,f))},a}(C),du=function(){function b(a){this.renderer=a,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return b.prototype.setMaskStack=function(a){this.maskStack=a,this.renderer.scissor.setMaskStack(a),this.renderer.stencil.setMaskStack(a)},b.prototype.push=function(f,e){var b=e,c,d;if(b.isMaskData||(c=this.maskDataPool.pop()||new eg,c.pooled=!0,c.maskObject=e,b=c),d=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,b.copyCountersOrReset(d),b._colorMask=d?d._colorMask:15,b.autoDetect&&this.detect(b),b._target=f,b.type!==a.MASK_TYPES.SPRITE&&this.maskStack.push(b),b.enabled)switch(b.type){case a.MASK_TYPES.SCISSOR:this.renderer.scissor.push(b);break;case a.MASK_TYPES.STENCIL:this.renderer.stencil.push(b);break;case a.MASK_TYPES.SPRITE:b.copyCountersOrReset(null),this.pushSpriteMask(b);break;case a.MASK_TYPES.COLOR:this.pushColorMask(b)}b.type===a.MASK_TYPES.SPRITE&&this.maskStack.push(b)},b.prototype.pop=function(d){var b=this.maskStack.pop(),c;if(b&&b._target===d){if(b.enabled)switch(b.type){case a.MASK_TYPES.SCISSOR:this.renderer.scissor.pop(b);break;case a.MASK_TYPES.STENCIL:this.renderer.stencil.pop(b.maskObject);break;case a.MASK_TYPES.SPRITE:this.popSpriteMask(b);break;case a.MASK_TYPES.COLOR:this.popColorMask(b)}b.reset(),b.pooled&&this.maskDataPool.push(b),0!==this.maskStack.length&&(c=this.maskStack[this.maskStack.length-1],c.type===a.MASK_TYPES.SPRITE&&c._filters&&(c._filters[0].maskSprite=c.maskObject))}},b.prototype.detect=function(b){var c=b.maskObject;c?c.isSprite?b.type=a.MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(b)?b.type=a.MASK_TYPES.SCISSOR:b.type=a.MASK_TYPES.STENCIL:b.type=a.MASK_TYPES.COLOR},b.prototype.pushSpriteMask=function(a){var e,h,i=a.maskObject,d=a._target,b=a._filters,f,g,c,j,k,l;b||(b=this.alphaMaskPool[this.alphaMaskIndex])||(b=this.alphaMaskPool[this.alphaMaskIndex]=[new dO]),c=this.renderer,j=c.renderTexture,j.current?(k=j.current,f=a.resolution||k.resolution,g=null!==(e=a.multisample)&&void 0!==e?e:k.multisample):(f=a.resolution||c.resolution,g=null!==(h=a.multisample)&&void 0!==h?h:c.multisample),b[0].resolution=f,b[0].multisample=g,b[0].maskSprite=i,l=d.filterArea,d.filterArea=i.getBounds(!0),c.filter.push(d,b),d.filterArea=l,a._filters||this.alphaMaskIndex++},b.prototype.popSpriteMask=function(a){this.renderer.filter.pop(),a._filters?a._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},b.prototype.pushColorMask=function(b){var c=b._colorMask,a=b._colorMask=c&b.colorMask;a!==c&&this.renderer.gl.colorMask(0!=(1&a),0!=(2&a),0!=(4&a),0!=(8&a))},b.prototype.popColorMask=function(b){var c=b._colorMask,a=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;a!==c&&this.renderer.gl.colorMask(0!=(1&a),0!=(2&a),0!=(4&a),0!=(8&a))},b.prototype.destroy=function(){this.renderer=null},b}(),dQ=function(){function a(a){this.renderer=a,this.maskStack=[],this.glConst=0}return a.prototype.getStackLength=function(){return this.maskStack.length},a.prototype.setMaskStack=function(c){var a=this.renderer.gl,d=this.getStackLength(),b;this.maskStack=c,b=this.getStackLength(),b!==d&&(0===b?a.disable(this.glConst):(a.enable(this.glConst),this._useCurrent()))},a.prototype._useCurrent=function(){},a.prototype.destroy=function(){this.renderer=null,this.maskStack=null},a}(),dR=new m,dS=[],dt=function(c){function a(d){var a=c.call(this,d)||this;return a.glConst=b.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,a}return h(a,c),a.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._scissorCounter:0},a.prototype.calcScissorRect=function(a){var c,g,h,e,b,f;a._scissorRectLocal||(g=a._scissorRect,h=a.maskObject,e=this.renderer,b=e.renderTexture,f=h.getBounds(!0,null!==(c=dS.pop())&&void 0!==c?c:new d),this.roundFrameToPixels(f,b.current?b.current.resolution:e.resolution,b.sourceFrame,b.destinationFrame,e.projection.transform),g&&f.fit(g),a._scissorRectLocal=f)},a.isMatrixRotated=function(a){if(!a)return!1;var b=a.a,c=a.b,d=a.c,e=a.d;return(Math.abs(c)>1e-4||Math.abs(d)>1e-4)&&(Math.abs(b)>1e-4||Math.abs(e)>1e-4)},a.prototype.testScissor=function(b){var c=b.maskObject,d;return!(!c.isFastRect||!c.isFastRect())&&(!a.isMatrixRotated(c.worldTransform)&&(!a.isMatrixRotated(this.renderer.projection.transform)&&(this.calcScissorRect(b),d=b._scissorRectLocal,d.width>0&&d.height>0)))},a.prototype.roundFrameToPixels=function(b,e,f,c,d){a.isMatrixRotated(d)||((d=d?dR.copyFrom(d):dR.identity()).translate(-f.x,-f.y).scale(c.width/f.width,c.height/f.height).translate(c.x,c.y),this.renderer.filter.transformAABB(d,b),b.fit(c),b.x=Math.round(b.x*e),b.y=Math.round(b.y*e),b.width=Math.round(b.width*e),b.height=Math.round(b.height*e))},a.prototype.push=function(a){a._scissorRectLocal||this.calcScissorRect(a);var b=this.renderer.gl;a._scissorRect||b.enable(b.SCISSOR_TEST),a._scissorCounter++,a._scissorRect=a._scissorRectLocal,this._useCurrent()},a.prototype.pop=function(a){var b=this.renderer.gl;a&&dS.push(a._scissorRectLocal),this.getStackLength()>0?this._useCurrent():b.disable(b.SCISSOR_TEST)},a.prototype._useCurrent=function(){var b,a=this.maskStack[this.maskStack.length-1]._scissorRect;b=this.renderer.renderTexture.current?a.y:this.renderer.height-a.height-a.y,this.renderer.gl.scissor(a.x,b,a.width,a.height)},a}(dQ),ds=function(c){function a(d){var a=c.call(this,d)||this;return a.glConst=b.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,a}return h(a,c),a.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._stencilCounter:0},a.prototype.push=function(c){var d=c.maskObject,a=this.renderer.gl,e=c._stencilCounter,b;0===e&&(this.renderer.framebuffer.forceStencil(),a.clearStencil(0),a.clear(a.STENCIL_BUFFER_BIT),a.enable(a.STENCIL_TEST)),c._stencilCounter++,b=c._colorMask,0!==b&&(c._colorMask=0,a.colorMask(!1,!1,!1,!1)),a.stencilFunc(a.EQUAL,e,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.INCR),d.renderable=!0,d.render(this.renderer),this.renderer.batch.flush(),d.renderable=!1,0!==b&&(c._colorMask=b,a.colorMask(0!=(1&b),0!=(2&b),0!=(4&b),0!=(8&b))),this._useCurrent()},a.prototype.pop=function(d){var a=this.renderer.gl,c,b;0===this.getStackLength()?a.disable(a.STENCIL_TEST):(c=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,b=c?c._colorMask:15,0!==b&&(c._colorMask=0,a.colorMask(!1,!1,!1,!1)),a.stencilOp(a.KEEP,a.KEEP,a.DECR),d.renderable=!0,d.render(this.renderer),this.renderer.batch.flush(),d.renderable=!1,0!==b&&(c._colorMask=b,a.colorMask(0!=(1&b),0!=(2&b),0!=(4&b),0!=(8&b))),this._useCurrent())},a.prototype._useCurrent=function(){var a=this.renderer.gl;a.stencilFunc(a.EQUAL,this.getStackLength(),4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)},a}(dQ),dq=function(){function a(a){this.renderer=a,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new m,this.transform=null}return a.prototype.update=function(b,c,d,e){this.destinationFrame=b||this.destinationFrame||this.defaultFrame,this.sourceFrame=c||this.sourceFrame||b,this.calculateProjection(this.destinationFrame,this.sourceFrame,d,e),this.transform&&this.projectionMatrix.append(this.transform);var a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)},a.prototype.calculateProjection=function(e,b,f,d){var a=this.projectionMatrix,c=d?-1:1;a.identity(),a.a=1/b.width*2,a.d=c*(1/b.height*2),a.tx=-1-b.x*a.a,a.ty=-c-b.y*a.d},a.prototype.setTransform=function(a){},a.prototype.destroy=function(){this.renderer=null},a}(),$=new d,aE=new d,dk=function(){function a(a){this.renderer=a,this.clearColor=a._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new d,this.destinationFrame=new d,this.viewportFrame=new d}return a.prototype.bind=function(a,c,b){var g,h,e,f,d;void 0===a&&(a=null),f=this.renderer,this.current=a,a?(e=(g=a.baseTexture).resolution,c||($.width=a.frame.width,$.height=a.frame.height,c=$),b||(aE.x=a.frame.x,aE.y=a.frame.y,aE.width=c.width,aE.height=c.height,b=aE),h=g.framebuffer):(e=f.resolution,c||($.width=f.screen.width,$.height=f.screen.height,c=$),b||((b=$).width=c.width,b.height=c.height)),d=this.viewportFrame,d.x=b.x*e,d.y=b.y*e,d.width=b.width*e,d.height=b.height*e,a||(d.y=f.view.height-(d.y+d.height)),d.ceil(),this.renderer.framebuffer.bind(h,d),this.renderer.projection.update(b,c,e,!h),a?this.renderer.mask.setMaskStack(g.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(c),this.destinationFrame.copyFrom(b)},a.prototype.clear=function(a,j){var h,i,g,b,f,c,d,e;a=this.current?a||this.current.baseTexture.clearColor:a||this.clearColor,h=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,g=h.width!==i.width||h.height!==i.height,g&&(b=this.viewportFrame,f=b.x,c=b.y,d=b.width,e=b.height,f=Math.round(f),c=Math.round(c),d=Math.round(d),e=Math.round(e),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(f,c,d,e)),this.renderer.framebuffer.clear(a[0],a[1],a[2],a[3],j),g&&this.renderer.scissor.pop()},a.prototype.resize=function(){this.bind(null)},a.prototype.reset=function(){this.bind(null)},a.prototype.destroy=function(){this.renderer=null},a}();function hW(c,d,a,e,b){a.buffer.update(b)}hU={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},d$={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function ea(h){for(var e=h.map(function(a){return{data:a,offset:0,dataLen:0,dirty:0}}),a=0,c=0,b=0,f=0,d,g;f<e.length;f++)d=e[f],(a=d$[d.data.type],d.data.size>1&&(a=Math.max(a,16)*d.data.size),d.dataLen=a,c%a!=0&&c<16)&&(g=c%a%16,c+=g,b+=g),c+a>16?(b=16*Math.ceil(b/16),d.offset=b,b+=a,c=a):(d.offset=b,c+=a,b+=a);return{uboElements:e,size:b=16*Math.ceil(b/16)}}function eb(d,b){var a=[],c;for(c in d)b[c]&&a.push(b[c]);return a.sort(function(a,b){return a.index-b.index}),a}function ec(m,r){var f,k,o,b,e,a,j,c,l,d,h,n,g,i,p,q;if(!m.autoManage)return{size:0,syncFunc:hW};for(f=ea(eb(m.uniforms,r)),k=f.uboElements,o=f.size,b=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],e=0;e<k.length;e++){for(a=k[e],j=m.uniforms[a.data.name],c=a.data.name,l=!1,d=0;d<Y.length;d++)if(h=Y[d],h.codeUbo&&h.test(a.data,j)){b.push("offset = "+a.offset/4+";",Y[d].codeUbo(a.data.name,j)),l=!0;break}l||(a.data.size>1?(n=dN(a.data.type),g=Math.max(d$[a.data.type]/16,1),i=n/g,p=(4-i%4)%4,b.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+a.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+a.data.size*g+"; i++)\n                {\n                    for(var j = 0; j < "+i+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+p+";\n                }\n\n                ")):(q=hU[a.data.type],b.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+a.offset/4+";\n                "+q+";\n                ")))}return b.push("\n       renderer.buffer.update(buffer);\n    "),{size:o,syncFunc:new Function("ud","uv","renderer","syncData","buffer",b.join("\n"))}}ed=function(){function a(a,b){this.program=a,this.uniformData=b,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return a.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},a}();function ee(a,d){var f=dY(a,a.VERTEX_SHADER,d.vertexSrc),g=dY(a,a.FRAGMENT_SHADER,d.fragmentSrc),b=a.createProgram(),e,c,h,i;if(a.attachShader(b,f),a.attachShader(b,g),a.linkProgram(b),a.getProgramParameter(b,a.LINK_STATUS)||function(a,b,c,d){a.getProgramParameter(b,a.LINK_STATUS)||(a.getShaderParameter(c,a.COMPILE_STATUS)||dX(a,c),a.getShaderParameter(d,a.COMPILE_STATUS)||dX(a,d),console.error("PixiJS Error: Could not initialize shader."),""!==a.getProgramInfoLog(b)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",a.getProgramInfoLog(b)))}(a,b,f,g),d.attributeData=function(c,a){for(var e={},g=a.getProgramParameter(c,a.ACTIVE_ATTRIBUTES),d=0,b,f,h;d<g;d++)b=a.getActiveAttrib(c,d),0!==b.name.indexOf("gl_")&&(f=dK(a,b.type),h={type:f,name:b.name,size:dN(f),location:a.getAttribLocation(c,b.name)},e[b.name]=h);return e}(b,a),d.uniformData=function(d,b){for(var e={},h=b.getProgramParameter(d,b.ACTIVE_UNIFORMS),c=0,a,f,i,g;c<h;c++)a=b.getActiveUniform(d,c),f=a.name.replace(/\[.*?\]$/,""),i=!!a.name.match(/\[.*?\]$/),g=dK(b,a.type),e[f]={name:f,index:c,type:g,size:a.size,isArray:i,value:dW(g,a.size)};return e}(b,a),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(d.vertexSrc)){e=Object.keys(d.attributeData),e.sort(function(a,b){return a>b?1:-1});for(c=0;c<e.length;c++)d.attributeData[e[c]].location=c,a.bindAttribLocation(b,c,e[c]);a.linkProgram(b)}a.deleteShader(f),a.deleteShader(g),h={};for(c in d.uniformData)i=d.uniformData[c],h[c]={location:a.getUniformLocation(b,c),value:dW(i.type,i.size)};return new ed(b,h)}hS=0,bp={textureCount:0,uboCount:0},df=function(){function a(a){this.destroyed=!1,this.renderer=a,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=hS++}return a.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof at)return at;try{var a=new Function("param1","param2","param3","return param1[param2] === param3;");at=!0===a({a:"b"},"a","b")}catch(a){at=!1}return at}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},a.prototype.contextChange=function(a){this.gl=a,this.reset()},a.prototype.bind=function(a,d){a.disposeRunner.add(this),a.uniforms.globals=this.renderer.globalUniforms;var b=a.program,c=b.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(a);return this.shader=a,this.program!==b&&(this.program=b,this.gl.useProgram(c.program)),d||(bp.textureCount=0,bp.uboCount=0,this.syncUniformGroup(a.uniformGroup,bp)),c},a.prototype.setUniforms=function(b){var a=this.shader.program,c=a.glPrograms[this.renderer.CONTEXT_UID];a.syncUniforms(c.uniformData,b,this.renderer)},a.prototype.syncUniformGroup=function(a,c){var b=this.getGlProgram();a.static&&a.dirtyId===b.uniformDirtyGroups[a.id]||(b.uniformDirtyGroups[a.id]=a.dirtyId,this.syncUniforms(a,b,c))},a.prototype.syncUniforms=function(a,b,c){(a.syncUniforms[this.shader.program.id]||this.createSyncGroups(a))(b.uniformData,a.uniforms,this.renderer,c)},a.prototype.createSyncGroups=function(a){var b=this.getSignature(a,this.shader.program.uniformData,"u");return this.cache[b]||(this.cache[b]=function(d,i){var f,b=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "],a,c,h,g,e,j;for(a in d.uniforms)if(c=i[a],c){for(h=d.uniforms[a],g=!1,e=0;e<Y.length;e++)if(Y[e].test(c,h)){b.push(Y[e].code(a,h)),g=!0;break}g||(j=(1!==c.size||c.isArray?h_:hZ)[c.type].replace("location",'ud["'+a+'"].location'),b.push('\n            cu = ud["'+a+'"];\n            cv = cu.value;\n            v = uv["'+a+'"];\n            '+j+";"))}else(null===(f=d.uniforms[a])||void 0===f?void 0:f.group)&&(d.uniforms[a].ubo?b.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+a+", '"+a+"');\n                    "):b.push("\n                        renderer.shader.syncUniformGroup(uv."+a+", syncData);\n                    "));return new Function("ud","uv","renderer","syncData",b.join("\n"))}(a,this.shader.program.uniformData)),a.syncUniforms[this.shader.program.id]=this.cache[b],a.syncUniforms[this.shader.program.id]},a.prototype.syncUniformBufferGroup=function(a,c){var b=this.getGlProgram(),d;(!a.static||0!==a.dirtyId||!b.uniformGroups[a.id])&&(a.dirtyId=0,d=b.uniformGroups[a.id]||this.createSyncBufferGroup(a,b,c),a.buffer.update(),d(b.uniformData,a.uniforms,this.renderer,bp,a.buffer)),this.renderer.buffer.bindBufferBase(a.buffer,b.uniformBufferBindings[c])},a.prototype.createSyncBufferGroup=function(a,b,d){var f=this.renderer.gl,g,e,c,h;return this.renderer.buffer.bind(a.buffer),g=this.gl.getUniformBlockIndex(b.program,d),b.uniformBufferBindings[d]=this.shader.uniformBindCount,f.uniformBlockBinding(b.program,g,this.shader.uniformBindCount),this.shader.uniformBindCount++,e=this.getSignature(a,this.shader.program.uniformData,"ubo"),c=this._uboCache[e],(c||(c=this._uboCache[e]=ec(a,this.shader.program.uniformData)),a.autoManage)&&(h=new Float32Array(c.size/4),a.buffer.update(h)),b.uniformGroups[a.id]=c.syncFunc,b.uniformGroups[a.id]},a.prototype.getSignature=function(d,c,e){var f=d.uniforms,a=[e+"-"],b;for(b in f)a.push(b),c[b]&&a.push(c[b].type);return a.join("-")},a.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},a.prototype.generateProgram=function(c){var d=this.gl,a=c.program,b=ee(d,a);return a.glPrograms[this.renderer.CONTEXT_UID]=b,b},a.prototype.reset=function(){this.program=null,this.shader=null},a.prototype.disposeShader=function(a){this.shader===a&&(this.shader=null)},a.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},a}(),de=function(){function b(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=a.BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new K,this.defaultState.blend=!0}return b.prototype.contextChange=function(b){this.gl=b,this.blendModes=function(b,c){return void 0===c&&(c=[]),c[a.BLEND_MODES.NORMAL]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.ADD]=[b.ONE,b.ONE],c[a.BLEND_MODES.MULTIPLY]=[b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.SCREEN]=[b.ONE,b.ONE_MINUS_SRC_COLOR,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.OVERLAY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.DARKEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.LIGHTEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.COLOR_DODGE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.COLOR_BURN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.HARD_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.SOFT_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.DIFFERENCE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.EXCLUSION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.HUE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.SATURATION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.COLOR]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.LUMINOSITY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.NONE]=[0,0],c[a.BLEND_MODES.NORMAL_NPM]=[b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.ADD_NPM]=[b.SRC_ALPHA,b.ONE,b.ONE,b.ONE],c[a.BLEND_MODES.SCREEN_NPM]=[b.SRC_ALPHA,b.ONE_MINUS_SRC_COLOR,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.SRC_IN]=[b.DST_ALPHA,b.ZERO],c[a.BLEND_MODES.SRC_OUT]=[b.ONE_MINUS_DST_ALPHA,b.ZERO],c[a.BLEND_MODES.SRC_ATOP]=[b.DST_ALPHA,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.DST_OVER]=[b.ONE_MINUS_DST_ALPHA,b.ONE],c[a.BLEND_MODES.DST_IN]=[b.ZERO,b.SRC_ALPHA],c[a.BLEND_MODES.DST_OUT]=[b.ZERO,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.DST_ATOP]=[b.ONE_MINUS_DST_ALPHA,b.SRC_ALPHA],c[a.BLEND_MODES.XOR]=[b.ONE_MINUS_DST_ALPHA,b.ONE_MINUS_SRC_ALPHA],c[a.BLEND_MODES.SUBTRACT]=[b.ONE,b.ONE,b.ONE,b.ONE,b.FUNC_REVERSE_SUBTRACT,b.FUNC_ADD],c}(b),this.set(this.defaultState),this.reset()},b.prototype.set=function(a){if(a=a||this.defaultState,this.stateId!==a.data){for(var c=this.stateId^a.data,b=0;c;)1&c&&this.map[b].call(this,!!(a.data&1<<b)),c>>=1,b++;this.stateId=a.data}for(b=0;b<this.checks.length;b++)this.checks[b](this,a)},b.prototype.forceState=function(b){b=b||this.defaultState;for(var a=0;a<this.map.length;a++)this.map[a].call(this,!!(b.data&1<<a));for(a=0;a<this.checks.length;a++)this.checks[a](this,b);this.stateId=b.data},b.prototype.setBlend=function(a){this.updateCheck(b.checkBlendMode,a),this.gl[a?"enable":"disable"](this.gl.BLEND)},b.prototype.setOffset=function(a){this.updateCheck(b.checkPolygonOffset,a),this.gl[a?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},b.prototype.setDepthTest=function(a){this.gl[a?"enable":"disable"](this.gl.DEPTH_TEST)},b.prototype.setDepthMask=function(a){this.gl.depthMask(a)},b.prototype.setCullFace=function(a){this.gl[a?"enable":"disable"](this.gl.CULL_FACE)},b.prototype.setFrontFace=function(a){this.gl.frontFace(this.gl[a?"CW":"CCW"])},b.prototype.setBlendMode=function(c){if(c!==this.blendMode){this.blendMode=c;var a=this.blendModes[c],b=this.gl;2===a.length?b.blendFunc(a[0],a[1]):b.blendFuncSeparate(a[0],a[1],a[2],a[3]),6===a.length?(this._blendEq=!0,b.blendEquationSeparate(a[4],a[5])):this._blendEq&&(this._blendEq=!1,b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD))}},b.prototype.setPolygonOffset=function(a,b){this.gl.polygonOffset(a,b)},b.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},b.prototype.updateCheck=function(b,c){var a=this.checks.indexOf(b);c&&-1===a?this.checks.push(b):c||-1===a||this.checks.splice(a,1)},b.checkBlendMode=function(a,b){a.setBlendMode(b.blendMode)},b.checkPolygonOffset=function(a,b){a.setPolygonOffset(1,b.polygonOffset)},b.prototype.destroy=function(){this.gl=null},b}(),dc=function(){function c(a){this.renderer=a,this.count=0,this.checkCount=0,this.maxIdle=b.GC_MAX_IDLE,this.checkCountMax=b.GC_MAX_CHECK_COUNT,this.mode=b.GC_MODE}return c.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==a.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},c.prototype.run=function(){for(var d=this.renderer.texture,b=d.managedTextures,e=!1,a=0,c,f;a<b.length;a++)c=b[a],!c.framebuffer&&this.count-c.touched>this.maxIdle&&(d.destroyTexture(c,!0),b[a]=null,e=!0);if(e){f=0;for(a=0;a<b.length;a++)null!==b[a]&&(b[f++]=b[a]);b.length=f}},c.prototype.unload=function(a){var d=this.renderer.texture,b=a._texture,c;b&&!b.framebuffer&&d.destroyTexture(b);for(c=a.children.length-1;c>=0;c--)this.unload(a.children[c])},c.prototype.destroy=function(){this.renderer=null},c}(),be=function(b){this.texture=b,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=a.TYPES.UNSIGNED_BYTE,this.internalFormat=a.FORMATS.RGBA,this.samplerType=0},cW=function(){function b(a){this.renderer=a,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new e,this.hasIntegerTextures=!1}return b.prototype.contextChange=function(){var b=this.gl=this.renderer.gl,d,c,e;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(b){var c,d,e,f,l,i,j,h,k,u,t,y,n,p,q,r,s,m,g,v,w,x,o;return"WebGL2RenderingContext"in globalThis&&b instanceof globalThis.WebGL2RenderingContext?((c={})[a.TYPES.UNSIGNED_BYTE]=((d={})[a.FORMATS.RGBA]=b.RGBA8,d[a.FORMATS.RGB]=b.RGB8,d[a.FORMATS.RG]=b.RG8,d[a.FORMATS.RED]=b.R8,d[a.FORMATS.RGBA_INTEGER]=b.RGBA8UI,d[a.FORMATS.RGB_INTEGER]=b.RGB8UI,d[a.FORMATS.RG_INTEGER]=b.RG8UI,d[a.FORMATS.RED_INTEGER]=b.R8UI,d[a.FORMATS.ALPHA]=b.ALPHA,d[a.FORMATS.LUMINANCE]=b.LUMINANCE,d[a.FORMATS.LUMINANCE_ALPHA]=b.LUMINANCE_ALPHA,d),c[a.TYPES.BYTE]=((e={})[a.FORMATS.RGBA]=b.RGBA8_SNORM,e[a.FORMATS.RGB]=b.RGB8_SNORM,e[a.FORMATS.RG]=b.RG8_SNORM,e[a.FORMATS.RED]=b.R8_SNORM,e[a.FORMATS.RGBA_INTEGER]=b.RGBA8I,e[a.FORMATS.RGB_INTEGER]=b.RGB8I,e[a.FORMATS.RG_INTEGER]=b.RG8I,e[a.FORMATS.RED_INTEGER]=b.R8I,e),c[a.TYPES.UNSIGNED_SHORT]=((f={})[a.FORMATS.RGBA_INTEGER]=b.RGBA16UI,f[a.FORMATS.RGB_INTEGER]=b.RGB16UI,f[a.FORMATS.RG_INTEGER]=b.RG16UI,f[a.FORMATS.RED_INTEGER]=b.R16UI,f[a.FORMATS.DEPTH_COMPONENT]=b.DEPTH_COMPONENT16,f),c[a.TYPES.SHORT]=((l={})[a.FORMATS.RGBA_INTEGER]=b.RGBA16I,l[a.FORMATS.RGB_INTEGER]=b.RGB16I,l[a.FORMATS.RG_INTEGER]=b.RG16I,l[a.FORMATS.RED_INTEGER]=b.R16I,l),c[a.TYPES.UNSIGNED_INT]=((i={})[a.FORMATS.RGBA_INTEGER]=b.RGBA32UI,i[a.FORMATS.RGB_INTEGER]=b.RGB32UI,i[a.FORMATS.RG_INTEGER]=b.RG32UI,i[a.FORMATS.RED_INTEGER]=b.R32UI,i[a.FORMATS.DEPTH_COMPONENT]=b.DEPTH_COMPONENT24,i),c[a.TYPES.INT]=((j={})[a.FORMATS.RGBA_INTEGER]=b.RGBA32I,j[a.FORMATS.RGB_INTEGER]=b.RGB32I,j[a.FORMATS.RG_INTEGER]=b.RG32I,j[a.FORMATS.RED_INTEGER]=b.R32I,j),c[a.TYPES.FLOAT]=((h={})[a.FORMATS.RGBA]=b.RGBA32F,h[a.FORMATS.RGB]=b.RGB32F,h[a.FORMATS.RG]=b.RG32F,h[a.FORMATS.RED]=b.R32F,h[a.FORMATS.DEPTH_COMPONENT]=b.DEPTH_COMPONENT32F,h),c[a.TYPES.HALF_FLOAT]=((k={})[a.FORMATS.RGBA]=b.RGBA16F,k[a.FORMATS.RGB]=b.RGB16F,k[a.FORMATS.RG]=b.RG16F,k[a.FORMATS.RED]=b.R16F,k),c[a.TYPES.UNSIGNED_SHORT_5_6_5]=((u={})[a.FORMATS.RGB]=b.RGB565,u),c[a.TYPES.UNSIGNED_SHORT_4_4_4_4]=((t={})[a.FORMATS.RGBA]=b.RGBA4,t),c[a.TYPES.UNSIGNED_SHORT_5_5_5_1]=((y={})[a.FORMATS.RGBA]=b.RGB5_A1,y),c[a.TYPES.UNSIGNED_INT_2_10_10_10_REV]=((n={})[a.FORMATS.RGBA]=b.RGB10_A2,n[a.FORMATS.RGBA_INTEGER]=b.RGB10_A2UI,n),c[a.TYPES.UNSIGNED_INT_10F_11F_11F_REV]=((p={})[a.FORMATS.RGB]=b.R11F_G11F_B10F,p),c[a.TYPES.UNSIGNED_INT_5_9_9_9_REV]=((q={})[a.FORMATS.RGB]=b.RGB9_E5,q),c[a.TYPES.UNSIGNED_INT_24_8]=((r={})[a.FORMATS.DEPTH_STENCIL]=b.DEPTH24_STENCIL8,r),c[a.TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]=((s={})[a.FORMATS.DEPTH_STENCIL]=b.DEPTH32F_STENCIL8,s),o=c):((m={})[a.TYPES.UNSIGNED_BYTE]=((g={})[a.FORMATS.RGBA]=b.RGBA,g[a.FORMATS.RGB]=b.RGB,g[a.FORMATS.ALPHA]=b.ALPHA,g[a.FORMATS.LUMINANCE]=b.LUMINANCE,g[a.FORMATS.LUMINANCE_ALPHA]=b.LUMINANCE_ALPHA,g),m[a.TYPES.UNSIGNED_SHORT_5_6_5]=((v={})[a.FORMATS.RGB]=b.RGB,v),m[a.TYPES.UNSIGNED_SHORT_4_4_4_4]=((w={})[a.FORMATS.RGBA]=b.RGBA,w),m[a.TYPES.UNSIGNED_SHORT_5_5_5_1]=((x={})[a.FORMATS.RGBA]=b.RGBA,x),o=m),o}(b),d=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS),this.boundTextures.length=d;for(c=0;c<d;c++)this.boundTextures[c]=null;this.emptyTextures={},e=new be(b.createTexture());for(b.bindTexture(b.TEXTURE_2D,e.texture),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[b.TEXTURE_2D]=e,this.emptyTextures[b.TEXTURE_CUBE_MAP]=new be(b.createTexture()),b.bindTexture(b.TEXTURE_CUBE_MAP,this.emptyTextures[b.TEXTURE_CUBE_MAP].texture),c=0;c<6;c++)b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null);for(b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,b.LINEAR),c=0;c<this.boundTextures.length;c++)this.bind(null,c)},b.prototype.bind=function(a,b){var c,d;void 0===b&&(b=0),c=this.gl,(a=null==a?void 0:a.castToBaseTexture())&&a.valid&&!a.parentTextureArray?(a.touched=this.renderer.textureGC.count,d=a._glTextures[this.CONTEXT_UID]||this.initTexture(a),this.boundTextures[b]!==a&&(this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),c.bindTexture(a.target,d.texture)),d.dirtyId!==a.dirtyId?(this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),this.updateTexture(a)):d.dirtyStyleId!==a.dirtyStyleId&&this.updateTextureStyle(a),this.boundTextures[b]=a):(this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),c.bindTexture(c.TEXTURE_2D,this.emptyTextures[c.TEXTURE_2D].texture),this.boundTextures[b]=null)},b.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var a=0;a<this.boundTextures.length;a++)this.boundTextures[a]=this.unknownTexture},b.prototype.unbind=function(c){var d=this.gl,b=this.boundTextures,a;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(a=0;a<b.length;a++)b[a]===this.unknownTexture&&this.bind(null,a)}for(a=0;a<b.length;a++)b[a]===c&&(this.currentLocation!==a&&(d.activeTexture(d.TEXTURE0+a),this.currentLocation=a),d.bindTexture(c.target,this.emptyTextures[c.target].texture),b[a]=null)},b.prototype.ensureSamplerType=function(h){var c=this,e=c.boundTextures,f=c.hasIntegerTextures,g=c.CONTEXT_UID,d,b;if(f)for(d=h-1;d>=0;--d)b=e[d],b&&b._glTextures[g].samplerType!==a.SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(b)},b.prototype.initTexture=function(a){var b=new be(this.gl.createTexture());return b.dirtyId=-1,a._glTextures[this.CONTEXT_UID]=b,this.managedTextures.push(a),a.on("dispose",this.destroyTexture,this),b},b.prototype.initTextureType=function(b,c){var d,e;c.internalFormat=null!==(e=null===(d=this.internalFormats[b.type])||void 0===d?void 0:d[b.format])&&void 0!==e?e:b.format,2===this.webGLVersion&&b.type===a.TYPES.HALF_FLOAT?c.type=this.gl.HALF_FLOAT:c.type=b.type},b.prototype.updateTexture=function(c){var b=c._glTextures[this.CONTEXT_UID],f,d,e,g;b&&(f=this.renderer,(this.initTextureType(c,b),c.resource&&c.resource.upload(f,c,b))?b.samplerType!==a.SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0):(d=c.realWidth,e=c.realHeight,g=f.gl,(b.width!==d||b.height!==e||b.dirtyId<0)&&(b.width=d,b.height=e,g.texImage2D(c.target,0,b.internalFormat,d,e,0,c.format,b.type,null))),c.dirtyStyleId!==b.dirtyStyleId&&this.updateTextureStyle(c),b.dirtyId=c.dirtyId)},b.prototype.destroyTexture=function(a,c){var d=this.gl,b;(a=a.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(a),d.deleteTexture(a._glTextures[this.CONTEXT_UID].texture),a.off("dispose",this.destroyTexture,this),delete a._glTextures[this.CONTEXT_UID],!c)&&(b=this.managedTextures.indexOf(a),-1!==b&&_(this.managedTextures,b,1))},b.prototype.updateTextureStyle=function(b){var c=b._glTextures[this.CONTEXT_UID];c&&(b.mipmap!==a.MIPMAP_MODES.POW2&&2===this.webGLVersion||b.isPowerOfTwo?c.mipmap=b.mipmap>=1:c.mipmap=!1,2===this.webGLVersion||b.isPowerOfTwo?c.wrapMode=b.wrapMode:c.wrapMode=a.WRAP_MODES.CLAMP,b.resource&&b.resource.style(this.renderer,b,c)||this.setStyle(b,c),c.dirtyStyleId=b.dirtyStyleId)},b.prototype.setStyle=function(c,d){var b=this.gl,e,f;d.mipmap&&c.mipmap!==a.MIPMAP_MODES.ON_MANUAL&&b.generateMipmap(c.target),b.texParameteri(c.target,b.TEXTURE_WRAP_S,d.wrapMode),b.texParameteri(c.target,b.TEXTURE_WRAP_T,d.wrapMode),d.mipmap?(b.texParameteri(c.target,b.TEXTURE_MIN_FILTER,c.scaleMode===a.SCALE_MODES.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST),e=this.renderer.context.extensions.anisotropicFiltering,e&&c.anisotropicLevel>0&&c.scaleMode===a.SCALE_MODES.LINEAR&&(f=Math.min(c.anisotropicLevel,b.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),b.texParameterf(c.target,e.TEXTURE_MAX_ANISOTROPY_EXT,f))):b.texParameteri(c.target,b.TEXTURE_MIN_FILTER,c.scaleMode===a.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(c.target,b.TEXTURE_MAG_FILTER,c.scaleMode===a.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST)},b.prototype.destroy=function(){this.renderer=null},b}(),em={__proto__:null,FilterSystem:c$,BatchSystem:db,ContextSystem:dd,FramebufferSystem:dg,GeometrySystem:di,MaskSystem:du,ScissorSystem:dt,StencilSystem:ds,ProjectionSystem:dq,RenderTextureSystem:dk,ShaderSystem:df,StateSystem:de,TextureGCSystem:dc,TextureSystem:cW},cU=new m,eo=function(e){function c(g,f){void 0===g&&(g=a.RENDERER_TYPE.UNKNOWN);var c=e.call(this)||this;return f=Object.assign({},b.RENDER_OPTIONS,f),c.options=f,c.type=g,c.screen=new d(0,0,f.width,f.height),c.view=f.view||b.ADAPTER.createCanvas(),c.resolution=f.resolution||b.RESOLUTION,c.useContextAlpha=f.useContextAlpha,c.autoDensity=!!f.autoDensity,c.preserveDrawingBuffer=f.preserveDrawingBuffer,c.clearBeforeRender=f.clearBeforeRender,c._backgroundColor=0,c._backgroundColorRgba=[0,0,0,1],c._backgroundColorString="#000000",c.backgroundColor=f.backgroundColor||c._backgroundColor,c.backgroundAlpha=f.backgroundAlpha,void 0!==f.transparent&&(c.useContextAlpha=f.transparent,c.backgroundAlpha=f.transparent?0:1),c._lastObjectRendered=null,c.plugins={},c}return h(c,e),c.prototype.initPlugins=function(a){for(var b in a)this.plugins[b]=new a[b](this)},Object.defineProperty(c.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),c.prototype.resize=function(c,d){this.view.width=Math.round(c*this.resolution),this.view.height=Math.round(d*this.resolution);var a=this.view.width/this.resolution,b=this.view.height/this.resolution;this.screen.width=a,this.screen.height=b,this.autoDensity&&(this.view.style.width=a+"px",this.view.style.height=b+"px"),this.emit("resize",a,b)},c.prototype.generateTexture=function(c,b,g,a){var e,f,d;return void 0===b&&(b={}),"number"==typeof b&&(b={scaleMode:b,resolution:g,region:a}),e=b.region,f=function(b,e){var d={},a,c;for(a in b)Object.prototype.hasOwnProperty.call(b,a)&&e.indexOf(a)<0&&(d[a]=b[a]);if(null!=b&&"function"==typeof Object.getOwnPropertySymbols){c=0;for(a=Object.getOwnPropertySymbols(b);c<a.length;c++)e.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(b,a[c])&&(d[a[c]]=b[a[c]])}return d}(b,["region"]),0===(a=e||c.getLocalBounds(null,!0)).width&&(a.width=1),0===a.height&&(a.height=1),d=G.create(co({width:a.width,height:a.height},f)),cU.tx=-a.x,cU.ty=-a.y,this.render(c,{renderTexture:d,clear:!1,transform:cU,skipUpdateTransform:!!c.parent}),d},c.prototype.destroy=function(d){var c,b;for(c in this.plugins)this.plugins[c].destroy(),this.plugins[c]=null;d&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),b=this,b.plugins=null,b.type=a.RENDERER_TYPE.UNKNOWN,b.view=null,b.screen=null,b._tempDisplayObjectParent=null,b.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(c.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this._backgroundColorString=bP(a),T(a,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(a){this._backgroundColorRgba[3]=a},enumerable:!1,configurable:!0}),c}(af),hN=function(a){this.buffer=a||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},hH=function(){function a(a){this.renderer=a,this.managedBuffers={},this.boundBufferBases={}}return a.prototype.destroy=function(){this.renderer=null},a.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},a.prototype.bind=function(a){var b=this.gl,c=this.CONTEXT_UID,d=a._glBuffers[c]||this.createGLBuffer(a);b.bindBuffer(a.type,d.buffer)},a.prototype.bindBufferBase=function(a,b){var c=this.gl,d=this.CONTEXT_UID,e;this.boundBufferBases[b]!==a&&(e=a._glBuffers[d]||this.createGLBuffer(a),this.boundBufferBases[b]=a,c.bindBufferBase(c.UNIFORM_BUFFER,b,e.buffer))},a.prototype.bindBufferRange=function(b,d,a){var c=this.gl,e=this.CONTEXT_UID,f;a=a||0,f=b._glBuffers[e]||this.createGLBuffer(b),c.bindBufferRange(c.UNIFORM_BUFFER,d||0,f.buffer,256*a,256)},a.prototype.update=function(a){var b=this.gl,d=this.CONTEXT_UID,c=a._glBuffers[d],e;a._updateID!==c.updateID&&(c.updateID=a._updateID,b.bindBuffer(a.type,c.buffer),c.byteLength>=a.data.byteLength?b.bufferSubData(a.type,0,a.data):(e=a.static?b.STATIC_DRAW:b.DYNAMIC_DRAW,c.byteLength=a.data.byteLength,b.bufferData(a.type,a.data,e)))},a.prototype.dispose=function(a,c){if(this.managedBuffers[a.id]){delete this.managedBuffers[a.id];var b=a._glBuffers[this.CONTEXT_UID],d=this.gl;a.disposeRunner.remove(this),b&&(c||d.deleteBuffer(b.buffer),delete a._glBuffers[this.CONTEXT_UID])}},a.prototype.disposeAll=function(c){for(var b=Object.keys(this.managedBuffers),a=0;a<b.length;a++)this.dispose(this.managedBuffers[b[a]],c)},a.prototype.createGLBuffer=function(a){var b=this.CONTEXT_UID,c=this.gl;return a._glBuffers[b]=new hN(c.createBuffer()),this.managedBuffers[a.id]=a,a.disposeRunner.add(this),a._glBuffers[b]},a}(),cS=function(c){function b(e){var d=c.call(this,a.RENDERER_TYPE.WEBGL,e)||this;return e=d.options,d.gl=null,d.CONTEXT_UID=0,d.runners={destroy:new p("destroy"),contextChange:new p("contextChange"),reset:new p("reset"),update:new p("update"),postrender:new p("postrender"),prerender:new p("prerender"),resize:new p("resize")},d.runners.contextChange.add(d),d.globalUniforms=new J({projectionMatrix:new m},!0),d.addSystem(du,"mask").addSystem(dd,"context").addSystem(de,"state").addSystem(df,"shader").addSystem(cW,"texture").addSystem(hH,"buffer").addSystem(di,"geometry").addSystem(dg,"framebuffer").addSystem(dt,"scissor").addSystem(ds,"stencil").addSystem(dq,"projection").addSystem(dc,"textureGC").addSystem(c$,"filter").addSystem(dk,"renderTexture").addSystem(db,"batch"),d.initPlugins(b.__plugins),d.multisample=void 0,e.context?d.context.initFromContext(e.context):d.context.initFromOptions({alpha:!!d.useContextAlpha,antialias:e.antialias,premultipliedAlpha:d.useContextAlpha&&"notMultiplied"!==d.useContextAlpha,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:d.options.powerPreference}),d.renderingToScreen=!0,fC(2===d.context.webGLVersion?"WebGL 2":"WebGL 1"),d.resize(d.options.width,d.options.height),d}return h(b,c),b.create=function(a){if(fB())return new b(a);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},b.prototype.contextChange=function(){var c,b=this.gl,d;1===this.context.webGLVersion?(d=b.getParameter(b.FRAMEBUFFER_BINDING),b.bindFramebuffer(b.FRAMEBUFFER,null),c=b.getParameter(b.SAMPLES),b.bindFramebuffer(b.FRAMEBUFFER,d)):(d=b.getParameter(b.DRAW_FRAMEBUFFER_BINDING),b.bindFramebuffer(b.DRAW_FRAMEBUFFER,null),c=b.getParameter(b.SAMPLES),b.bindFramebuffer(b.DRAW_FRAMEBUFFER,d)),c>=a.MSAA_QUALITY.HIGH?this.multisample=a.MSAA_QUALITY.HIGH:c>=a.MSAA_QUALITY.MEDIUM?this.multisample=a.MSAA_QUALITY.MEDIUM:c>=a.MSAA_QUALITY.LOW?this.multisample=a.MSAA_QUALITY.LOW:this.multisample=a.MSAA_QUALITY.NONE},b.prototype.addSystem=function(c,a){var b=new c(this),d;if(this[a])throw new Error('Whoops! The name "'+a+'" is already in use');for(d in this[a]=b,this.runners)this.runners[d].add(b);return this},b.prototype.render=function(c,a){var b,d,e,f,g;a&&(a instanceof G?(b=a,d=arguments[2],e=arguments[3],f=arguments[4]):(b=a.renderTexture,d=a.clear,e=a.transform,f=a.skipUpdateTransform)),this.renderingToScreen=!b,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=e,!this.context.isLost&&(b||(this._lastObjectRendered=c),!f&&(g=c.enableTempParent(),c.updateTransform(),c.disableTempParent(g)),this.renderTexture.bind(b),this.batch.currentRenderer.start(),(void 0!==d?d:this.clearBeforeRender)&&this.renderTexture.clear(),c.render(this),this.batch.currentRenderer.flush(),b&&b.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender"))},b.prototype.generateTexture=function(b,a,d,e){void 0===a&&(a={});var f=c.prototype.generateTexture.call(this,b,a,d,e);return this.framebuffer.blit(),f},b.prototype.resize=function(a,b){c.prototype.resize.call(this,a,b),this.runners.resize.emit(this.screen.height,this.screen.width)},b.prototype.reset=function(){return this.runners.reset.emit(),this},b.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},b.prototype.destroy=function(a){for(var b in this.runners.destroy.emit(),this.runners)this.runners[b].destroy();c.prototype.destroy.call(this,a),this.gl=null},Object.defineProperty(b.prototype,"extract",{get:function(){return this.plugins.extract},enumerable:!1,configurable:!0}),b.registerPlugin=function(b,c){A.add({name:b,type:a.ExtensionType.RendererPlugin,ref:c})},b.__plugins={},b}(eo);function es(a){return cS.create(a)}A.handleByMap(a.ExtensionType.RendererPlugin,cS.__plugins),et="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",cR="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",hB=function(){function a(a){this.renderer=a}return a.prototype.destroy=function(){this.renderer=null},a}(),bb=function(){this.texArray=null,this.blend=0,this.type=a.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null},aY=function(){function a(){this.elements=[],this.ids=[],this.count=0}return a.prototype.clear=function(){for(var a=0;a<this.count;a++)this.elements[a]=null;this.count=0},a}(),aW=function(){function a(a){"number"==typeof a?this.rawBinaryData=new ArrayBuffer(a):a instanceof Uint8Array?this.rawBinaryData=a.buffer:this.rawBinaryData=a,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(a.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),a.prototype.view=function(a){return this[a+"View"]},a.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},a.sizeOf=function(a){switch(a){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(a+" isn't a valid view type")}},a}(),ez=function(d){function c(c){var a=d.call(this,c)||this;return a.shaderGenerator=null,a.geometryClass=null,a.vertexSize=null,a.state=K.for2d(),a.size=4*b.SPRITE_BATCH_SIZE,a._vertexCount=0,a._indexCount=0,a._bufferedElements=[],a._bufferedTextures=[],a._bufferSize=0,a._shader=null,a._packedGeometries=[],a._packedGeometryPoolSize=2,a._flushId=0,a._aBuffers={},a._iBuffers={},a.MAX_TEXTURES=1,a.renderer.on("prerender",a.onPrerender,a),c.runners.contextChange.add(a),a._dcIndex=0,a._aIndex=0,a._iIndex=0,a._attributeBuffer=null,a._indexBuffer=null,a._tempBoundTextures=[],a}return h(c,d),c.prototype.contextChange=function(){var c=this.renderer.gl,d;b.PREFER_ENV===a.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=er(this.MAX_TEXTURES,c)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(d=0;d<this._packedGeometryPoolSize;d++)this._packedGeometries[d]=new this.geometryClass;this.initFlushBuffers()},c.prototype.initFlushBuffers=function(){for(var b=c._drawCallPool,d=c._textureArrayPool,e=this.size/4,f=Math.floor(e/this.MAX_TEXTURES)+1,a;b.length<e;)b.push(new bb);for(;d.length<f;)d.push(new aY);for(a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},c.prototype.onPrerender=function(){this._flushId=0},c.prototype.render=function(a){a._texture.valid&&(this._vertexCount+a.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=a.vertexData.length/2,this._indexCount+=a.indices.length,this._bufferedTextures[this._bufferSize]=a._texture.baseTexture,this._bufferedElements[this._bufferSize++]=a)},c.prototype.buildTexturesAndDrawCalls=function(){var k=this._bufferedTextures,g=this.MAX_TEXTURES,m=c._textureArrayPool,i=this.renderer.batch,f=this._tempBoundTextures,n=this.renderer.textureGC.count,d=++e._globalBatch,l=0,b=m[0],j=0,a,h;i.copyBoundTextures(f,g);for(a=0;a<this._bufferSize;++a)h=k[a],k[a]=null,h._batchEnabled!==d&&(b.count>=g&&(i.boundArray(b,f,d,g),this.buildDrawCalls(b,j,a),j=a,b=m[++l],++d),h._batchEnabled=d,h.touched=n,b.elements[b.count++]=h);for(b.count>0&&(i.boundArray(b,f,d,g),this.buildDrawCalls(b,j,this._bufferSize),++l,++d),a=0;a<f.length;a++)f[a]=null;e._globalBatch=d},c.prototype.buildDrawCalls=function(m,g,j){var f=this,l=f._bufferedElements,q=f._attributeBuffer,p=f._indexBuffer,o=f.vertexSize,k=c._drawCallPool,h=this._dcIndex,i=this._aIndex,b=this._iIndex,a=k[h],d,e,r,n;a.start=this._iIndex,a.texArray=m;for(d=g;d<j;++d)e=l[d],r=e._texture.baseTexture,n=bN[r.alphaMode?1:0][e.blendMode],l[d]=null,g<d&&a.blend!==n&&(a.size=b-a.start,g=d,(a=k[++h]).texArray=m,a.start=b),this.packInterleavedGeometry(e,q,p,i,b),i+=e.vertexData.length/2*o,b+=e.indices.length,a.blend=n;g<j&&(a.size=b-a.start,++h),this._dcIndex=h,this._aIndex=i,this._iIndex=b},c.prototype.bindAndClearTexArray=function(a){for(var c=this.renderer.texture,b=0;b<a.count;b++)c.bind(a.elements[b],a.ids[b]),a.elements[b]=null;a.count=0},c.prototype.updateGeometry=function(){var c=this,a=c._packedGeometries,d=c._attributeBuffer,e=c._indexBuffer;b.CAN_UPLOAD_SAME_BUFFER?(a[this._flushId]._buffer.update(d.rawBinaryData),a[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,a[this._flushId]=new this.geometryClass),a[this._flushId]._buffer.update(d.rawBinaryData),a[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(a[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},c.prototype.drawBatches=function(){for(var h=this._dcIndex,e=this.renderer,f=e.gl,j=e.state,i=c._drawCallPool,g=null,b=0,a,d,k,l,m,n;b<h;b++)a=i[b],d=a.texArray,k=a.type,l=a.size,m=a.start,n=a.blend,g!==d&&(g=d,this.bindAndClearTexArray(d)),this.state.blendMode=n,j.set(this.state),f.drawElements(k,l,f.UNSIGNED_SHORT,2*m)},c.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},c.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},c.prototype.stop=function(){this.flush()},c.prototype.destroy=function(){for(var a=0;a<this._packedGeometryPoolSize;a++)this._packedGeometries[a]&&this._packedGeometries[a].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),d.prototype.destroy.call(this)},c.prototype.getAttributeBuffer=function(e){var c=aK(Math.ceil(e/8)),d=bH(c),a=8*c,b;return this._aBuffers.length<=d&&(this._iBuffers.length=d+1),b=this._aBuffers[a],b||(this._aBuffers[a]=b=new aW(a*this.vertexSize*4)),b},c.prototype.getIndexBuffer=function(d){var c=aK(Math.ceil(d/12)),a=bH(c),e=12*c,b;return this._iBuffers.length<=a&&(this._iBuffers.length=a+1),b=this._iBuffers[a],b||(this._iBuffers[a]=b=new Uint16Array(e)),b},c.prototype.packInterleavedGeometry=function(b,h,j,c,m){for(var k=h.uint32View,d=h.float32View,o=c/this.vertexSize,i=b.uvs,g=b.indices,f=b.vertexData,l=b._texture.baseTexture._batchLocation,e=Math.min(b.worldAlpha,1),n=e<1&&b._texture.baseTexture.alphaMode?bg(b._tintRGB,e):b._tintRGB+(255*e<<24),a=0;a<f.length;a+=2)d[c++]=f[a],d[c++]=f[a+1],d[c++]=i[a],d[c++]=i[a+1],k[c++]=n,d[c++]=l;for(a=0;a<g.length;a++)j[m++]=o+g[a]},c._drawCallPool=[],c._textureArrayPool=[],c}(aF),eA=function(){function a(b,a){if(this.vertexSrc=b,this.fragTemplate=a,this.programCache={},this.defaultGroupCache={},a.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(a.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return a.prototype.generateShader=function(a){var d,b,c,e;if(!this.programCache[a]){for(d=new Int32Array(a),b=0;b<a;b++)d[b]=b;this.defaultGroupCache[a]=J.from({uSamplers:d},!0),c=this.fragTemplate,c=(c=c.replace(/%count%/gi,""+a)).replace(/%forloop%/gi,this.generateSampleSrc(a)),this.programCache[a]=new al(this.vertexSrc,c)}return e={tint:new Float32Array([1,1,1,1]),translationMatrix:new m,default:this.defaultGroupCache[a]},new D(this.programCache[a],e)},a.prototype.generateSampleSrc=function(c){var a="",b;a+="\n",a+="\n";for(b=0;b<c;b++)b>0&&(a+="\nelse "),b<c-1&&(a+="if(vTextureId < "+b+".5)"),a+="\n{",a+="\n	color = texture2D(uSamplers["+b+"], vTextureCoord);",a+="\n}";return(a+="\n")+"\n"},a}(),cL=function(b){function c(d){void 0===d&&(d=!1);var c=b.call(this)||this;return c._buffer=new n(null,d,!1),c._indexBuffer=new n(null,d,!0),c.addAttribute("aVertexPosition",c._buffer,2,!1,a.TYPES.FLOAT).addAttribute("aTextureCoord",c._buffer,2,!1,a.TYPES.FLOAT).addAttribute("aColor",c._buffer,4,!0,a.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",c._buffer,1,!0,a.TYPES.FLOAT).addIndex(c._indexBuffer),c}return h(c,b),c}(an),eC="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",eD="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",eE=function(){function a(){}return a.create=function(b){var a=Object.assign({vertex:eC,fragment:eD,geometryClass:cL,vertexSize:6},b),c=a.vertex,d=a.fragment,e=a.vertexSize,f=a.geometryClass;return function(a){function b(g){var b=a.call(this,g)||this;return b.shaderGenerator=new eA(c,d),b.geometryClass=f,b.vertexSize=e,b}return h(b,a),b}(ez)},Object.defineProperty(a,"defaultVertexSrc",{get:function(){return eC},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentTemplate",{get:function(){return eD},enumerable:!1,configurable:!0}),a}(),cH=eE.create(),Object.assign(cH,{extension:{name:"batch",type:a.ExtensionType.RendererPlugin}}),eG={},hx=function(a){Object.defineProperty(eG,a,{get:function(){return eN[a]}})};for(cD in eN)hx(cD);eJ={},hu=function(a){Object.defineProperty(eJ,a,{get:function(){return em[a]}})};for(cD in em)hu(cD);eh={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1},k.mixin(eh),eM=function(){function b(b){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(s.tablet||s.phone)&&this.createTouchHook();var a=document.createElement("div");a.style.width="100px",a.style.height="100px",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.zIndex=2..toString(),this.div=a,this.renderer=b,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(b.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),b.prototype.createTouchHook=function(){var b=this,a=document.createElement("button");a.style.width="1px",a.style.height="1px",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.style.zIndex=2..toString(),a.style.backgroundColor="#FF0000",a.title="select to enable accessibility for this content",a.addEventListener("focus",function(){b._isMobileAccessibility=!0,b.activate(),b.destroyTouchHook()}),document.body.appendChild(a),this._hookDiv=a},b.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},b.prototype.activate=function(){var a;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(a=this.renderer.view.parentNode)||void 0===a||a.appendChild(this.div))},b.prototype.deactivate=function(){var a;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(a=this.div.parentNode)||void 0===a||a.removeChild(this.div))},b.prototype.updateAccessibleObjects=function(a){var b,c;if(a.visible&&a.accessibleChildren)if(a.accessible&&a.interactive&&(a._accessibleActive||this.addChild(a),a.renderId=this.renderId),b=a.children,b)for(c=0;c<b.length;c++)this.updateAccessibleObjects(b[c])},b.prototype.update=function(){var m=performance.now(),g,q,p,o,n,i,j,l,k,h,f,a,e,b,c,d;if(!(s.android.device&&m<this.androidUpdateCount)&&(this.androidUpdateCount=m+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered),g=this.renderer.view.getBoundingClientRect(),q=g.left,p=g.top,o=g.width,n=g.height,i=this.renderer,j=i.width,l=i.height,k=i.resolution,h=o/j*k,f=n/l*k,a=this.div,a.style.left=q+"px",a.style.top=p+"px",a.style.width=j+"px",a.style.height=l+"px";for(e=0;e<this.children.length;e++)b=this.children[e],b.renderId!==this.renderId?(b._accessibleActive=!1,_(this.children,e,1),this.div.removeChild(b._accessibleDiv),this.pool.push(b._accessibleDiv),b._accessibleDiv=null,e--):(a=b._accessibleDiv,c=b.hitArea,d=b.worldTransform,b.hitArea?(a.style.left=(d.tx+c.x*d.a)*h+"px",a.style.top=(d.ty+c.y*d.d)*f+"px",a.style.width=c.width*d.a*h+"px",a.style.height=c.height*d.d*f+"px"):(c=b.getBounds(),this.capHitArea(c),a.style.left=c.x*h+"px",a.style.top=c.y*f+"px",a.style.width=c.width*h+"px",a.style.height=c.height*f+"px",a.title!==b.accessibleTitle&&null!==b.accessibleTitle&&(a.title=b.accessibleTitle),a.getAttribute("aria-label")!==b.accessibleHint&&null!==b.accessibleHint&&a.setAttribute("aria-label",b.accessibleHint)),b.accessibleTitle===a.title&&b.tabIndex===a.tabIndex||(a.title=b.accessibleTitle,a.tabIndex=b.tabIndex,this.debug&&this.updateDebugHTML(a)));this.renderId++}},b.prototype.updateDebugHTML=function(a){a.innerHTML="type: "+a.type+"</br> title : "+a.title+"</br> tabIndex: "+a.tabIndex},b.prototype.capHitArea=function(a){a.x<0&&(a.width+=a.x,a.x=0),a.y<0&&(a.height+=a.y,a.y=0);var b=this.renderer,c=b.width,d=b.height;a.x+a.width>c&&(a.width=c-a.x),a.y+a.height>d&&(a.height=d-a.y)},b.prototype.addChild=function(b){var a=this.pool.pop();a||((a=document.createElement("button")).style.width="100px",a.style.height="100px",a.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",a.style.position="absolute",a.style.zIndex=2..toString(),a.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?a.setAttribute("aria-live","off"):a.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?a.setAttribute("aria-relevant","additions"):a.setAttribute("aria-relevant","text"),a.addEventListener("click",this._onClick.bind(this)),a.addEventListener("focus",this._onFocus.bind(this)),a.addEventListener("focusout",this._onFocusOut.bind(this))),a.style.pointerEvents=b.accessiblePointerEvents,a.type=b.accessibleType,b.accessibleTitle&&null!==b.accessibleTitle?a.title=b.accessibleTitle:b.accessibleHint&&null!==b.accessibleHint||(a.title="displayObject "+b.tabIndex),b.accessibleHint&&null!==b.accessibleHint&&a.setAttribute("aria-label",b.accessibleHint),this.debug&&this.updateDebugHTML(a),b._accessibleActive=!0,b._accessibleDiv=a,a.displayObject=b,this.children.push(b),this.div.appendChild(b._accessibleDiv),b._accessibleDiv.tabIndex=b.tabIndex},b.prototype._onClick=function(d){var a=this.renderer.plugins.interaction,b=d.target.displayObject,c=a.eventData;a.dispatchEvent(b,"click",c),a.dispatchEvent(b,"pointertap",c),a.dispatchEvent(b,"tap",c)},b.prototype._onFocus=function(a){a.target.getAttribute("aria-live")||a.target.setAttribute("aria-live","assertive");var b=this.renderer.plugins.interaction,c=a.target.displayObject,d=b.eventData;b.dispatchEvent(c,"mouseover",d)},b.prototype._onFocusOut=function(a){a.target.getAttribute("aria-live")||a.target.setAttribute("aria-live","polite");var b=this.renderer.plugins.interaction,c=a.target.displayObject,d=b.eventData;b.dispatchEvent(c,"mouseout",d)},b.prototype._onKeyDown=function(a){9===a.keyCode&&this.activate()},b.prototype._onMouseMove=function(a){0===a.movementX&&0===a.movementY||this.deactivate()},b.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},b.extension={name:"accessibility",type:[a.ExtensionType.RendererPlugin,a.ExtensionType.CanvasRendererPlugin]},b}(),cC=function(){function a(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(a.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),a.prototype.getLocalPosition=function(a,b,c){return a.worldTransform.applyInverse(c||this.global,b)},a.prototype.copyEvent=function(a){"isPrimary"in a&&a.isPrimary&&(this.isPrimary=!0),this.button="button"in a&&a.button;var b="buttons"in a&&a.buttons;this.buttons=Number.isInteger(b)?b:"which"in a&&a.which,this.width="width"in a&&a.width,this.height="height"in a&&a.height,this.tiltX="tiltX"in a&&a.tiltX,this.tiltY="tiltY"in a&&a.tiltY,this.pointerType="pointerType"in a&&a.pointerType,this.pressure="pressure"in a&&a.pressure,this.rotationAngle="rotationAngle"in a&&a.rotationAngle,this.twist="twist"in a&&a.twist||0,this.tangentialPressure="tangentialPressure"in a&&a.tangentialPressure||0},a.prototype.reset=function(){this.isPrimary=!1},a}(),cr=function(a,b){return cr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])},cr(a,b)},eP=function(){function a(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return a.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},a.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},a}(),bA=function(){function a(b){this._pointerId=b,this._flags=a.FLAGS.NONE}return a.prototype._doSet=function(a,b){this._flags=b?this._flags|a:this._flags&~a},Object.defineProperty(a.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"flags",{get:function(){return this._flags},set:function(a){this._flags=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"none",{get:function(){return this._flags===a.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"over",{get:function(){return 0!=(this._flags&a.FLAGS.OVER)},set:function(b){this._doSet(a.FLAGS.OVER,b)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rightDown",{get:function(){return 0!=(this._flags&a.FLAGS.RIGHT_DOWN)},set:function(b){this._doSet(a.FLAGS.RIGHT_DOWN,b)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"leftDown",{get:function(){return 0!=(this._flags&a.FLAGS.LEFT_DOWN)},set:function(b){this._doSet(a.FLAGS.LEFT_DOWN,b)},enumerable:!1,configurable:!0}),a.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),a}(),hr=function(){function a(){this._tempPoint=new g}return a.prototype.recursiveFindHit=function(c,a,h,b,e){var f,g,d,i,l,j,m,k,n,o;if(!a||!a.visible)return!1;if(g=c.data.global,d=!1,i=e=a.interactive||e,l=!0,a.hitArea?(b&&(a.worldTransform.applyInverse(g,this._tempPoint),a.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?d=!0:(b=!1,l=!1)),i=!1):a._mask&&b&&(j=a._mask.isMaskData?a._mask.maskObject:a._mask,j&&!(null===(f=j.containsPoint)||void 0===f?void 0:f.call(j,g))&&(b=!1)),l&&a.interactiveChildren&&a.children)for(m=a.children,k=m.length-1;k>=0;k--)if(n=m[k],o=this.recursiveFindHit(c,n,h,b,i),o){if(!n.parent)continue;i=!1,o&&(c.target&&(b=!1),d=!0)}return e&&(b&&!c.target&&!a.hitArea&&a.containsPoint&&a.containsPoint(g)&&(d=!0),a.interactive&&(d&&!c.target&&(c.target=a),h&&h(c,a,!!d))),d},a.prototype.findHit=function(a,b,c,d){this.recursiveFindHit(a,b,c,d,!1)},a}(),eS={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(a){a?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0},k.mixin(eS),bw={target:null,data:{global:null}},eU=function(c){function b(d,b){var a=c.call(this)||this;return b=b||{},a.renderer=d,a.autoPreventDefault=void 0===b.autoPreventDefault||b.autoPreventDefault,a.interactionFrequency=b.interactionFrequency||10,a.mouse=new cC,a.mouse.identifier=1,a.mouse.global.set(-999999),a.activeInteractionData={},a.activeInteractionData[1]=a.mouse,a.interactionDataPool=[],a.eventData=new eP,a.interactionDOMElement=null,a.moveWhenInside=!1,a.eventsAdded=!1,a.tickerAdded=!1,a.mouseOverRenderer=!("PointerEvent"in globalThis),a.supportsTouchEvents="ontouchstart"in globalThis,a.supportsPointerEvents=!!globalThis.PointerEvent,a.onPointerUp=a.onPointerUp.bind(a),a.processPointerUp=a.processPointerUp.bind(a),a.onPointerCancel=a.onPointerCancel.bind(a),a.processPointerCancel=a.processPointerCancel.bind(a),a.onPointerDown=a.onPointerDown.bind(a),a.processPointerDown=a.processPointerDown.bind(a),a.onPointerMove=a.onPointerMove.bind(a),a.processPointerMove=a.processPointerMove.bind(a),a.onPointerOut=a.onPointerOut.bind(a),a.processPointerOverOut=a.processPointerOverOut.bind(a),a.onPointerOver=a.onPointerOver.bind(a),a.cursorStyles={default:"inherit",pointer:"pointer"},a.currentCursorMode=null,a.cursor=null,a.resolution=1,a.delayedEvents=[],a.search=new hr,a._tempDisplayObject=new ca,a._eventListenerOptions={capture:!0,passive:!1},a._useSystemTicker=void 0===b.useSystemTicker||b.useSystemTicker,a.setTargetElement(a.renderer.view,a.renderer.resolution),a}return function(b,a){function c(){this.constructor=b}cr(b,a),b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}(b,c),Object.defineProperty(b.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(a){this._useSystemTicker=a,a?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),b.prototype.hitTest=function(b,a){return bw.target=null,bw.data.global=b,a||(a=this.lastObjectRendered),this.processInteractive(bw,a,null,!0),bw.target},b.prototype.setTargetElement=function(b,a){void 0===a&&(a=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=b,this.resolution=a,this.addEvents(),this.addTickerListener()},b.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(o.system.add(this.tickerUpdate,this,a.UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},b.prototype.removeTickerListener=function(){this.tickerAdded&&(o.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},b.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var a=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(a.msContentZooming="none",a.msTouchAction="none"):this.supportsPointerEvents&&(a.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},b.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var a=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(a.msContentZooming="",a.msTouchAction=""):this.supportsPointerEvents&&(a.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},b.prototype.tickerUpdate=function(a){this._deltaTime+=a,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},b.prototype.update=function(){var b,a,c;if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(b in this.cursor=null,this.activeInteractionData)this.activeInteractionData.hasOwnProperty(b)&&(a=this.activeInteractionData[b],a.originalEvent&&"touch"!==a.pointerType&&(c=this.configureInteractionEventForDOMEvent(this.eventData,a.originalEvent,a),this.processInteractive(c,this.lastObjectRendered,this.processPointerOverOut,!0)));this.setCursorMode(this.cursor)}},b.prototype.setCursorMode=function(a){var c,b;if(a=a||"default",c=!0,globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(c=!1),this.currentCursorMode!==a)if(this.currentCursorMode=a,b=this.cursorStyles[a],b)switch(typeof b){case"string":c&&(this.interactionDOMElement.style.cursor=b);break;case"function":b(a);break;case"object":c&&Object.assign(this.interactionDOMElement.style,b)}else c&&"string"==typeof a&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,a)&&(this.interactionDOMElement.style.cursor=a)},b.prototype.dispatchEvent=function(b,c,a){a.stopPropagationHint&&b!==a.stopsPropagatingAt||(a.currentTarget=b,a.type=c,b.emit(c,a),b[c]&&b[c](a))},b.prototype.delayDispatchEvent=function(a,b,c){this.delayedEvents.push({displayObject:a,eventString:b,eventData:c})},b.prototype.mapPositionToPoint=function(b,d,e){var a=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0},c=1/this.resolution;b.x=(d-a.left)*(this.interactionDOMElement.width/a.width)*c,b.y=(e-a.top)*(this.interactionDOMElement.height/a.height)*c},b.prototype.processInteractive=function(e,i,j,k){var g=this.search.findHit(e,i,j,k),c=this.delayedEvents,h,a,b,f,l,d;if(!c.length)return g;e.stopPropagationHint=!1,h=c.length,this.delayedEvents=[];for(a=0;a<h;a++)b=c[a],f=b.displayObject,l=b.eventString,d=b.eventData,d.stopsPropagatingAt===f&&(d.stopPropagationHint=!0),this.dispatchEvent(f,l,d);return g},b.prototype.onPointerDown=function(b){var d,f,e,a,g,c,h;if(!this.supportsTouchEvents||"touch"!==b.pointerType){d=this.normalizeToPointerData(b),this.autoPreventDefault&&d[0].isNormalized&&(b.cancelable||!("cancelable"in b))&&b.preventDefault();for(f=d.length,e=0;e<f;e++)a=d[e],g=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,g),(c.data.originalEvent=b,this.processInteractive(c,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",c),"touch"===a.pointerType)?this.emit("touchstart",c):("mouse"===a.pointerType||"pen"===a.pointerType)&&(h=2===a.button,this.emit(h?"rightdown":"mousedown",this.eventData))}},b.prototype.processPointerDown=function(b,a,f){var d=b.data,c=b.data.identifier,e;f&&(a.trackedPointers[c]||(a.trackedPointers[c]=new bA(c)),this.dispatchEvent(a,"pointerdown",b),"touch"===d.pointerType?this.dispatchEvent(a,"touchstart",b):("mouse"===d.pointerType||"pen"===d.pointerType)&&(e=2===d.button,e?a.trackedPointers[c].rightDown=!0:a.trackedPointers[c].leftDown=!0,this.dispatchEvent(a,e?"rightdown":"mousedown",b)))},b.prototype.onPointerComplete=function(b,e,i){var g=this.normalizeToPointerData(b),k=g.length,h=b.target,d,f,a,j,c,l;b.composedPath&&b.composedPath().length>0&&(h=b.composedPath()[0]);for(d=h!==this.interactionDOMElement?"outside":"",f=0;f<k;f++)a=g[f],j=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,j),(c.data.originalEvent=b,this.processInteractive(c,this.lastObjectRendered,i,e||!d),this.emit(e?"pointercancel":"pointerup"+d,c),"mouse"===a.pointerType||"pen"===a.pointerType)?(l=2===a.button,this.emit(l?"rightup"+d:"mouseup"+d,c)):"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+d,c),this.releaseInteractionDataForPointerId(a.pointerId))},b.prototype.onPointerCancel=function(a){this.supportsTouchEvents&&"touch"===a.pointerType||this.onPointerComplete(a,!0,this.processPointerCancel)},b.prototype.processPointerCancel=function(a,b){var d=a.data,c=a.data.identifier;void 0!==b.trackedPointers[c]&&(delete b.trackedPointers[c],this.dispatchEvent(b,"pointercancel",a),"touch"===d.pointerType&&this.dispatchEvent(b,"touchcancel",a))},b.prototype.onPointerUp=function(a){this.supportsTouchEvents&&"touch"===a.pointerType||this.onPointerComplete(a,!1,this.processPointerUp)},b.prototype.processPointerUp=function(b,a,j){var e=b.data,g=b.data.identifier,c=a.trackedPointers[g],f="touch"===e.pointerType,h="mouse"===e.pointerType||"pen"===e.pointerType,i=!1,d,k,m,l;h&&(d=2===e.button,k=bA.FLAGS,m=d?k.RIGHT_DOWN:k.LEFT_DOWN,l=void 0!==c&&c.flags&m,j?(this.dispatchEvent(a,d?"rightup":"mouseup",b),l&&(this.dispatchEvent(a,d?"rightclick":"click",b),i=!0)):l&&this.dispatchEvent(a,d?"rightupoutside":"mouseupoutside",b),c&&(d?c.rightDown=!1:c.leftDown=!1)),j?(this.dispatchEvent(a,"pointerup",b),f&&this.dispatchEvent(a,"touchend",b),c&&(h&&!i||this.dispatchEvent(a,"pointertap",b),f&&(this.dispatchEvent(a,"tap",b),c.over=!1))):c&&(this.dispatchEvent(a,"pointerupoutside",b),f&&this.dispatchEvent(a,"touchendoutside",b)),c&&c.none&&delete a.trackedPointers[g]},b.prototype.onPointerMove=function(e){var b,f,d,c,g,a;if(!this.supportsTouchEvents||"touch"!==e.pointerType){b=this.normalizeToPointerData(e),"mouse"!==b[0].pointerType&&"pen"!==b[0].pointerType||(this._didMove=!0,this.cursor=null);for(f=b.length,d=0;d<f;d++)c=b[d],g=this.getInteractionDataForPointerId(c),a=this.configureInteractionEventForDOMEvent(this.eventData,c,g),a.data.originalEvent=e,this.processInteractive(a,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",a),"touch"===c.pointerType&&this.emit("touchmove",a),"mouse"!==c.pointerType&&"pen"!==c.pointerType||this.emit("mousemove",a);"mouse"===b[0].pointerType&&this.setCursorMode(this.cursor)}},b.prototype.processPointerMove=function(a,b,d){var c=a.data,f="touch"===c.pointerType,e="mouse"===c.pointerType||"pen"===c.pointerType;e&&this.processPointerOverOut(a,b,d),this.moveWhenInside&&!d||(this.dispatchEvent(b,"pointermove",a),f&&this.dispatchEvent(b,"touchmove",a),e&&this.dispatchEvent(b,"mousemove",a))},b.prototype.onPointerOut=function(d){var a,c,b;(!this.supportsTouchEvents||"touch"!==d.pointerType)&&(a=this.normalizeToPointerData(d)[0],"mouse"===a.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null)),c=this.getInteractionDataForPointerId(a),b=this.configureInteractionEventForDOMEvent(this.eventData,a,c),b.data.originalEvent=a,this.processInteractive(b,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",b),"mouse"===a.pointerType||"pen"===a.pointerType?this.emit("mouseout",b):this.releaseInteractionDataForPointerId(c.identifier))},b.prototype.processPointerOverOut=function(c,b,f){var g=c.data,d=c.data.identifier,e="mouse"===g.pointerType||"pen"===g.pointerType,a=b.trackedPointers[d];f&&!a&&(a=b.trackedPointers[d]=new bA(d)),void 0!==a&&(f&&this.mouseOverRenderer?(a.over||(a.over=!0,this.delayDispatchEvent(b,"pointerover",c),e&&this.delayDispatchEvent(b,"mouseover",c)),e&&null===this.cursor&&(this.cursor=b.cursor)):a.over&&(a.over=!1,this.dispatchEvent(b,"pointerout",this.eventData),e&&this.dispatchEvent(b,"mouseout",c),a.none&&delete b.trackedPointers[d]))},b.prototype.onPointerOver=function(c){if(!this.supportsTouchEvents||"touch"!==c.pointerType){var a=this.normalizeToPointerData(c)[0],d=this.getInteractionDataForPointerId(a),b=this.configureInteractionEventForDOMEvent(this.eventData,a,d);b.data.originalEvent=a,"mouse"===a.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",b),"mouse"!==a.pointerType&&"pen"!==a.pointerType||this.emit("mouseover",b)}},b.prototype.getInteractionDataForPointerId=function(c){var a,b=c.pointerId;return 1===b||"mouse"===c.pointerType?a=this.mouse:this.activeInteractionData[b]?a=this.activeInteractionData[b]:((a=this.interactionDataPool.pop()||new cC).identifier=b,this.activeInteractionData[b]=a),a.copyEvent(c),a},b.prototype.releaseInteractionDataForPointerId=function(b){var a=this.activeInteractionData[b];a&&(delete this.activeInteractionData[b],a.reset(),this.interactionDataPool.push(a))},b.prototype.configureInteractionEventForDOMEvent=function(c,a,b){return c.data=b,this.mapPositionToPoint(b.global,a.clientX,a.clientY),"touch"===a.pointerType&&(a.globalX=b.global.x,a.globalY=b.global.y),b.originalEvent=a,c.reset(),c},b.prototype.normalizeToPointerData=function(c){var d=[],e,f,a,b;if(this.supportsTouchEvents&&c instanceof TouchEvent)for(e=0,f=c.changedTouches.length;e<f;e++)a=c.changedTouches[e],void 0===a.button&&(a.button=c.touches.length?1:0),void 0===a.buttons&&(a.buttons=c.touches.length?1:0),void 0===a.isPrimary&&(a.isPrimary=1===c.touches.length&&"touchstart"===c.type),void 0===a.width&&(a.width=a.radiusX||1),void 0===a.height&&(a.height=a.radiusY||1),void 0===a.tiltX&&(a.tiltX=0),void 0===a.tiltY&&(a.tiltY=0),void 0===a.pointerType&&(a.pointerType="touch"),void 0===a.pointerId&&(a.pointerId=a.identifier||0),void 0===a.pressure&&(a.pressure=a.force||.5),void 0===a.twist&&(a.twist=0),void 0===a.tangentialPressure&&(a.tangentialPressure=0),void 0===a.layerX&&(a.layerX=a.offsetX=a.clientX),void 0===a.layerY&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,d.push(a);else!globalThis.MouseEvent||c instanceof MouseEvent&&!(this.supportsPointerEvents&&c instanceof globalThis.PointerEvent)?(b=c,void 0===b.isPrimary&&(b.isPrimary=!0),void 0===b.width&&(b.width=1),void 0===b.height&&(b.height=1),void 0===b.tiltX&&(b.tiltX=0),void 0===b.tiltY&&(b.tiltY=0),void 0===b.pointerType&&(b.pointerType="mouse"),void 0===b.pointerId&&(b.pointerId=1),void 0===b.pressure&&(b.pressure=.5),void 0===b.twist&&(b.twist=0),void 0===b.tangentialPressure&&(b.tangentialPressure=0),b.isNormalized=!0,d.push(b)):d.push(c);return d},b.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},b.extension={name:"interaction",type:[a.ExtensionType.RendererPlugin,a.ExtensionType.CanvasRendererPlugin]},b}(af),eV=new d,eW=function(){function b(a){this.renderer=a}return b.prototype.image=function(b,c,d){var a=new Image;return a.src=this.base64(b,c,d),a},b.prototype.base64=function(a,b,c){return this.canvas(a).toDataURL(b,c)},b.prototype.canvas=function(i,a){var e,d,f=this.renderer,j=!1,m=!1,h,g,c,n,k,o,l;return i&&(i instanceof G?d=i:(d=this.renderer.generateTexture(i),m=!0)),d?(e=d.baseTexture.resolution,a=null!=a?a:d.frame,j=!1,f.renderTexture.bind(d)):(e=f.resolution,a||((a=eV).width=f.width,a.height=f.height),j=!0,f.renderTexture.bind(null)),h=Math.round(a.width*e),g=Math.round(a.height*e),c=new bF(h,g,1),n=new Uint8Array(4*h*g),k=f.gl,k.readPixels(Math.round(a.x*e),Math.round(a.y*e),h,g,k.RGBA,k.UNSIGNED_BYTE,n),o=c.context.getImageData(0,0,h,g),(b.arrayPostDivide(n,o.data),c.context.putImageData(o,0,0),j)&&(l=new bF(c.width,c.height,1),l.context.scale(1,-1),l.context.drawImage(c.canvas,0,-g),c.destroy(),c=l),m&&d.destroy(!0),c.canvas},b.prototype.pixels=function(f,a){var d,c,e=this.renderer,i=!1,j,k,g,h;return f&&(f instanceof G?c=f:(c=this.renderer.generateTexture(f),i=!0)),c?(d=c.baseTexture.resolution,a=null!=a?a:c.frame,e.renderTexture.bind(c)):(d=e.resolution,a||((a=eV).width=e.width,a.height=e.height),e.renderTexture.bind(null)),j=Math.round(a.width*d),k=Math.round(a.height*d),g=new Uint8Array(4*j*k),h=e.gl,h.readPixels(Math.round(a.x*d),Math.round(a.y*d),j,k,h.RGBA,h.UNSIGNED_BYTE,g),i&&c.destroy(!0),b.arrayPostDivide(g,g),g},b.prototype.destroy=function(){this.renderer=null},b.arrayPostDivide=function(b,c){for(var a=0,d;a<b.length;a+=4)d=c[a+3]=b[a+3],0!==d?(c[a]=Math.round(Math.min(255*b[a]/d,255)),c[a+1]=Math.round(Math.min(255*b[a+1]/d,255)),c[a+2]=Math.round(Math.min(255*b[a+2]/d,255))):(c[a]=b[a],c[a+1]=b[a+1],c[a+2]=b[a+2])},b.extension={name:"extract",type:a.ExtensionType.RendererPlugin},b}(),aX=function(){function a(b,a,c){void 0===a&&(a=!1),this._fn=b,this._once=a,this._thisArg=c,this._next=this._prev=this._owner=null}return a.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},a}();function eY(a,b){return a._head?(a._tail._next=b,b._prev=a._tail,a._tail=b):(a._head=b,a._tail=b),b._owner=a,b}E=function(){function a(){this._head=this._tail=void 0}return a.prototype.handlers=function(b){var a,c;if(void 0===b&&(b=!1),a=this._head,b)return!!a;for(c=[];a;)c.push(a),a=a._next;return c},a.prototype.has=function(a){if(!(a instanceof aX))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return a._owner===this},a.prototype.dispatch=function(){for(var d=arguments,c=[],b=0,a;b<arguments.length;b++)c[b]=d[b];if(a=this._head,!a)return!1;for(;a;)a._once&&this.detach(a),a._fn.apply(a._thisArg,c),a=a._next;return!0},a.prototype.add=function(b,a){if(void 0===a&&(a=null),"function"!=typeof b)throw new Error("MiniSignal#add(): First arg must be a Function.");return eY(this,new aX(b,!1,a))},a.prototype.once=function(b,a){if(void 0===a&&(a=null),"function"!=typeof b)throw new Error("MiniSignal#once(): First arg must be a Function.");return eY(this,new aX(b,!0,a))},a.prototype.detach=function(a){if(!(a instanceof aX))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return a._owner!==this||(a._prev&&(a._prev._next=a._next),a._next&&(a._next._prev=a._prev),a===this._head?(this._head=a._next,null===a._next&&(this._tail=null)):a===this._tail&&(this._tail=a._prev,this._tail._next=null),a._owner=null),this},a.prototype.detachAll=function(){var a=this._head;if(!a)return this;for(this._head=this._tail=null;a;)a._owner=null,a=a._next;return this},a}();function e$(e,c){c=c||{};for(var a={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},f=a.parser[c.strictMode?"strict":"loose"].exec(e),b={},d=14;d--;)b[a.key[d]]=f[d]||"";return b[a.q.name]={},b[a.key[12]].replace(a.q.parser,function(e,c,d){c&&(b[a.q.name][c]=d)}),b}bh=null;function fb(){}function fc(b,a,c){a&&0===a.indexOf(".")&&(a=a.substring(1)),a&&(b[a]=c)}function bJ(a){return a.toString().replace("object ","")}function Q(){}function hp(a){return function(){for(var d=arguments,c=[],b=0,e;b<arguments.length;b++)c[b]=d[b];if(null===a)throw new Error("Callback was already called.");e=a,a=null,e.apply(this,c)}}a.LoaderResource=function(){function a(d,c,b){if(this._dequeue=fb,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof d||"string"!=typeof c)throw new Error("Both name and url are required for constructing a resource.");b=b||{},this._flags=0,this._setFlag(a.STATUS_FLAGS.DATA_URL,0===c.indexOf("data:")),this.name=d,this.url=c,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===b.crossOrigin?"anonymous":b.crossOrigin,this.timeout=b.timeout||0,this.loadType=b.loadType||this._determineLoadType(),this.xhrType=b.xhrType,this.metadata=b.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=a.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=fb,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new E,this.onProgress=new E,this.onComplete=new E,this.onAfterMiddleware=new E}return a.setExtensionLoadType=function(b,c){fc(a._loadTypeMap,b,c)},a.setExtensionXhrType=function(b,c){fc(a._xhrTypeMap,b,c)},Object.defineProperty(a.prototype,"isDataUrl",{get:function(){return this._hasFlag(a.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isComplete",{get:function(){return this._hasFlag(a.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isLoading",{get:function(){return this._hasFlag(a.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),a.prototype.complete=function(){this._clearEvents(),this._finish()},a.prototype.abort=function(b){if(!this.error){if(this.error=new Error(b),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=a.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},a.prototype.load=function(b){var c=this;if(!this.isLoading)if(this.isComplete)b&&setTimeout(function(){return b(c)},1);else switch(b&&this.onComplete.once(b),this._setFlag(a.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case a.LOAD_TYPE.IMAGE:this.type=a.TYPE.IMAGE,this._loadElement("image");break;case a.LOAD_TYPE.AUDIO:this.type=a.TYPE.AUDIO,this._loadSourceElement("audio");break;case a.LOAD_TYPE.VIDEO:this.type=a.TYPE.VIDEO,this._loadSourceElement("video");break;case a.LOAD_TYPE.XHR:default:void 0===bU&&(bU=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),bU&&this.crossOrigin?this._loadXdr():this._loadXhr()}},a.prototype._hasFlag=function(a){return 0!=(this._flags&a)},a.prototype._setFlag=function(a,b){this._flags=b?this._flags|a:this._flags&~a},a.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},a.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(a.STATUS_FLAGS.COMPLETE,!0),this._setFlag(a.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},a.prototype._loadElement=function(a){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===a&&void 0!==globalThis.Image?this.data=new Image:this.data=document.createElement(a),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},a.prototype._loadSourceElement=function(b){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===b&&void 0!==globalThis.Audio?this.data=new Audio:this.data=document.createElement(b),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var a=this.metadata.mimeType,c=0;c<this.url.length;++c)this.data.appendChild(this._createSource(b,this.url[c],Array.isArray(a)?a[c]:a));else a=this.metadata.mimeType,this.data.appendChild(this._createSource(b,this.url,Array.isArray(a)?a[0]:a));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+b)},a.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var b=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(b.withCredentials=!0),b.open("GET",this.url,!0),b.timeout=this.timeout,this.xhrType===a.XHR_RESPONSE_TYPE.JSON||this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT?b.responseType=a.XHR_RESPONSE_TYPE.TEXT:b.responseType=this.xhrType,b.addEventListener("error",this._boundXhrOnError,!1),b.addEventListener("timeout",this._boundXhrOnTimeout,!1),b.addEventListener("abort",this._boundXhrOnAbort,!1),b.addEventListener("progress",this._boundOnProgress,!1),b.addEventListener("load",this._boundXhrOnLoad,!1),b.send()},a.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new globalThis.XDomainRequest;a.timeout=this.timeout||5e3,a.onerror=this._boundXhrOnError,a.ontimeout=this._boundXhrOnTimeout,a.onprogress=this._boundOnProgress,a.onload=this._boundXhrOnLoad,a.open("GET",this.url,!0),setTimeout(function(){return a.send()},1)},a.prototype._createSource=function(d,c,a){a||(a=d+"/"+this._getExtension(c));var b=document.createElement("source");return b.src=c,b.type=a,b},a.prototype._onError=function(a){this.abort("Failed to load element using: "+a.target.nodeName)},a.prototype._onProgress=function(a){a&&a.lengthComputable&&this.onProgress.dispatch(this,a.loaded/a.total)},a.prototype._onTimeout=function(){this.abort("Load timed out.")},a.prototype._xhrOnError=function(){var a=this.xhr;this.abort(bJ(a)+" Request failed. Status: "+a.status+', text: "'+a.statusText+'"')},a.prototype._xhrOnTimeout=function(){var a=this.xhr;this.abort(bJ(a)+" Request timed out.")},a.prototype._xhrOnAbort=function(){var a=this.xhr;this.abort(bJ(a)+" Request was aborted by the user.")},a.prototype._xhrOnLoad=function(){var b=this.xhr,c="",d=void 0===b.status?200:b.status,f,e;if(""!==b.responseType&&"text"!==b.responseType&&void 0!==b.responseType||(c=b.responseText),0===d&&(c.length>0||b.responseType===a.XHR_RESPONSE_TYPE.BUFFER)?d=200:1223===d&&(d=204),2==(d/100|0)){if(this.xhrType===a.XHR_RESPONSE_TYPE.TEXT)this.data=c,this.type=a.TYPE.TEXT;else if(this.xhrType===a.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(c),this.type=a.TYPE.JSON}catch(a){return void this.abort("Error trying to parse loaded json: "+a)}else if(this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT)try{globalThis.DOMParser?(f=new DOMParser,this.data=f.parseFromString(c,"text/xml")):(e=document.createElement("div"),e.innerHTML=c,this.data=e),this.type=a.TYPE.XML}catch(a){return void this.abort("Error trying to parse loaded xml: "+a)}else this.data=b.response||c;this.complete()}else this.abort("["+b.status+"] "+b.statusText+": "+b.responseURL)},a.prototype._determineCrossOrigin=function(c,a){if(0===c.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";a=a||globalThis.location,bh||(bh=document.createElement("a")),bh.href=c;var b=e$(bh.href,{strictMode:!0}),d=!b.port&&""===a.port||b.port===a.port,e=b.protocol?b.protocol+":":"";return b.host===a.hostname&&d&&e===a.protocol?"":"anonymous"},a.prototype._determineXhrType=function(){return a._xhrTypeMap[this.extension]||a.XHR_RESPONSE_TYPE.TEXT},a.prototype._determineLoadType=function(){return a._loadTypeMap[this.extension]||a.LOAD_TYPE.XHR},a.prototype._getExtension=function(a){var b,c,d,e,f;return void 0===a&&(a=this.url),b="",this.isDataUrl?(c=a.indexOf("/"),b=a.substring(c+1,a.indexOf(";",c))):(d=a.indexOf("?"),e=a.indexOf("#"),f=Math.min(d>-1?d:a.length,e>-1?e:a.length),b=(a=a.substring(0,f)).substring(a.lastIndexOf(".")+1)),b.toLowerCase()},a.prototype._getMimeFromXhrType=function(b){switch(b){case a.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case a.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case a.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case a.XHR_RESPONSE_TYPE.JSON:return"application/json";case a.XHR_RESPONSE_TYPE.DEFAULT:case a.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},a}(),function(a){var c,b,d,e;(c=a.STATUS_FLAGS||(a.STATUS_FLAGS={}))[c.NONE=0]="NONE",c[c.DATA_URL=1]="DATA_URL",c[c.COMPLETE=2]="COMPLETE",c[c.LOADING=4]="LOADING",(b=a.TYPE||(a.TYPE={}))[b.UNKNOWN=0]="UNKNOWN",b[b.JSON=1]="JSON",b[b.XML=2]="XML",b[b.IMAGE=3]="IMAGE",b[b.AUDIO=4]="AUDIO",b[b.VIDEO=5]="VIDEO",b[b.TEXT=6]="TEXT",(d=a.LOAD_TYPE||(a.LOAD_TYPE={}))[d.XHR=1]="XHR",d[d.IMAGE=2]="IMAGE",d[d.AUDIO=3]="AUDIO",d[d.VIDEO=4]="VIDEO",(e=a.XHR_RESPONSE_TYPE||(a.XHR_RESPONSE_TYPE={})).DEFAULT="text",e.BUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.TEXT="text",a._loadTypeMap={gif:a.LOAD_TYPE.IMAGE,png:a.LOAD_TYPE.IMAGE,bmp:a.LOAD_TYPE.IMAGE,jpg:a.LOAD_TYPE.IMAGE,jpeg:a.LOAD_TYPE.IMAGE,tif:a.LOAD_TYPE.IMAGE,tiff:a.LOAD_TYPE.IMAGE,webp:a.LOAD_TYPE.IMAGE,tga:a.LOAD_TYPE.IMAGE,avif:a.LOAD_TYPE.IMAGE,svg:a.LOAD_TYPE.IMAGE,"svg+xml":a.LOAD_TYPE.IMAGE,mp3:a.LOAD_TYPE.AUDIO,ogg:a.LOAD_TYPE.AUDIO,wav:a.LOAD_TYPE.AUDIO,mp4:a.LOAD_TYPE.VIDEO,webm:a.LOAD_TYPE.VIDEO},a._xhrTypeMap={xhtml:a.XHR_RESPONSE_TYPE.DOCUMENT,html:a.XHR_RESPONSE_TYPE.DOCUMENT,htm:a.XHR_RESPONSE_TYPE.DOCUMENT,xml:a.XHR_RESPONSE_TYPE.DOCUMENT,tmx:a.XHR_RESPONSE_TYPE.DOCUMENT,svg:a.XHR_RESPONSE_TYPE.DOCUMENT,tsx:a.XHR_RESPONSE_TYPE.DOCUMENT,gif:a.XHR_RESPONSE_TYPE.BLOB,png:a.XHR_RESPONSE_TYPE.BLOB,bmp:a.XHR_RESPONSE_TYPE.BLOB,jpg:a.XHR_RESPONSE_TYPE.BLOB,jpeg:a.XHR_RESPONSE_TYPE.BLOB,tif:a.XHR_RESPONSE_TYPE.BLOB,tiff:a.XHR_RESPONSE_TYPE.BLOB,webp:a.XHR_RESPONSE_TYPE.BLOB,tga:a.XHR_RESPONSE_TYPE.BLOB,avif:a.XHR_RESPONSE_TYPE.BLOB,json:a.XHR_RESPONSE_TYPE.JSON,text:a.XHR_RESPONSE_TYPE.TEXT,txt:a.XHR_RESPONSE_TYPE.TEXT,ttf:a.XHR_RESPONSE_TYPE.BUFFER,otf:a.XHR_RESPONSE_TYPE.BUFFER},a.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(a.LoaderResource||(a.LoaderResource={})),ho=function(a,b){this.data=a,this.callback=b},bE=function(){function a(c,b){var a=this;if(void 0===b&&(b=1),this.workers=0,this.saturated=Q,this.unsaturated=Q,this.empty=Q,this.drain=Q,this.error=Q,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(c,e,b){if(b&&"function"!=typeof b)throw new Error("task callback must be a function");if(a.started=!0,null==c&&a.idle())setTimeout(function(){return a.drain()},1);else{var d=new ho(c,"function"==typeof b?b:Q);e?a._tasks.unshift(d):a._tasks.push(d),setTimeout(a.process,1)}},this.process=function(){for(;!a.paused&&a.workers<a.concurrency&&a._tasks.length;){var b=a._tasks.shift();0===a._tasks.length&&a.empty(),a.workers+=1,a.workers===a.concurrency&&a.saturated(),a._worker(b.data,hp(a._next(b)))}},this._worker=c,0===b)throw new Error("Concurrency must not be zero");this.concurrency=b,this.buffer=b/4}return a.prototype._next=function(b){var a=this;return function(){for(var e=arguments,c=[],d=0;d<arguments.length;d++)c[d]=e[d];a.workers-=1,b.callback.apply(b,c),null!=c[0]&&a.error(c[0],b.data),a.workers<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}},a.prototype.push=function(a,b){this._insert(a,!1,b)},a.prototype.kill=function(){this.workers=0,this.drain=Q,this.started=!1,this._tasks=[]},a.prototype.unshift=function(a,b){this._insert(a,!0,b)},a.prototype.length=function(){return this._tasks.length},a.prototype.running=function(){return this.workers},a.prototype.idle=function(){return this._tasks.length+this.workers===0},a.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},a.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var a=1;a<=this.concurrency;a++)this.process()}},a.eachSeries=function(a,c,d,e){var b=0,f=a.length;!function g(h){h||b===f?d&&d(h):e?setTimeout(function(){c(a[b++],g)},1):c(a[b++],g)}()},a.queue=function(b,c){return new a(b,c)},a}(),hn=/(#[\w-]+)?$/,aJ=function(){function b(a,c){var e=this,d,f,g,h;void 0===a&&(a=""),void 0===c&&(c=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(a,b){return e._loadResource(a,b)},this.resources={},this.baseUrl=a,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(a,b){return e._loadResource(a,b)},this._queue=bE.queue(this._boundLoadResource,c),this._queue.pause(),this.resources={},this.onProgress=new E,this.onError=new E,this.onLoad=new E,this.onStart=new E,this.onComplete=new E;for(d=0;d<b._plugins.length;++d)f=b._plugins[d],g=f.pre,h=f.use,g&&this.pre(g),h&&this.use(h);this._protected=!1}return b.prototype._add=function(c,h,g,i){var d,e,b,f;if(this.loading&&(!g||!g.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[c])throw new Error('Resource named "'+c+'" already exists.');if(h=this._prepareUrl(h),this.resources[c]=new a.LoaderResource(c,h,g),"function"==typeof i&&this.resources[c].onAfterMiddleware.once(i),this.loading){for(d=g.parentResource,e=[],b=0;b<d.children.length;++b)d.children[b].isComplete||e.push(d.children[b]);f=d.progressChunk*(e.length+1)/(e.length+2);for(d.children.push(this.resources[c]),d.progressChunk=f,b=0;b<e.length;++b)e[b].progressChunk=f;this.resources[c].progressChunk=f}return this._queue.push(this.resources[c]),this},b.prototype.pre=function(a){return this._beforeMiddleware.push(a),this},b.prototype.use=function(a){return this._afterMiddleware.push(a),this},b.prototype.reset=function(){var b,a;for(b in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources)a=this.resources[b],a._onLoadBinding&&a._onLoadBinding.detach(),a.isLoading&&a.abort("loader reset");return this.resources={},this},b.prototype.load=function(b){if("function"==typeof b&&this.onComplete.once(b),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var c=100/this._queue._tasks.length,a=0;a<this._queue._tasks.length;++a)this._queue._tasks[a].data.progressChunk=c;this._onStart(),this._queue.resume()}return this},Object.defineProperty(b.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(a){this._queue.concurrency=a},enumerable:!1,configurable:!0}),b.prototype._prepareUrl=function(b){var a,c=e$(b,{strictMode:!0}),d;return a=c.protocol||!c.path||0===b.indexOf("//")?b:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==b.charAt(0)?this.baseUrl+"/"+b:this.baseUrl+b,this.defaultQueryString&&(d=hn.exec(a)[0],-1!==(a=a.slice(0,a.length-d.length)).indexOf("?")?a+="&"+this.defaultQueryString:a+="?"+this.defaultQueryString,a+=d),a},b.prototype._loadResource=function(a,c){var b=this;a._dequeue=c,bE.eachSeries(this._beforeMiddleware,function(c,d){c.call(b,a,function(){d(a.isComplete?{}:null)})},function(){a.isComplete?b._onLoad(a):(a._onLoadBinding=a.onComplete.once(b._onLoad,b),a.load())},!0)},b.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},b.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},b.prototype._onLoad=function(b){var a=this;b._onLoadBinding=null,this._resourcesParsing.push(b),b._dequeue(),bE.eachSeries(this._afterMiddleware,function(c,d){c.call(a,b,d)},function(){b.onAfterMiddleware.dispatch(b),a.progress=Math.min(100,a.progress+b.progressChunk),a.onProgress.dispatch(a,b),b.error?a.onError.dispatch(b.error,a,b):a.onLoad.dispatch(a,b),a._resourcesParsing.splice(a._resourcesParsing.indexOf(b),1),a._queue.idle()&&0===a._resourcesParsing.length&&a._onComplete()},!0)},b.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(b,"shared",{get:function(){var a=b._shared;return a||((a=new b)._protected=!0,b._shared=a),a},enumerable:!1,configurable:!0}),b.registerPlugin=function(c){return A.add({type:a.ExtensionType.Loader,ref:c}),b},b._plugins=[],b}(),A.handleByList(a.ExtensionType.Loader,aJ._plugins),aJ.prototype.add=function(b,c,a,d){if(Array.isArray(b)){for(var e=0;e<b.length;++e)this.add(b[e]);return this}if("object"==typeof b&&(a=b,d=c||a.callback||a.onComplete,c=a.url,b=a.name||a.key||a.url),"string"!=typeof c&&(d=a,a=c,c=b),"string"!=typeof c)throw new Error("No url passed to add resource to loader.");return"function"==typeof a&&(d=a,a=null),this._add(b,c,a,d)},fk=function(){function b(){}return b.init=function(a){a=Object.assign({sharedLoader:!1},a),this.loader=a.sharedLoader?aJ.shared:new aJ},b.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},b.extension=a.ExtensionType.Application,b}(),fl=function(){function b(){}return b.add=function(){a.LoaderResource.setExtensionLoadType("svg",a.LoaderResource.LOAD_TYPE.XHR),a.LoaderResource.setExtensionXhrType("svg",a.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},b.use=function(b,d){if(!b.data||b.type!==a.LoaderResource.TYPE.IMAGE&&"svg"!==b.extension)d();else{var e=b.data,f=b.url,g=b.name,h=b.metadata;c.fromLoader(e,f,g,h).then(function(a){b.texture=a,d()}).catch(d)}},b.extension=a.ExtensionType.Loader,b}();function hl(b,c){var e,f,d;if(b.data){if(b.xhr&&b.xhrType===a.LoaderResource.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof b.data){if(0===b.data.type.indexOf("image"))return e=globalThis.URL||globalThis.webkitURL,f=e.createObjectURL(b.data),b.blob=b.data,b.data=new Image,b.data.src=f,b.type=a.LoaderResource.TYPE.IMAGE,void(b.data.onload=function(){e.revokeObjectURL(f),b.data.onload=null,c()})}else if(d=b.xhr.getResponseHeader("content-type"),d&&0===d.indexOf("image"))return b.data=new Image,b.data.src="data:"+d+";base64,"+function(d){for(var f="",e=0,a,b,c;e<d.length;){for(a=[0,0,0],b=[0,0,0,0],c=0;c<a.length;++c)e<d.length?a[c]=255&d.charCodeAt(e++):a[c]=0;switch(b[0]=a[0]>>2,b[1]=(3&a[0])<<4|a[1]>>4,b[2]=(15&a[1])<<2|a[2]>>6,b[3]=63&a[2],e-(d.length-1)){case 2:b[3]=64,b[2]=64;break;case 1:b[3]=64}for(c=0;c<b.length;++c)f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b[c])}return f}(b.xhr.responseText),b.type=a.LoaderResource.TYPE.IMAGE,void(b.data.onload=function(){b.data.onload=null,c()});c()}else c()}hk=function(){function b(){}return b.extension=a.ExtensionType.Loader,b.use=hl,b}(),A.add(fl,hk),a.INTERNAL_FORMATS=void 0,function(a){a[a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",a[a.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",a[a.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",a[a.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",a[a.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",a[a.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",a[a.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",a[a.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",a[a.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",a[a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",a[a.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",a[a.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",a[a.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",a[a.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",a[a.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR"}(a.INTERNAL_FORMATS||(a.INTERNAL_FORMATS={})),av=((f={})[a.INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,f[a.INTERNAL_FORMATS.COMPRESSED_R11_EAC]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RG11_EAC]=1,f[a.INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC]=1,f[a.INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC]=1,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,f[a.INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,f[a.INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL]=.5,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,f[a.INTERNAL_FORMATS.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,f),bD=function(a,b){return bD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])},bD(a,b)};function fr(b,a){function c(){this.constructor=b}bD(b,a),b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}fu=function(b){function a(e,d){void 0===d&&(d={width:1,height:1,autoLoad:!0});var f,c,a=this;return"string"==typeof e?(f=e,c=new Uint8Array):(f=null,c=e),(a=b.call(this,c,d)||this).origin=f,a.buffer=c?new aW(c):null,a.origin&&!1!==d.autoLoad&&a.load(),c&&c.length&&(a.loaded=!0,a.onBlobLoaded(a.buffer.rawBinaryData)),a}return fr(a,b),a.prototype.onBlobLoaded=function(a){},a.prototype.load=function(){return function(c,d,a,b){return new(a||(a=Promise))(function(g,f){function h(a){try{e(b.next(a))}catch(a){f(a)}}function i(a){try{e(b.throw(a))}catch(a){f(a)}}function e(c){var b;c.done?g(c.value):(b=c.value,b instanceof a?b:new a(function(a){a(b)})).then(h,i)}e((b=b.apply(c,d||[])).next())})}(this,void 0,Promise,function(){var a;return function(g,h){var e,c,a,f,b={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return f={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function d(d){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;b;)try{if(e=1,c&&(a=2&d[0]?c.return:d[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,d[1])).done)return a;switch(c=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return b.label++,{value:d[1],done:!1};case 5:b.label++,c=d[1],d=[0];continue;case 7:d=b.ops.pop(),b.trys.pop();continue;default:if(!((a=(a=b.trys).length>0&&a[a.length-1])||6!==d[0]&&2!==d[0])){b=0;continue}if(3===d[0]&&(!a||d[1]>a[0]&&d[1]<a[3])){b.label=d[1];break}if(6===d[0]&&b.label<a[1]){b.label=a[1],a=d;break}if(a&&b.label<a[2]){b.label=a[2],b.ops.push(d);break}a[2]&&b.ops.pop(),b.trys.pop();continue}d=h.call(g,b)}catch(a){d=[6,a],c=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([d,f])}}}(this,function(b){switch(b.label){case 0:return[4,fetch(this.origin)];case 1:return[4,b.sent().blob()];case 2:return[4,b.sent().arrayBuffer()];case 3:return a=b.sent(),this.data=new Uint32Array(a),this.buffer=new aW(a),this.loaded=!0,this.onBlobLoaded(a),this.update(),[2,this]}})})},a}(S),bk=function(b){function a(e,d){var c=b.call(this,e,d)||this;return c.format=d.format,c.levels=d.levels||1,c._width=d.width,c._height=d.height,c._extension=a._formatToExtension(c.format),(d.levelBuffers||c.buffer)&&(c._levelBuffers=d.levelBuffers||a._createLevelBuffers(e instanceof Uint8Array?e:c.buffer.uint8View,c.format,c.levels,4,4,c.width,c.height)),c}return fr(a,b),a.prototype.upload=function(d,j,k){var c=d.gl,b,g,a,e,f,h,i;if(!d.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(b=0,g=this.levels;b<g;b++)a=this._levelBuffers[b],e=a.levelID,f=a.levelWidth,h=a.levelHeight,i=a.levelBuffer,c.compressedTexImage2D(c.TEXTURE_2D,e,this.format,f,h,0,i);return!0},a.prototype.onBlobLoaded=function(){this._levelBuffers=a._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},a._formatToExtension=function(a){if(a>=33776&&a<=33779)return"s3tc";if(a>=37488&&a<=37497)return"etc";if(a>=35840&&a<=35843)return"pvrtc";if(a>=36196)return"etc1";if(a>=35986&&a<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},a._createLevelBuffers=function(m,l,c,d,e,o,n){for(var j=new Array(c),k=m.byteOffset,a=o,f=n,i=a+d-1&~(d-1),h=f+e-1&~(e-1),g=i*h*av[l],b=0;b<c;b++)j[b]={levelID:b,levelWidth:c>1?a:i,levelHeight:c>1?f:h,levelBuffer:new Uint8Array(m.buffer,k,g)},k+=g,g=(i=(a=a>>1||1)+d-1&~(d-1))*(h=(f=f>>1||1)+e-1&~(e-1))*av[l];return j},a}(fu),fw=function(){function c(){}return c.use=function(b,f){var d=b.data,h,e,i,g,m,k,l,j,n,o,p;if(b.type===a.LoaderResource.TYPE.JSON&&d&&d.cacheID&&d.textures){for(h=d.textures,e=void 0,i=void 0,g=0,m=h.length;g<m;g++)if(k=h[g],l=k.src,j=k.format,j||(i=l),c.textureFormats[j]){e=l;break}if(!(e=e||i))return void f(new Error("Cannot load compressed-textures in "+b.url+", make sure you provide a fallback"));if(e===b.url)return void f(new Error("URL of compressed texture cannot be the same as the manifest's URL"));n={crossOrigin:b.crossOrigin,metadata:b.metadata.imageMetadata,parentResource:b},o=L.resolve(b.url.replace(this.baseUrl,""),e),p=d.cacheID,this.add(p,o,n,function(a){if(a.error)f(a.error);else{var c=a.texture,e=void 0===c?null:c,d=a.textures,g=void 0===d?{}:d;Object.assign(b,{texture:e,textures:g}),f()}})}else f()},Object.defineProperty(c,"textureExtensions",{get:function(){var a,d;if(!c._textureExtensions){if(a=b.ADAPTER.createCanvas().getContext("webgl"),!a)return{};d={s3tc:a.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:a.getExtension("WEBGL_compressed_texture_etc"),etc1:a.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:a.getExtension("WEBGL_compressed_texture_atc"),astc:a.getExtension("WEBGL_compressed_texture_astc")},c._textureExtensions=d}return c._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(c,"textureFormats",{get:function(){var a,d,b;if(!c._textureFormats){a=c.textureExtensions;for(d in c._textureFormats={},a)b=a[d],b&&Object.assign(c._textureFormats,Object.getPrototypeOf(b))}return c._textureFormats},enumerable:!1,configurable:!0}),c.extension=a.ExtensionType.Loader,c}();function fx(d,f,g){var b={textures:{},texture:null};return f?(f.map(function(b){return new c(new e(b,Object.assign({mipmap:a.MIPMAP_MODES.OFF,alphaMode:a.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA},g)))}).forEach(function(a,g){var h=a.baseTexture,f=d+"-"+(g+1);e.addToCache(h,f),c.addToCache(a,f),0===g&&(e.addToCache(h,d),c.addToCache(a,d),b.texture=a),b.textures[f]=a